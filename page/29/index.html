<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"helongquan.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="日记">
<meta property="og:type" content="website">
<meta property="og:title" content="鸢尾花序">
<meta property="og:url" content="https://helongquan.github.io/page/29/index.html">
<meta property="og:site_name" content="鸢尾花序">
<meta property="og:description" content="日记">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="泉哥">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://helongquan.github.io/page/29/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>鸢尾花序</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">鸢尾花序</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/10/27/wordpress%E8%AE%A9portfolio%E4%B9%9F%E8%83%BD%E5%85%B7%E6%9C%89%E7%95%99%E8%A8%80%E5%8A%9F%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/27/wordpress%E8%AE%A9portfolio%E4%B9%9F%E8%83%BD%E5%85%B7%E6%9C%89%E7%95%99%E8%A8%80%E5%8A%9F%E8%83%BD/" class="post-title-link" itemprop="url">wordpress让portfolio也能具有留言功能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-10-27 15:50:03" itemprop="dateCreated datePublished" datetime="2017-10-27T15:50:03+08:00">2017-10-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:11" itemprop="dateModified" datetime="2020-10-11T11:53:11+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>用过wordpress国外主题的人大概都知道有个portfolio，意思是画册功能。</p>
<p>通常这个功能是没有留言功能的，不是因为网站后台关闭了留言功能，而是连整个留言的区块都没有。前一段时间就碰到一个客户的需求，说是要让portfolio也要有留言板功能。</p>
<p>首先用portfolio新建一个测试页面，新建的portfolio entry，而不是portfolio items，我最开始也是被这个困惑了很久，因为命名修改好了的，为何总是不起作用呢。好的，确认这里后我们找到portfolio entry页面对应的php文件。</p>
<p>首先进入到主题的源码中，然后找到portfolio单页对对应的那个php文件，我这边的是single-portfolio.php。好的，对应的文件已经找到了，那么我们就着手修改。</p>
<p>先在浏览器访问这个测试页面，用开发者工具定位一下，我们找到内容区，我这边找到显示的内容区是<main></main>标签，这块是显示portfolio写的内容了，那么内容后面就应该是留言了。</p>
<p>好的我们先调用wordpress的留言标签</p>
<pre><code>&lt;?php comments_template(); ?&gt;</code></pre>
<p>这个位置根据自己的主题代码设计结构会有点差异，自己确定好位置，放置就行了。</p>
<p>好了，我们在wordpress开启留言功能，也就是允许评论。完成后刷新portfolio测试页面。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/10/20/docker%E4%B8%8B%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%88%96%E8%80%85%E5%A4%9A%E4%B8%AA%E7%AB%99%E7%82%B9/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/20/docker%E4%B8%8B%E5%88%9B%E5%BB%BA%E4%B8%80%E4%B8%AA%E6%88%96%E8%80%85%E5%A4%9A%E4%B8%AA%E7%AB%99%E7%82%B9/" class="post-title-link" itemprop="url">docker下创建一个或者多个站点</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-10-20 14:28:50" itemprop="dateCreated datePublished" datetime="2017-10-20T14:28:50+08:00">2017-10-20</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:34" itemprop="dateModified" datetime="2020-10-11T11:53:34+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在centos7上搭建docker后，我开始尝试了搭建一个wordpress应用，wordpress是一个非常有优秀的开源的博客系统。现在我想在docker下创建一个或者多个站点。</p>
<p>第一步：查看容器，运行命令：</p>
<pre><code>docker ps -a</code></pre>
<p>再查看下docker里面都有哪些镜像：</p>
<pre><code>docker images</code></pre>
<p>假设里面什么都没有，好了我们先安装一个mysql数据库，不然网站是没法安装的。</p>
<pre><code>docker search mysql</code></pre>
<p>选择其中一个，拉取下来，运行命令：</p>
<pre><code>docker pull mysql    // 这个名字可能是其他的比如：aliyun/mysql，这个根据罗列出来的名字输入即可</code></pre>
<p>然后，我们搜索下wordpress的镜像，运行命令：</p>
<pre><code>docker search wordpress</code></pre>
<p>然后选择一个合适的镜像,拉取下来，运行命令：</p>
<pre><code>docker pull wordpress  // 这个名字可能是其他名字比如：xxx/wordpress，这个根据罗列出来的进行安装，默认输入wordpress也是可以的</code></pre>
<p>好的，到目前为止，我们已经把mysql和wordpress的镜像都已经拉取到本地了。</p>
<p>接着，我们创建mysql容器并后台运行，指定数据库密码是123456。-e指定环境变量。mysql_db是指定数据库名，如果没有则会被创建。</p>
<pre><code>docker run --name mysql_db -e MYSQL_ROOT_PASSWORD=123456 -d mysql</code></pre>
<p>成功后，我们接着创建wordpress容器应用并后台运行，这里的8000是我自己设定的，端口可以根据自己的需求修改：</p>
<pre><code>docker run --name some-wordpress --link mysql_db:mysql -p 8000:80 -d wordpress  </code></pre>
<p>注意：这里的mysql_db就是上面创建的那个mysql_db,这里的some-wordpress是我为这个容器命的名，这里的wordpress是拉取下来的wordpress镜像名，如果是其他名字，比如上文中的xxx/wordpress，那么我们就要把这里的wordpresss改成xxx/wordpress</p>
<p>到此为止，我们可以在浏览器上输入：<a href="http://youip:8000，如果你已经解析成域名了，可以输入：http://www.youdomain.com:8000，第一次的话会进入到wordpress的安装界面，跟着安装步骤就可以完成wordpress的安装。">http://youip:8000，如果你已经解析成域名了，可以输入：http://www.youdomain.com:8000，第一次的话会进入到wordpress的安装界面，跟着安装步骤就可以完成wordpress的安装。</a></p>
<hr>
<p>那么我们要安装多个wordpress站点怎么办呢？</p>
<p>跟着我的思路往下走，首先wordpress这个镜像我们可以共用，同样的我们的mysql镜像也是可以共用的，当然我们也可以不用已经有的镜像，我们完全可以拉取另外的镜像，只不过要另外命名一下，免得跟已经存在的镜像重名了。</p>
<p>好的，我们先新建mysql容器，命名为：mysql_another_db，运行命令，因为我们采用已有的mysql镜像，所以我们不用再次运行docker pull mysql了：</p>
<pre><code>docker run --name mysql_another_db -e MYSQL_ROOT_PASSWORD=3344556 -d mysql</code></pre>
<p>然后我们再新建一个wordpress容器，命名为：mywordpress，由于也是采用已经有的wordpress镜像，所以就不需要再次运行docker pull wordpress了：</p>
<pre><code>docker run --name mywordpress --link mysql_another_db:mysql -p 8888:80 -d wordpress </code></pre>
<p>注意：这里的mysql_db就是上面创建的那个mysql_db,这里的mywordpress是我为这个容器命的名，这里的wordpress是拉取下来的wordpress镜像名，如果是其他名字，比如上文中的xxx/wordpress，那么我们就要把这里的wordpresss改成xxx/wordpress。</p>
<p>到此为止，我们可以在浏览器上输入：<a href="http://youip:8888，如果你已经解析成域名了，可以输入：http://www.youdomain.com:8888，第一次的话会进入到wordpress的安装界面，跟着安装步骤就可以完成wordpress的安装。">http://youip:8888，如果你已经解析成域名了，可以输入：http://www.youdomain.com:8888，第一次的话会进入到wordpress的安装界面，跟着安装步骤就可以完成wordpress的安装。</a></p>
<p>这样的话，我们就完成了用一个域名通过docker的方式安装了多个wordpress站点，当然我们也可以安装其他cms的，如果magento，opencart等，只需要更换端口即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/10/18/Docker%E5%AE%9E%E8%B7%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/18/Docker%E5%AE%9E%E8%B7%B5/" class="post-title-link" itemprop="url">Docker实践</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-10-18 09:32:45" itemprop="dateCreated datePublished" datetime="2017-10-18T09:32:45+08:00">2017-10-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:34" itemprop="dateModified" datetime="2020-10-11T11:53:34+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>一、Docker是什么</p>
<p>docker直译为码头工人。当它成为一种技术时，做的也是码头工人的事。官网是这样描述它的：“Docker是一个开发的平台，用来为开发者和系统管理员构建、发布和运行分布式应用。”也就是说，如果把你的应用比喻为货物，那么码头工人（Docker）就会迅速的用集装箱将它们装上船。快速、简单而有效率。</p>
<p>它是用Go语言写的，是程序运行的“容器”（Linux containers），实现了应用级别的隔离（沙箱）。多个容器运行时互补影响，安全而稳定。</p>
<p>我喜欢它的原因就是快速部署，安全运行，不污染我的系统。</p>
<p>二、试用 Try it！</p>
<p>官方提供一个互动的小教程，让你很容易的了解Docker的基本用法，快去试试吧！</p>
<p>三、安装</p>
<p>官方直接支持64位Linux系统安装Docker，但如果想在32位系统中运行，有人也进行了一些尝试，比如32Ubuntu下，参考点击打开链接。</p>
<p>其他系统的安装请参考官网，下面说说我在Ubuntu14.04下的安装。 </p>
<p>1.将镜像加入到程序源中：</p>
<pre><code>~$ sudo sh -c &quot;echo deb http://mirror.yandex.ru/mirrors/docker/ docker main &gt; /etc/apt/sources.list.d/docker.list&quot;  </code></pre>
<p>2.接着update</p>
<pre><code>$ sudo apt-get update  </code></pre>
<p>3.如果报错就fix掉它：</p>
<pre><code>W: GPG error: http://mirror.yandex.ru docker Release: The following signatures couldn&#39;t be verified because the public key is not available: NO_PUBKEY D8576A8BA88D21E9  </code></pre>
<p>解决此错误：</p>
<pre><code>$ sudo apt-key adv --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys D8576A8BA88D21E9  
Executing: gpg --ignore-time-conflict --no-options --no-default-keyring --secret-keyring /tmp/tmp.RmJ1SUpsXX --trustdb-name /etc/apt/trustdb.gpg --keyring /etc/apt/trusted.gpg --primary-keyring /etc/apt/trusted.gpg --keyserver hkp://keyserver.ubuntu.com:80 --recv-keys D8576A8BA88D21E9  
gpg: requesting key A88D21E9 from hkp server keyserver.ubuntu.com  
gpg: key A88D21E9: public key &quot;Docker Release Tool (releasedocker) &lt;docker@dotcloud.com&gt;&quot; imported  
gpg: Total number processed: 1  
gpg:               imported: 1  (RSA: 1)  </code></pre>
<p>4.下载docker：</p>
<pre><code>$ sudo apt-get install lxc-docker  </code></pre>
<p>静静的等待它下载完成吧。<br>另外，这个命令也许会有帮助：<br>    $ curl -sSL <a target="_blank" rel="noopener" href="https://get.docker.com/ubuntu/">https://get.docker.com/ubuntu/</a> | sudo sh<br>四、初步使用</p>
<p>终端中输入docker，打印出docker的命令列表：</p>
<pre><code>Commands:  
attach    Attach to a running container  
build     Build an image from a Dockerfile  
commit    Create a new image from a container&#39;s changes  
cp        Copy files/folders from a container&#39;s filesystem to the host path  
create    Create a new container  
diff      Inspect changes on a container&#39;s filesystem  
events    Get real time events from the server  
exec      Run a command in a running container  
export    Stream the contents of a container as a tar archive  
history   Show the history of an image  
images    List images  
import    Create a new filesystem image from the contents of a tarball  
info      Display system-wide information  
inspect   Return low-level information on a container  
kill      Kill a running container  
load      Load an image from a tar archive  
login     Register or log in to a Docker registry server  
logout    Log out from a Docker registry server  
logs      Fetch the logs of a container  
port      Lookup the public-facing port that is NAT-ed to PRIVATE_PORT  
pause     Pause all processes within a container  
ps        List containers  
pull      Pull an image or a repository from a Docker registry server  
push      Push an image or a repository to a Docker registry server  
restart   Restart a running container  
rm        Remove one or more containers  
rmi       Remove one or more images  
run       Run a command in a new container  
save      Save an image to a tar archive  
search    Search for an image on the Docker Hub  
start     Start a stopped container  
stop      Stop a running container  
tag       Tag an image into a repository  
top       Lookup the running processes of a container  
unpause   Unpause a paused container  
version   Show the Docker version information  
wait      Block until a container stops, then print its exit code  </code></pre>
<p>接下来就可以尝试使用这些命令了，不过在进行下一步之前，我们要先了解几个概念。</p>
<p><strong>五、重要概念</strong></p>
<p>1.image 镜像</p>
<p>镜像就是一个只读的模板。比如，一个镜像可以包含一个完整的Ubuntu系统，并且安装了apache。</p>
<p>镜像可以用来创建Docker容器。</p>
<p>其他人制作好镜像，我们可以拿过来轻松的使用。这就是吸引我的特性。</p>
<p>2.Docker container 容器</p>
<p>Docker用容器来运行应用。容器是从镜像创建出来的实例（好有面向对象的感觉，类和对象），它可以被启动、开始、停止和删除。</p>
<p>3.仓库</p>
<p>这个好理解了，就是放镜像的文件的场所。比如最大的公开仓库是Docker Hub。</p>
<p><strong>六、几个简单的实践</strong></p>
<p>1.search</p>
<p>搜索仓库中是否有wordpress这个博客镜像，如下：</p>
<pre><code>$ docker search wordpress  
NAME                                   DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED  
wordpress                              The WordPress rich content management syst...   185       [OK]   </code></pre>
<p>2.下载这个镜像</p>
<pre><code>$ docker pull wordpress  
wordpress:latest: The image you are pulling has been verified  </code></pre>
<p>3.查看自己的镜像</p>
<pre><code>$ docker images  
REPOSITORY               TAG                 IMAGE ID            CREATED             VIRTUAL SIZE  
linc-wiki                latest              b5a1e34b01c2        27 hours ago        689.7 MB  
ubuntu                   latest              5ba9dab47459        5 days ago          188.3 MB  
wordpress                latest              ecc04d6d638c        6 days ago          470 MB  </code></pre>
<p>4.简单的运行</p>
<p>运行wordpress要进行mysql的配置，为了演示run，将ubuntu跑起来吧。</p>
<pre><code>$ docker run -it ubuntu /bin/bash  
root@46ff2a695ce1:/# echo &quot;I am linc&quot;  
I am linc  </code></pre>
<p>至此，体验结束。后续会有更加精彩的实践等着我们，Docker，我们来了！</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/10/18/Docker%E5%AE%9E%E8%B7%B54%EF%BC%9A%E6%90%AD%E5%BB%BAwordpress/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/18/Docker%E5%AE%9E%E8%B7%B54%EF%BC%9A%E6%90%AD%E5%BB%BAwordpress/" class="post-title-link" itemprop="url">Docker实践4：搭建wordpress</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-10-18 09:27:06" itemprop="dateCreated datePublished" datetime="2017-10-18T09:27:06+08:00">2017-10-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:34" itemprop="dateModified" datetime="2020-10-11T11:53:34+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在系列的第一篇文章《Docker实践》中已经search到并pull了官方的wordpress镜像，接下来我们还要search一个官方的mysql将二者结合，搭建一个可用的wordpress站点。</p>
<p>首先，搞定mysql</p>
<p>1.search</p>
<pre><code>$ docker search mysql  
NAME                         DESCRIPTION                                     STARS     OFFICIAL   AUTOMATED  
mysql                        MySQL is a widely used, open-source relati...   456       [OK]         </code></pre>
<p>2.pull</p>
<pre><code>$ docker pull mysql  </code></pre>
<p>其次，考虑二者的联合</p>
<pre><code>$ docker images  
REPOSITORY               TAG                 IMAGE ID            CREATED             VIRTUAL SIZE  
wordpress                latest              ecc04d6d638c        2 weeks ago         470 MB  
mysql                    latest              aca96d9e6b5c        2 weeks ago         282.7 MB  </code></pre>
<p>wordpress启动命令是这样的：</p>
<pre><code>$ sudo docker run --name some-wordpress --link some-mysql:mysql -d wordpress  

启动 WordPress 容器时可以指定的一些环境参数包括  

    -e WORDPRESS_DB_USER=... 缺省为 “root”  
    -e WORDPRESS_DB_PASSWORD=... 缺省为连接 mysql 容器的环境变量 MYSQL_ROOT_PASSWORD 的值  
    -e WORDPRESS_DB_NAME=... 缺省为 “wordpress”  
    -e WORDPRESS_AUTH_KEY=..., -e WORDPRESS_SECURE_AUTH_KEY=..., -e WORDPRESS_LOGGED_IN_KEY=..., -e WORDPRESS_NONCE_KEY=..., -e WORDPRESS_AUTH_SALT=..., -e WORDPRESS_SECURE_AUTH_SALT=..., -e WORDPRESS_LOGGED_IN_SALT=..., -e WORDPRESS_NONCE_SALT=... 缺省为随机 sha1 串  </code></pre>
<p>针对wordpress的启动命令，我们需要这样针对：</p>
<p>1.给wordpress可以起个名字，这个好办</p>
<p>2.–link参数，这需要我们先启动mysql，然后将其名字链接上</p>
<p>3.端口 -p参数，默认是80端口，但是被我占用了，这里我们映射到8080</p>
<p>启动的mysql的命令：<br>    $ docker run –name mysql_wordpress -e MYSQL_ROOT_PASSWORD=wordpress  -d  mysql<br>mysql的密码，姑且这样暴露着吧。</p>
<p>对应mysql，wordpress的启动命令如下：</p>
<pre><code>$ docker run --name docker_wordpress --link mysql_wordpress:mysql -p 8080:80 -d wordpress  </code></pre>
<p>接下来就可以在浏览器中输入<a href="http://localhost:8080进行wordpress的配置了。">http://localhost:8080进行wordpress的配置了。</a><br>Enjoy！</p>
<p>第三，用fig来配置<br>实践证明，用fig配置是最好的途径。在上面的基础上，我们只需在自己的docker目录下新建目录如wordpress-docker，再建fig配置文件fig.yml如下：</p>
<pre><code>wordpress:  
    image: &quot;wordpress:latest&quot;  
    ports:  
        - &quot;8080:80&quot;  
    links:  
        - db:mysql  

db:  
    image: &quot;mysql:latest&quot;  
    expose:  
        - &quot;3306&quot;  
    environment:  
        - MYSQL_ROOT_PASSWORD=wordpress  </code></pre>
<p>每次启动只需执行本目录下的fig up -d就可以了！</p>
<p>参考：<br><a target="_blank" rel="noopener" href="https://github.com/docker-library/wordpress/blob/aee00669e7c43f435f021cb02871bffd63d5677a/Dockerfile">https://github.com/docker-library/wordpress/blob/aee00669e7c43f435f021cb02871bffd63d5677a/Dockerfile</a><br>如果想用fig搭建wordpress，个人感觉更方便一些，参考如下网址：<br><a target="_blank" rel="noopener" href="http://dockerpool.com/static/books/docker_practice/fig/wordpress.html">http://dockerpool.com/static/books/docker_practice/fig/wordpress.html</a></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/10/18/docker-%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4image/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/10/18/docker-%E5%A6%82%E4%BD%95%E5%88%A0%E9%99%A4image/" class="post-title-link" itemprop="url">docker如何删除image</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-10-18 09:12:03" itemprop="dateCreated datePublished" datetime="2017-10-18T09:12:03+08:00">2017-10-18</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:34" itemprop="dateModified" datetime="2020-10-11T11:53:34+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>docker中删除images的命令是docker rmi，但有时候执行此命令并不能删除images</p>
<pre><code>[yaxin@ubox ~]$docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
eg_sshd             latest              ed9c93747fe1        45 hours ago        329.8 MB
CentOS65            latest              e55a74a32125        2 days ago          360.6 MB
[yaxin@ubox ~]$docker rmi ed9c93747fe1
Untagged: ed9c93747fe16627be822ad3f7feeb8b4468200e5357877d3046aa83cc44c6af
[yaxin@ubox ~]$docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
&lt;none&gt;              &lt;none&gt;              ed9c93747fe1        45 hours ago        329.8 MB
CentOS65            latest              e55a74a32125        2 days ago          360.6 MB</code></pre>
<p>可以看出，image并没有被删除，只是他的tag被删除了，再次执行docker rmi IMAGE_ID只会报错</p>
<pre><code>[yaxin@ubox ~]$docker rmi ed9c93747fe1
Error: image_delete: Conflict, ed9c93747fe1 wasn&#39;t deleted
2014/03/22 15:58:27 Error: failed to remove one or more images</code></pre>
<p>查看docker的帮助会发现有两个与删除有关的命令rm和rmi</p>
<blockquote>
<p>rm Remove one or more containers</p>
</blockquote>
<blockquote>
<p>rmi Remove one or more images</p>
</blockquote>
<p>这里有两个不同的单词，images和container。其中images很好理解，跟平常使用的虚拟机的镜像一个意思，相当于一个模版，而container则是images运行时的的状态。docker对于运行过的image都保留一个状态（container），可以使用命令docker ps来查看正在运行的container，对于已经退出的container，则可以使用docker ps -a来查看。 如果你退出了一个container而忘记保存其中的数据，你可以使用docker ps -a来找到对应的运行过的container使用docker commit命令将其保存为image然后运行。</p>
<p>回到之前的问题，由于image被某个container引用（拿来运行），如果不将这个引用的container销毁（删除），那image肯定是不能被删除。</p>
<p>所以想要删除运行过的images必须首先删除它的container。继续来看刚才的例子，</p>
<pre><code>[yaxin@ubox ~]$docker ps -a
CONTAINER ID        IMAGE               COMMAND                CREATED             STATUS              PORTS                   NAMES
117843ade696        ed9c93747fe1        /bin/sh -c /usr/sbin   46 hours ago        Up 46 hours         0.0.0.0:49153-&gt;22/tcp   test_sshd</code></pre>
<p>可以看出ed9c93747fe1的image被117843ade696的container使用着，所以必须首先删除该container</p>
<pre><code>[yaxin@ubox ~]$docker rm 117843ade696
Error: container_delete: Impossible to remove a running container, please stop it first
2014/03/22 16:36:44 Error: failed to remove one or more containers</code></pre>
<p>出现错误，这是因为该container正在运行中(运行docker ps查看)，先将其关闭</p>
<pre><code>[yaxin@ubox ~]$docker stop 117843ade696
117843ade696
[yaxin@ubox ~]$docker rm 117843ade696
117843ade696
[yaxin@ubox ~]$docker rmi ed9c93747fe1
Deleted: ed9c93747fe16627be822ad3f7feeb8b4468200e5357877d3046aa83cc44c6af
Deleted: c8a0c19429daf73074040a14e527ad5734e70363c644f18c6815388b63eedc9b
Deleted: 95dba4c468f0e53e5f1e5d76b8581d6740aab9f59141f783f8e263ccd7cf2a8e
Deleted: c25dc743e40af6858c34375d450851bd606a70ace5d04e231a7fcc6d2ea23cc1
Deleted: 20562f5714a5ce764845119399ef75e652e23135cd5c54265ff8218b61ccbd33
Deleted: c8af1dc23af7a7aea0c25ba9b28bdee68caa8866f056e4f2aa2a5fa1bcb12693
Deleted: 38fdb2c5432e08ec6121f8dbb17e1fde17d5db4c1f149a9b702785dbf7b0f3be
Deleted: 79ca14274c80ac1df1333b89b2a41c0e0e3b91cd1b267b31bef852ceab3b2044
[yaxin@ubox ~]$docker images
REPOSITORY          TAG                 IMAGE ID            CREATED             VIRTUAL SIZE
CentOS65            latest              e55a74a32125        2 days ago          360.6 MB</code></pre>
<p>可以看出，image已经被删除。</p>
<p>移除所有的容器和镜像（大扫除）</p>
<p>用一行命令大扫除：</p>
<pre><code>docker kill $(docker ps -q) ; 
docker rm $(docker ps -a -q) ;
dockerrmi $(docker images -q -a) </code></pre>
<blockquote>
<p>注：shell 中的 $() 和 `` 类似，会先执行这里面的内容，上面的脚本会出现如下 </p>
</blockquote>
<blockquote>
<p>docker kill “pids” ; docker kill 在 docker 中用于停止容器，docker rm 删除容器， docker rmi 删除镜像</p>
</blockquote>
<p>当没有运行的容器或者是根本没有容器的时候，这只会提示一个警告信息。当你想尝试的时候，这就是个非常好的单行命令。如果你仅仅想删除所有的容器，你可以运行如下命令：</p>
<pre><code>docker kill $(docker ps -q);
docker rm $(docker ps -a -q) </code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/09/27/magento2%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%EF%BC%9Amagento2-Hello-World/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/27/magento2%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%EF%BC%9Amagento2-Hello-World/" class="post-title-link" itemprop="url">magento2插件开发：magento2 Hello World</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-27 11:16:29" itemprop="dateCreated datePublished" datetime="2017-09-27T11:16:29+08:00">2017-09-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:26" itemprop="dateModified" datetime="2020-10-11T11:53:26+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这一章节我们主要讲述magento2 Hello World 模块的创建。</p>
<p>magento2的插件即module都放在 app/code 下面，magento1中的local/ community/ core/ 已经移除了，现在我们开始创建我们的Hello World。</p>
<p><strong>第一步：</strong></p>
<p>创建以下目录到你的magento2根目录下：</p>
<p>app/code/Jike/Hello</p>
<p><strong>第二步：</strong></p>
<p>创建app/code/Jike/Hello/etc/module.xml</p>
<p>内容如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;urn:magento:framework:Module/etc/module.xsd&quot;&gt;
&lt;module name=&quot;Jike_Hello&quot; setup_version=&quot;0.0.1&quot;/&gt;
&lt;/config&gt;</code></pre>
<p><strong>第三步：</strong></p>
<p>创建 app/code/Jike/Hello/registration.php</p>
<p>内容如下：</p>
<pre><code>&lt;?php
\Magento\Framework\Component\ComponentRegistrar::register(
    \Magento\Framework\Component\ComponentRegistrar::MODULE,
    &#39;Jike_Hello&#39;,
    __DIR__
);</code></pre>
<p><strong>第四步：</strong></p>
<p>在你的magento2根目录下执行以下命令：php bin/magento module:status，这个命令是显示所有的模块的状态，正常情况下在未激活列表将显示我们新建的模块，如下图：</p>
<p><img src="http://www.habotalk.com/wp-content/uploads/magento2-01-show-status.png"></p>
<p>然后执行以下命令 激活我们新建的模块：php bin/magento module:enable Jike_Hello。<br>这个时候你去看下：app/etc/config.php，将看到我们的模块已经激活了，这个文件管理所有的模块的激活，当然你也可以手动增加一行，激活模块，不用我们之前的命令。</p>
<p>app/etc/config.php</p>
<p><img src="http://www.habotalk.com/wp-content/uploads/etc-config.png"></p>
<p>然后你就可以去前台看下我们成果啦，打开前台你会发现有报错信息，不用担心，只要执行：php bin/magento setup:upgrade 更新一下就好了。</p>
<p>这个时候一个新的模块就创建好了，你可以在后台 System Configuration -&gt; Advanced -&gt; Disable Modules Output 看到你新建的模块。</p>
<p>接下来我们创建一个控制器，让他显示 Hello 09jike!；</p>
<p>首先我们配置一个路由，和magento1路由在config.xml里面配置不一样，magento2的路由配置是一个独立的routes.xml，让我们新建以下文件：</p>
<p>Jike/Hello/etc/frontend/routes.xml</p>
<p>内容如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;../../../../../../lib/internal/Magento/Framework/App/etc/routes.xsd&quot;&gt;
    &lt;router id=&quot;standard&quot;&gt;
        &lt;route id=&quot;jike&quot; frontName=&quot;jike&quot;&gt;
            &lt;module name=&quot;Jike_Hello&quot; /&gt;
        &lt;/route&gt;
    &lt;/router&gt;
&lt;/config&gt;</code></pre>
<p>注意route id 和 frontName 尽量保持一致，这个也是我们的路由的名字 显示的效果应该是web.magento2.com/jike/hello/world</p>
<p>接着我们创建controller和action:</p>
<p>Jike/Hello/Controller/Hello/World.php</p>
<p>内容如下：</p>
<pre><code>&lt;?php
namespace Jike\Hello\Controller\Hello;
class World extends \Magento\Framework\App\Action\Action
&#123;
    public function __construct(
        \Magento\Framework\App\Action\Context $context)
    &#123;
        return parent::__construct($context);
    &#125;
    public function execute()
    &#123;
        echo &#39;Hello 09jike!&#39;;
        exit;
    &#125;
&#125;</code></pre>
<p>如果没有出错的话 将会如下图的一个结果：</p>
<p><img src="http://www.habotalk.com/wp-content/uploads/hello-09jike.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/09/27/magento2-1%E4%B8%BB%E9%A2%98%E5%92%8C%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/27/magento2-1%E4%B8%BB%E9%A2%98%E5%92%8C%E6%8F%92%E4%BB%B6%E7%9A%84%E5%AE%89%E8%A3%85%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">magento2.1主题和插件的安装教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-27 11:11:43" itemprop="dateCreated datePublished" datetime="2017-09-27T11:11:43+08:00">2017-09-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:27" itemprop="dateModified" datetime="2020-10-11T11:53:27+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>很长一段时间，我困惑于如何安装一个magento的主题和插件，可能是长时间对wordpress的琢磨而不能自拔了。好的，今天就跟大家讲讲：magento2.1主题和插件的安装教程</p>
<p>我们先去网络上下载对应的主题和插件，比如主题：<a target="_blank" rel="noopener" href="https://marketplace.magento.com/venustheme-theme-frontend-yume.html">yume主题</a>，插件比如：<a target="_blank" rel="noopener" href="https://marketplace.magento.com/fme-banners.html">Banners插件</a></p>
<p>下载下来后，我们也不要急着安装，先解压看下文件结构，因为很多主题或者插件结构需要对应好，才能被检测到。</p>
<p>主题我们需要看registration.php这个文件，插件也是registration.php这个文件，里面有写这个文件的目录是怎么样的。</p>
<p>我们就以yume这个主题来说，这里需要说明的是，我们下载主题后，有些主题很简单，可能什么也没有，这个一般不怎么靠谱，主题应该是有很多个文件夹和必要的配置文件，以及说明文件组成的：registration.php、theme.xml、config.xml、composer.json等，这些文件应该都要有。如果觉得下载主题不靠谱我们可以打开magento默认的主题luma和下载主题对应一下，看下这些文件是否差不多，毕竟主题不一样，文件也有所差异，但是这些必要的文件应该是需要有的。好了，我们检查好了这一步后，我们就能够进行主题目录的定位，我们下载下来的主题应该放在magento的哪个目录下呢？</p>
<p>注意：以下的内容会很重要，需要仔细阅读。<br>magento1和magento2可能有点不一样，我这里是以magento2.1作为讲解的。registration.php文件夹里的代码如下：</p>
<pre><code>&lt;?php
/**
* Copyright © 2015 Magento. All rights reserved.
* See COPYING.txt for license details.
*/
\Magento\Framework\Component\ComponentRegistrar::register(
 \Magento\Framework\Component\ComponentRegistrar::THEME,
 &#39;frontend/Venustheme/yume&#39;,
 __DIR__
);</code></pre>
<p>说明这个是在magento根目录/app/design/frontend/Venustheme/yume，所以我们下载主题的名字应该是Venustheme文件夹，里面再有一个yume文件夹，最后就是一些文件夹和文件了，这就是主题的文件结构，可能大家还是有点困惑，大家不妨把luma主题用来做对比，luma的registration.php文件的代码如下：</p>
<pre><code>&lt;?php
/**
 * Copyright © 2013-2017 Magento, Inc. All rights reserved.
 * See COPYING.txt for license details.
 */

\Magento\Framework\Component\ComponentRegistrar::register(
 \Magento\Framework\Component\ComponentRegistrar::THEME,
 &#39;frontend/Magento/luma&#39;,
 __DIR__
);</code></pre>
<p>luma主题文件虽然在magento根目录/vendor/magento/theme-frontend-luma下，这个Magento是默认的，所以如果要重写，可能就在这个文件夹里添加代码。</p>
<p>起初，我还把Venustheme这个主题放了一份在magento根目录/vendor/magento/下，并且命名为magento根目录/vendor/magento/theme-frontend-yume，不知道这样是否可行，大家可以去折腾下，反正我是很肤浅的这样复制粘贴，说明我根本没有理解透彻这个主题的设计。当然我这个做法可以用来备用，万一有些个别情况，有的人根据上面的指导还是不行的话，或许我这种拙劣的经历会有一些启发。<br>选择好了，然后查看没啥问题后，就上传，然后就运行命令：</p>
<pre><code>magento setup:upgrade
magento setup:di:compile</code></pre>
<p>这样进入到后台—内容—主题，这个时候你就会看到新添加的yume就出现了。</p>
<p><img src="https://i.imgur.com/J9StXm8.jpg"></p>
<p>然后进入到配置那里，把默认的luma变成新添加的主题，然后刷新前台，就会发生样式上的变化，当然这个仅仅是用作测试，如果用于生产环境，最好找个上好的主题，进行安装配置即可。</p>
<p>如果我们想变回默认主题也很简单，直接在内容—配置—选择默认的主题—进行主题切换—选择luma主题。</p>
<p>好了，我们再来说说安装插件吧</p>
<p>我们下载好了插件的文件后，也是一样的，先看registration.php文件，里面的代码大致如下，这里我以banners这个插件作为讲解。</p>
<pre><code>&lt;?php

\Magento\Framework\Component\ComponentRegistrar::register(
 \Magento\Framework\Component\ComponentRegistrar::MODULE,
 &#39;FME_Banners&#39;,
 __DIR__
 );</code></pre>
<p>虽然我们下载下来的名字是fme-banners-1.0.4，但是我们从上面的代码可以看出插件的文件名应该是FME，然后里面有个Banners文件夹，再里面才是放源码的。这个很重要，这些目录具体怎么样，是由这个registration.php决定好了的。明白这个后，我们就需要解决：插件应该放哪里呢？哪个目录？</p>
<p>magento2.1的插件目录是：magento根目录/app/code(如果没有这个目录，就自己新建一个)/插件位置，比如我要放FME这个插件，那么它的目录就是magento根目录/app/code/FME，</p>
<p>然后我们就在magento根目录下运行命令：</p>
<pre><code>php bin/magento module:status    //查看插件情况</code></pre>
<p>这个时候会在最后显示有个没有被启用的插件：FME_Banners</p>
<p>然后就是启用这个插件，运行命令：</p>
<pre><code>php bin/magento module:enable FME_Banners    //启用特定的插件的写法</code></pre>
<p>如果我们一次性上传了好几个插件的话，然后我们要全部启用这些，该怎么办，我们就不用一个一个的运行启用了，直接运行如下命令：</p>
<pre><code>php bin/magento module:enable --all  //启用所有插件</code></pre>
<p>启用好了后，我们就运行如下命令：</p>
<pre><code>php bin/magento setup:upgrade</code></pre>
<p>更新一下magento，有的时候可能还要运行一下如下命令：</p>
<pre><code>php bin/magento setup:di:compile</code></pre>
<p>完毕后，进入magento后台，就可以看到安装好的扩展了。</p>
<p>这里会有一个特殊情况，比如我们在安装插件的时候，我们已经安装了Mageplaza，这个是一个系列的，就是类似wordpress中的woocommerce的一样，我们可以在magento后台看到Mageplaza这个区块的内容，也有Mageplaza Marketplace，如果我们在这里上面下载的插件的话，当然我们还是要想前面说那样把插件的文件结构确定好，然后命好名，上传的路径不是magento根目录/app/code，而是magento根目录/app/code/Mageplaza，道理很简单，它的和注册文件为：</p>
<pre><code>&lt;?php

\Magento\Framework\Component\ComponentRegistrar::register( 

\Magento\Framework\Component\ComponentRegistrar::MODULE,

 &#39;Mageplaza_Seo&#39;, 

__DIR__

);</code></pre>
<p>所以插件的名字就是应该是：Seo，然后在Seo文件夹下就是插件的源代码。这个值得大家注意，事实上，我下载的这个插件（seo_v1.4.1.2_ce_mageplaza）目录结构如下</p>
<p><img src="https://i.imgur.com/4YTZqx9.jpg"></p>
<p>所以很多时候，不能下载下来就觉得万事大吉了，我们还得看下插件的文件结构，再决定下一步怎么做。相信将来还会遇到更复杂的情况，只要保持冷静，对比，尝试，观察，我们就能举一反三。</p>
<p>有的时候，我在安装一个扩展的是，是一个PDF的扩展，然后报错了，说是没有一个文件或是某个函数什么的，我们在安装插件出错了怎么办，不要着急，根据以下方法走就行。</p>
<p>如果想彻底删除的话，直接删除有问题的插件的文件，就是在magento根目录/app/code/下的需要删除的插件的文件夹。然后更新一下magento，运行命令：</p>
<pre><code>php bin/magento setup:upgrade</code></pre>
<p>或者是，不删除但是我们直接禁用这个有问题的插件，这里我以插件FME_Banners为例，运行命令：</p>
<pre><code>php bin/magento module:disable FME_Banners</code></pre>
<p>这样就禁用了这个插件了，然后更新一下，运行命令：</p>
<pre><code>php bin/magento setup:upgrade</code></pre>
<p>好了，以上就是magento2.1版本中的插件和主题的安装讲解，如有任何疑问可以与我取得联系，QQ：791447771，以上文章为原创，请尊重笔者知识产权，转载请注明出处，谢谢。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/09/15/%E6%9C%80%E7%AE%80%E5%8D%95%E9%9D%A0%E8%B0%B1%E7%9A%84varnish%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/15/%E6%9C%80%E7%AE%80%E5%8D%95%E9%9D%A0%E8%B0%B1%E7%9A%84varnish%E9%85%8D%E7%BD%AE%E6%95%99%E7%A8%8B/" class="post-title-link" itemprop="url">最简单靠谱的varnish配置教程</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-15 17:48:00" itemprop="dateCreated datePublished" datetime="2017-09-15T17:48:00+08:00">2017-09-15</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:52:48" itemprop="dateModified" datetime="2020-10-11T11:52:48+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>先说如何安装varnish的吧。</p>
<p>申请一个云服务器，我申请的是centos7 64位</p>
<p>第一步就是安装varnish，运行命令：</p>
<pre><code>yum install varnish</code></pre>
<p>但是没啥用，一直报错，说是没有这个安装包，nothing to do，后来在serverfault上看到了经典的解决方案。</p>
<p>在纯净的centos7上安装varnish，命令如下：</p>
<pre><code>yum install epel-release
yum install varnish</code></pre>
<p>如何系统里面安装了其他的东西，比如以前安装varnish失败，或者是其他有关varnish的配置，首先你的清除这些东西，可以用如下方法，如下是网友原文：</p>
<p>You installed the jemalloc package from EL6. You need to replace this with the one for EL7. Since you already have the EPEL repo installed, it should be sufficient to do:</p>
<pre><code>yum update jemalloc</code></pre>
<p>Otherwise just remove and reinstall it.</p>
<pre><code>rpm --nodeps -e jemalloc
yum install jemalloc</code></pre>
<p>You installed a repository named varnish-4.0 from somewhere (probably the Varnish Community) but you failed to mention this. You need to remove this, as (a) it’s only intended for EL6, and (b) EPEL already ships Varnish 4.</p>
<pre><code>rpm --nodeps -e $(rpm -qf /etc/yum.repos.d/varnish*.repo)</code></pre>
<p>Finally your system should be clean and you can install Varnish.</p>
<pre><code>yum install varnish</code></pre>
<p>我们可以确保是否安装好了varnish，查一下版本号</p>
<pre><code>varnishd -V</code></pre>
<p>好了，相信你已经解决了varnish安装的问题了。</p>
<hr>
<p>第二步：然后安装web集成环境，我们也可以一个一个的装，不过这样太麻烦，也容易报错，如果用于生产环境中建议自定义安装。</p>
<p>下载中心地址:</p>
<p><a target="_blank" rel="noopener" href="https://www.apachefriends.org/zh_cn/download.html">https://www.apachefriends.org/zh_cn/download.html</a></p>
<p>这里我选择<a target="_blank" rel="noopener" href="https://www.apachefriends.org/xampp-files/7.0.22/xampp-linux-x64-7.0.22-1-installer.run">https://www.apachefriends.org/xampp-files/7.0.22/xampp-linux-x64-7.0.22-1-installer.run</a></p>
<p>把文件拷贝到跟目录下，先赋予执行权限，先确保是根目录，运行命令：</p>
<pre><code>cd /</code></pre>
<p>然后把下载的这个文件上传到服务器根目录，然后赋予权限</p>
<pre><code>[root@jdu4e00u53f7 /]chmod 777 xampp-linux-x64-7.0.22-1-installer.run</code></pre>
<p>然后执行(注意一定要在root权限下执行，如果不是这个时候可以使用su命令进入到root权限):</p>
<pre><code>./xampp-linux-x64-7.0.22-1-installer.run</code></pre>
<p>安装过程遇到确认的地方都选择yes就行，类似如下：</p>
<p><img src="https://i.imgur.com/giDWihj.png"></p>
<p><strong>配置</strong></p>
<p>启动xampp</p>
<pre><code>[root@jdu4e00u53f7 lampp]# ./lampp start
Starting XAMPP for Linux 7.0.22...
XAMPP: Starting Apache...already running.
XAMPP: Starting MySQL...ok.
XAMPP: Starting ProFTPD...ok.
[root@jdu4e00u53f7 lampp]#</code></pre>
<p>启动成功后，可以进入linux的图形界面打开一个浏览器，输入域名（域名需要提前解析到这个服务器的IP上），可以看到xampp的主页，为了安全性，还需要进行一个配置</p>
<p>这样安装后,需要设置相应的权限和密码.</p>
<p>XAMPP 缺乏安全防护的列表：</p>
<p>MySQL 管理员（root）没有密码。</p>
<p>MySQL 可通过网络访问。</p>
<p>ProFTPD 使用“lampp”作为用户名“nobody”的密码。</p>
<p>PhpMyAdmin 可以通过网络访问。</p>
<p>示例程序可以通过网络访问。</p>
<p>MySQL 和 Apache 在同一个用户名（nobody）下运行。</p>
<p>五.输出入安全检查并配置相应密码，在服务器根目录下运行：</p>
<pre><code>/opt/lampp/lampp security</code></pre>
<p>进行相应的设置，有yes的地方输入yes，需要输入密码的地方设置一下密码就行了，为了安全，最好把这些密码记在一个记事本里面，方便查阅，也防止忘记密码给自己带了不必要的麻烦。</p>
<p>注意此时不能打开phpMyAdmin,会提示密码错误或者是403页面.需要配置phpMyAdmin 配制文件（httpd-xampp.conf）,路径在</p>
<pre><code>vi /opt/lampp/etc/extra/httpd-xampp.conf</code></pre>
<p>将 Require local 改成 Require all granted</p>
<pre><code>/opt/lampp/lampp restart   重启xampp</code></pre>
<p>到此xampp安装完成。</p>
<p>第三步：准备一个default.vcl示例文件，其实这个不是必须的，因为varnish里面已经有了这个文件，只不过配置得比较简单，如果需要更丰富的可以下载我使用的这个，<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1mixGnUC">下载地址</a>，密码：5ngt</p>
<p>把default.vcl文件下载到本地，然后重命名云端的为default.vcl.bak，然后去百度云盘下载标准的varnish的配置好的default.vcl文件，当然，我们还有另外一个选择就是新建一个.vcl文件，比如colddoor.vcl文件，然后把从百度云盘下载下来的这个文件的内容拷贝到这个文件中，不过这样的话，需要在varnish.params文件中指定这个文件作为默认配置文件。</p>
<p>值得提醒的是，如果报错的话，可以用回默认的default.vcl即可。</p>
<p>修改服务器端口号（以apache为例），修改/opt/lampp/etc/httpd.conf中的文件，把里面的端口号80改成8080（也可以是其他，建议要端口号设置大点）。</p>
<p>修改varnish.params里面的VARNISH_LISTEN_PORT，改成80，这个可能有些教程写的是-a:80，如果你的也是这样，找不到的话，你可以参考如下：</p>
<p>最开始是在安装完varnish后，会有个配置，我根据magento的开发者文档进行配置，中间有提到</p>
<pre><code>DAEMON_OPTS=&quot;-a :80 \
-T localhost:6082 \
-f /etc/varnish/default.vcl \
-S /etc/varnish/secret \
-s malloc,256m&quot;</code></pre>
<p>最开始我在default.vcl里面没有看到，然后再看下varnish.params这个里面，貌似没有，其实上面的这个东西就在varnish.params这个文件中，只是展示的方式不一样。DAEMON_OPTS包含-a参数的正确侦听端口（即使VARNISH_LISTEN_PORT设置为正确的值），在varnish.params这个文件中就有。</p>
<pre><code># Main configuration file. You probably want to change it.
VARNISH_VCL_CONF=/etc/varnish/default.vcl //相当于-f
# Default address and port to bind to. Blank address means all IPv4
# and IPv6 interfaces, otherwise specify a host name, an IPv4 dotted
# quad, or an IPv6 address in brackets.
# VARNISH_LISTEN_ADDRESS=192.168.1.5
VARNISH_LISTEN_PORT=80 //相当于-a

# Admin interface listen address and port
VARNISH_ADMIN_LISTEN_ADDRESS=127.0.0.1
VARNISH_ADMIN_LISTEN_PORT=6082

# Shared secret file for admin interface
VARNISH_SECRET_FILE=/etc/varnish/secret //相当于-S

# Backend storage specification, see Storage Types in the varnishd(5)
# man page for details.
VARNISH_STORAGE=&quot;malloc,1G&quot; //相当于-s

# User and group for the varnishd worker processes
VARNISH_USER=varnish
VARNISH_GROUP=varnish

# Other options, see the man page varnishd(1)
#DAEMON_OPTS=&quot;-p thread_pool_min=5 -p thread_pool_max=500 -p thread_pool_timeout=300&quot;</code></pre>
<p>好，解决了这个以后，我们继续修改第三个文件，那就是default.vcl，或者是我刚才上面提到的colddoor.vcl中的监听端口号，改成8080，跟apache的web监听端口一致。</p>
<p>然后重启xampp，道理很简单，因为修改了apache的配置文件需要重启。</p>
<blockquote>
<p>注意：这个很重要，因为我们不重启xampp的话，也就是不重启apache就开始重启varnish的话，可能会重启varnish失败。</p>
</blockquote>
<pre><code>/opt/lampp/lampp restart</code></pre>
<p>然后就是重启varnish了。</p>
<pre><code>service varnish restart</code></pre>
<p>重启varnish的时候又出现了一些问题，如果出现问题一般都是在重启apache之前重启varnish，如果Varnish无法启动，请尝试从命令行运行，如下所示：</p>
<pre><code>varnishd -d -f /etc/varnish/default.vcl</code></pre>
<p>这个时候你输入start</p>
<p>显示以下消息以确认成功启动：</p>
<pre><code>child (29805) Started
200 0

Child (29805) said
Child (29805) said Child starts</code></pre>
<p><strong>使用netstat</strong></p>
<p>登录到Varnish所在的服务器（也就是服务器的根目录）并输入以下命令：</p>
<pre><code>netstat -tulpn</code></pre>
<p>特别寻找以下输出：</p>
<pre><code>tcp        0      0 0.0.0.0:80                  0.0.0.0:*                   LISTEN      32614/varnishd
tcp        0      0 127.0.0.1:58484             0.0.0.0:*                   LISTEN      32604/varnishd
tcp        0      0 :::8080                     :::*                        LISTEN      26822/httpd
tcp        0      0 ::1:48509                   :::*                        LISTEN      32604/varnishd</code></pre>
<p>上面显示的是在端口80上运行的varnish和在8080端口上运行的Apache。</p>
<p>如果您看不到输出varnishd，请确保varnish正在运行。</p>
<p>最后，我们就是要检验了，看我们配置的varnish是否在运行，是否成功。</p>
<p>可以通过浏览器访问对应的网页来查看Varnish缓存的效果。如果Varnish缓存成功，第二次打开网页的速度会明显比第一次快，但是这种方式并不能够充分说明问题。下面用命令行方式，通过查看网页头来查看命中情况。</p>
<pre><code>curl -I http://www.cold.net //输入配置好varnish的服务器所对应的域名</code></pre>
<p>如果出现有X-Varnish: 1364285597这样的，如下：</p>
<pre><code>HTTP/1.1 200 OK
Server: Apache/2.2.14 (Unix) PHP/5.3.1 mod_perl/2.0.4 Perl/v5.10.1
Last-Modified: Sat, 10 Jul 2010 11:25:15 GMT
ETag: &quot;5e850b-616d-48b06c6031cc0&quot;
Content-Type: text/html
Content-Length: 24941
Date: Fri, 09 Jul 2010 08:29:16 GMT
X-Varnish: 1364285597
Age: 0
Via: 1.1 varnish
Connection: keep-alive
X-Cache: MISS from www.ixdba.net  #这里的“MISS”表示此次访问没有从缓存读取</code></pre>
<p>说明varnish监听成功了，如果监听不成是不会出现有关varnish的信息。可以使用工具（Fiddler）进行查看网页头部请求信息，也可以使用火狐浏览器开发者工具查看。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/09/13/%E5%88%A9%E7%94%A8bitnami%E4%B8%BAlinux%E4%B8%AD%E7%9A%84xampp%E9%9B%86%E6%88%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E5%BA%94%E7%94%A8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/13/%E5%88%A9%E7%94%A8bitnami%E4%B8%BAlinux%E4%B8%AD%E7%9A%84xampp%E9%9B%86%E6%88%90%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AE%89%E8%A3%85%E5%BA%94%E7%94%A8/" class="post-title-link" itemprop="url">利用bitnami为linux中的xampp集成服务器安装应用</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-13 10:28:38" itemprop="dateCreated datePublished" datetime="2017-09-13T10:28:38+08:00">2017-09-13</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:52:59" itemprop="dateModified" datetime="2020-10-11T11:52:59+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>利用bitnami为linux中的xampp集成服务器安装应用，写下这篇文章的心情是愉快的，经过多次折腾，多次尝试突破自己，自己琢磨出一些快捷的方法，开始是习惯使用一些web集成安装包，以前比较依赖WDCP，阿里云的一键web安装包，这几天尝试了xampp，感觉不错，很容易理解。</p>
<p>好了，我们进入正题吧，当我们申请到服务器后，如果我们是要为web应用提供服务的话，那么我们需要配置一些较底层的服务，像PHP，Mysql，apache，nginx等等。为了方便管理，我们采用了xampp集成安装包，由于我用的是linux（centos7），所以我们去<a target="_blank" rel="noopener" href="https://www.apachefriends.org/zh_cn/index.html">下载</a>对应的安装包。下载好后上传到服务器的根目录，然后进行安装，安装教程在我的博客的另外一篇文章里有。安装完成后，设置一些其他的东西，完毕后，我们就可以安装一些应用了，比如wordpress、magento、opencart等等web应用。</p>
<p>这里需要说一下我们使用这种方式安装的应用是没有demo数据的，像magento，我们会比较喜欢安装有sample-data的magento，当然这个可以在后期进行导入，最方便的就是直接把有示例数据的安装包上传，再独立安装吧。<br>我们先去下载这些应用的bitnami版本的安装包，下载地址：<a target="_blank" rel="noopener" href="https://www.apachefriends.org/download.html%E6%88%96%E8%80%85%E6%98%AFhttps://bitnami.com/stacks">https://www.apachefriends.org/download.html或者是https://bitnami.com/stacks</a></p>
<p>下载完成后，我们上传到服务器根目录，我们这里以wordpress作为讲解，你下载下来的文件应该类似这样的：bitnami-wordpress-4.8.1-0-module-linux-x64-installer.run</p>
<p>然后授予安装的权限：</p>
<pre><code>chmod 755 bitnami-wordpress-4.8.1-0-module-linux-x64-installer.run</code></pre>
<p>然后运行命令：</p>
<pre><code>./bitnami-wordpress-4.8.1-0-module-linux-x64-installer.run</code></pre>
<p>然后会有一些提示，比如选择语言，这个根据自己需求进行选择，这个时候要注意了，第二点：</p>
<p>这个时候会出现类似如下的内容：</p>
<pre><code>Please select the installation language
[1] English - English
[2] Spanish - Español
[3] Brazilian Portuguese - Português Brasileiro
[4] Simplified Chinese - 简体中文
[5] Korean - 한국어
[6] Hebrew - עברית
[7] German - Deutsch
[8] Romanian - Română
[9] Russian - Русский
Please choose an option [1] : 4
----------------------------------------------------------------------------
欢迎来到 Bitnami WordPress模块 安装程序。

----------------------------------------------------------------------------
安装文件夹

请选择Bitnami or XAMPP的安装目录

选择一个文件夹 [/opt/lampp]:

Note: This module requires a pre-existing installation of Bitnami or a 
Bitnami-compatible stack like XAMPP. Please select the previous platform 
installation. For example: /opt/bitnami or /opt/lampp</code></pre>
<p>我一直被困扰在选择一个文件夹这里，我以为是放在htdocs文件夹下，然后就是不断的报错，然后我又放在/opt/bitnami然而，并没有卵用。所以我去查资料，资料上也说得不明不白，于是还是靠自己的智慧吧，然后知道这个就是我要安装的文件夹，因为其他文件夹没有所需的文件了，因为前面我也尝试着把/opt/lampp这个目录下的文件复制到htdocs文件夹下，但是报错。</p>
<p>于是面对这样一个输入框，我果断的按下了enter键，成了！然后就是输入账户名，密码，邮箱等等一系列的输入。</p>
<p>注意：如果你的用户名输入了带有大写字母的，会提示你不要输入含有大写字母的，所以用户名必须全是小写的。</p>
<p>然后安装完成后，在浏览器下输入你的域名/wordpress，就可以看到熟悉的wordpress博客页面了。比如你的域名为（<a target="_blank" rel="noopener" href="http://www.example.com),并且已经解析到这个服务器的ip上了,然后输入http//www.example.com/wordpress%E5%B0%B1%E5%AF%B9%E4%BA%86%EF%BC%8C%E5%A6%82%E6%9E%9C%E6%83%B3%E8%A6%81%E8%BF%9B%E5%85%A5%E5%90%8E%E5%8F%B0%EF%BC%8C%E7%9B%B4%E6%8E%A5%E8%BE%93%E5%85%A5http://www.example.com/wordpress/wp-admin">www.example.com），并且已经解析到这个服务器的ip上了，然后输入http://www.example.com/wordpress就对了，如果想要进入后台，直接输入http://www.example.com/wordpress/wp-admin</a>.</p>
<p>如果我们根据同样的方式安装magento的话，安装完毕后，我们可以通过<a target="_blank" rel="noopener" href="http://www.example.com/magento%E8%AE%BF%E9%97%AE%E7%BD%91%E7%AB%99%E7%9A%84%E5%89%8D%E5%8F%B0%EF%BC%8C%E9%80%9A%E8%BF%87http://www.example.com/magento/admin%E8%AE%BF%E9%97%AE%E5%90%8E%E5%8F%B0%E7%99%BB%E5%BD%95%E5%9C%B0%E5%9D%80%EF%BC%8C%E7%94%A8%E6%88%B7%E5%90%8D%E6%98%AF%E4%BD%A0%E5%AE%89%E8%A3%85%E7%AC%AC%E4%B8%80%E4%B8%AA%E5%BA%94%E7%94%A8%E7%9A%84%E7%94%A8%E6%88%B7%E5%90%8D%EF%BC%8C%E5%AF%86%E7%A0%81%E5%88%99%E6%98%AF%E5%AE%89%E8%A3%85magento%E7%9A%84%E6%97%B6%E5%80%99%E8%AE%BE%E7%BD%AE%E7%9A%84%E5%AF%86%E7%A0%81%E3%80%82">http://www.example.com/magento访问网站的前台，通过http://www.example.com/magento/admin访问后台登录地址，用户名是你安装第一个应用的用户名，密码则是安装magento的时候设置的密码。</a></p>
<p>然后，我们还可以根据自己的需求进行安装其他的应用。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2017/09/06/CentOS%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E7%BB%99%E4%BD%A0%E7%9A%84WordPress%E5%AE%89%E8%A3%85Varnish%E5%8A%A0%E9%80%9F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/09/06/CentOS%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8B%E7%BB%99%E4%BD%A0%E7%9A%84WordPress%E5%AE%89%E8%A3%85Varnish%E5%8A%A0%E9%80%9F/" class="post-title-link" itemprop="url">CentOS服务器下给你的WordPress安装Varnish加速</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-09-06 20:16:34" itemprop="dateCreated datePublished" datetime="2017-09-06T20:16:34+08:00">2017-09-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:35" itemprop="dateModified" datetime="2020-10-11T11:53:35+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Varnish是一款高性能的开源HTTP加速器，挪威最大的在线报纸Verdens Gang (<a target="_blank" rel="noopener" href="http://www.vg.no/">http://www.vg.no</a>) 使用3台Varnish代替了原来的12台squid，性能居然比以前更好。可见Varnish是一个相当强大的加速器。下面罗伊给大家介绍如何在CentOS上安装Varnish来给你的WordPress博客加速。</p>
<p>1，安装Varnsih</p>
<p>使用SSH登录你的VPS，执行下面的命令来安装Varnish：</p>
<pre><code>yum install varnish</code></pre>
<p>然后我们启动Varnish：</p>
<pre><code>/etc/init.d/varnish start</code></pre>
<p>设置为开机启动：</p>
<pre><code>chkconfig –level 345 varnish on</code></pre>
<p>2，配置Varnish</p>
<p>打开default.vcl：</p>
<pre><code>vi /etc/varnish/default.vcl</code></pre>
<p>确认默认的default.vcl和下面的代码相匹配：</p>
<pre><code># Back-End
backend default &#123;
.host = &quot;127.0.0.1&quot;;
.port = &quot;80&quot;;
.connect_timeout = 60s;
.first_byte_timeout = 10s;
.between_bytes_timeout = 10s;
&#125;

# Custom
sub vcl_recv &#123;
remove req.http.X-Forwarded-For;
set req.http.X-Forwarded-For = client.ip;

if (req.url ~ &quot;^/wp-(login|admin)&quot;) &#123;
return (pipe);
&#125;

if (req.http.Cookie ~&quot;(wp-postpass|wordpress_logged_in|comment_author_)&quot;) &#123;
return (pipe);
&#125;

if (req.request == &quot;POST&quot;) &#123;
return (pass);
&#125;

if (req.http.Cache-Control ~ &quot;no-cache&quot;) &#123;
return (pass);
&#125;

if (req.http.Authorization) &#123;
return (pass);
&#125;

if (req.url ~ &quot;\.(jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|pd f|txt|tar|wav|bmp|rtf|js|flv|swf|htm|html)$&quot;) &#123;
unset req.http.Cookie;
unset req.http.Accept-Encoding;
unset req.http.Vary;
return (lookup);
&#125;

if (req.http.Accept-Encoding) &#123;
if (req.url ~ &quot;\.(jpg|png|gif|gz|tgz|bz2|tbz|mp3|ogg)$&quot;) &#123;
remove req.http.Accept-Encoding;
&#125; elsif (req.http.Accept-Encoding ~ &quot;gzip&quot;) &#123;
set req.http.Accept-Encoding = &quot;gzip&quot;;
&#125; elsif (req.http.Accept-Encoding ~ &quot;deflate&quot;) &#123;
set req.http.Accept-Encoding = &quot;deflate&quot;;
&#125; else &#123;
remove req.http.Accept-Encoding;
&#125;
&#125;

if (req.backend.healthy) &#123;
set req.grace = 30s;
&#125; else &#123;
set req.grace = 1h;
&#125;

unset req.http.Cookie;
unset req.http.Vary;
return (lookup);
&#125;

sub vcl_fetch &#123;
set beresp.grace = 1h;
unset beresp.http.set-cookie;
if (req.url ~ &quot;\.(jpg|jpeg|gif|png|ico|css|zip|tgz|gz|rar|bz2|pd f|txt|tar|wav|bmp|rtf|js|flv|swf|htm|html)$&quot;) &#123;
set beresp.ttl = 24h;
&#125; else &#123;
set beresp.ttl = 5m;
&#125;
return (deliver);
&#125;

sub vcl_deliver &#123;
if(obj.hits &gt; 0) &#123;
set resp.http.X-Cache = &quot;HIT&quot;;
&#125; else &#123;
set resp.http.X-Cache = &quot;MISS&quot;;
&#125;
set resp.http.Cache-Control = &quot;private&quot;;
set resp.http.Pragma = &quot;private&quot;;
remove resp.http.X-Varnish;
remove resp.http.Via;
remove resp.http.Age;
remove resp.http.Server;
remove resp.http.X-Powered-By;
&#125;

sub vcl_pipe &#123;
set bereq.http.connection = &quot;close&quot;;
&#125;</code></pre>
<p>配置Varnish的访问端口。Varnish配置默认的访问端口不是80端口，因此需要修改/etc/sysconfig/varnish配置文件，把端口设置为80。</p>
<pre><code># # Default address and port to bind to
# # Blank address means all IPv4 and IPv6 interfaces, otherwise specify
# # a host name, an IPv4 dotted quad, or an IPv6 address in brackets.
# VARNISH_LISTEN_ADDRESS=
VARNISH_LISTEN_PORT=80
#
# # Telnet admin interface listen address and port
VARNISH_ADMIN_LISTEN_ADDRESS=127.0.0.1
VARNISH_ADMIN_LISTEN_PORT=6082
#
# # Shared secret file for admin interface
VARNISH_SECRET_FILE=/etc/varnish/secret</code></pre>
<p>重启Varnish使其生效：</p>
<pre><code>/etc/init.d/varnish restart</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/28/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><span class="page-number current">29</span><a class="page-number" href="/page/30/">30</a><span class="space">&hellip;</span><a class="page-number" href="/page/43/">43</a><a class="extend next" rel="next" href="/page/30/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">泉哥</p>
  <div class="site-description" itemprop="description">日记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">424</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">400</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">泉哥</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"helongquan.github.io","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta name="description" content="日记">
<meta property="og:type" content="website">
<meta property="og:title" content="鸢尾花序">
<meta property="og:url" content="https://helongquan.github.io/page/7/index.html">
<meta property="og:site_name" content="鸢尾花序">
<meta property="og:description" content="日记">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="泉哥">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="https://helongquan.github.io/page/7/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>鸢尾花序</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">鸢尾花序</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-about">

    <a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>About</a>

  </li>
        <li class="menu-item menu-item-tags">

    <a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>Tags</a>

  </li>
        <li class="menu-item menu-item-categories">

    <a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>Categories</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
        <li class="menu-item menu-item-schedule">

    <a href="/schedule/" rel="section"><i class="fa fa-calendar fa-fw"></i>Schedule</a>

  </li>
        <li class="menu-item menu-item-sitemap">

    <a href="/sitemap.xml" rel="section"><i class="fa fa-sitemap fa-fw"></i>Sitemap</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/12/10/%E9%87%87%E7%94%A8javascript%E5%92%8Canimate%E5%AE%9E%E7%8E%B0%E5%BD%93%E9%BC%A0%E6%A0%87%E6%BB%9A%E5%8A%A8%E5%88%B0%E7%AA%97%E5%8F%A3%E7%9A%84%E6%9F%90%E4%B8%AA%E4%BD%8D%E7%BD%AE%E6%89%8D%E5%87%BA%E7%8E%B0css3%E5%8A%A8%E7%94%BB/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/10/%E9%87%87%E7%94%A8javascript%E5%92%8Canimate%E5%AE%9E%E7%8E%B0%E5%BD%93%E9%BC%A0%E6%A0%87%E6%BB%9A%E5%8A%A8%E5%88%B0%E7%AA%97%E5%8F%A3%E7%9A%84%E6%9F%90%E4%B8%AA%E4%BD%8D%E7%BD%AE%E6%89%8D%E5%87%BA%E7%8E%B0css3%E5%8A%A8%E7%94%BB/" class="post-title-link" itemprop="url">采用javascript的offset和css的animate实现当鼠标滚动到窗口的某个位置才出现css3动画的效果</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-10 14:51:01" itemprop="dateCreated datePublished" datetime="2018-12-10T14:51:01+08:00">2018-12-10</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:06" itemprop="dateModified" datetime="2020-10-11T11:58:06+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/javascript/" itemprop="url" rel="index"><span itemprop="name">javascript</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里记录一下关于内容的css动画出现到浏览器视口的时候才启动动画，采用js如何实现这个需求。</p>
<p>这里需要的知识点：</p>
<ol>
<li>javascript的offset</li>
<li>css3的animate动画</li>
</ol>
<p>完整的demo方案代码：</p>
<pre><code>&lt;!DOCTYPE html&gt;
&lt;html lang=&quot;en&quot;&gt;
&lt;head&gt;
    &lt;meta charset=&quot;UTF-8&quot;&gt;
    &lt;title&gt;Document&lt;/title&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;animate.css&quot;&gt;
    &lt;style&gt;
        body&#123;overflow-x: hidden;&#125;
        div&#123;width: 100%;height: 100px;margin: 100px auto 0;background: red;overflow: hidden;&#125;
        div img&#123;
            width:100%;
        &#125;
    &lt;/style&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceInUp,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;flash,2s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;pulse,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;rubberBand,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;shake,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;swing,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;tade,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;wobble,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;jello,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceIn,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceInDown,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceInLeft,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceInRight,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceInUp,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceOut,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceOutDown,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceOutLeft,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceOutRight,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;bounceOutUp,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeIn,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInDown,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInLeft,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInRight,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInUp,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInDownBig,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInLeftBig,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInRightBig,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;fadeInUpBig,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;flip,1s,linear&quot;&gt;&lt;/div&gt;
&lt;div class=&quot;dream&quot; data-animate=&quot;hinge,1s,linear&quot;&gt;&lt;/div&gt;

&lt;script&gt;
// 获取浏览器可见区域高度
var window_height= document.documentElement.clientHeight;
// 用户手动修改浏览器可见区域高度时修改变量
window.onresize=function () &#123;
    window_height=document.documentElement.clientHeight;
&#125;;
// 获取所需效果元素
var My_dream=document.getElementsByClassName(&#39;dream&#39;);
// 鼠标滚轮滚动执行方法
window.onscroll = function()&#123;
    // 获取鼠标滚轮滚动距离
    var _scrollTop = document.body.scrollTop || document.documentElement.scrollTop;

    // 循环类dream
    for (var k=0;k&lt;My_dream.length;k++)&#123;
        if (_scrollTop &gt;= getOffsetTop(My_dream[k]) - window_height &amp;&amp; _scrollTop &lt;= getOffsetTop(My_dream[k]) )&#123;
            My_dream[k].style.animationName=My_dream[k].dataset.animate.split(&#39;,&#39;)[0];
            My_dream[k].style.animationDuration=My_dream[k].dataset.animate.split(&#39;,&#39;)[1];
            My_dream[k].style.animationTimingFunction=My_dream[k].dataset.animate.split(&#39;,&#39;)[2];
        &#125;
    &#125;
&#125;;

// 判断元素父集是否有已定位元素
function getOffsetTop(ele) &#123;
    var rtn = ele.offsetTop;
    var o = ele.offsetParent;
    while(o!=null)
    &#123;
        rtn += o.offsetTop;
        o = o.offsetParent;
    &#125;
    return rtn;
&#125;

// 滚动条等于0时执行第一屏效果
function my_animation() &#123;
    var _scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
    // 效果方法
    for (var k=0;k&lt;My_dream.length;k++)&#123;
        if (_scrollTop &gt;= getOffsetTop(My_dream[k]) - window_height &amp;&amp; _scrollTop &lt;= getOffsetTop(My_dream[k]) )&#123;
            My_dream[k].style.animationName=My_dream[k].dataset.animate.split(&#39;,&#39;)[0];
            My_dream[k].style.animationDuration=My_dream[k].dataset.animate.split(&#39;,&#39;)[1];
            My_dream[k].style.animationTimingFunction=My_dream[k].dataset.animate.split(&#39;,&#39;)[2];
        &#125;
    &#125;
&#125;
my_animation();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;</code></pre>
<p>这个demo采用了css3的animate动画，animate.css可以去<a target="_blank" rel="noopener" href="https://raw.github.com/daneden/animate.css/master/animate.css">官网下载</a>，也可以在这里下载，地址：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1auwwFCyjoR9osc-1EcoDCg">https://pan.baidu.com/s/1auwwFCyjoR9osc-1EcoDCg</a>，密码：7tnz</p>
<p>这个demo里面包含了一系列的动画效果，我们的注意力应该在当鼠标滚动的时候，随着往下滚动，内容显示出来，伴随着动画上面，很显然这个需要javascript代码去实现。</p>
<h3 id="javascript的offset属性"><a href="#javascript的offset属性" class="headerlink" title="javascript的offset属性"></a>javascript的offset属性</h3><p>我们来看demo中的javascript的代码：</p>
<pre><code>&lt;script&gt;
// 获取浏览器可见区域高度
var window_height= document.documentElement.clientHeight;
// 用户手动修改浏览器可见区域高度时修改变量
window.onresize=function () &#123;
    window_height=document.documentElement.clientHeight;
&#125;;
// 获取所需效果元素
var My_dream=document.getElementsByClassName(&#39;dream&#39;);
// 鼠标滚轮滚动执行方法
window.onscroll = function()&#123;
    // 获取鼠标滚轮滚动距离
    var _scrollTop = document.body.scrollTop || document.documentElement.scrollTop;

    // 循环类dream
    for (var k=0;k&lt;My_dream.length;k++)&#123;
        if (_scrollTop &gt;= getOffsetTop(My_dream[k]) - window_height &amp;&amp; _scrollTop &lt;= getOffsetTop(My_dream[k]) )&#123;
            My_dream[k].style.animationName=My_dream[k].dataset.animate.split(&#39;,&#39;)[0];
            My_dream[k].style.animationDuration=My_dream[k].dataset.animate.split(&#39;,&#39;)[1];
            My_dream[k].style.animationTimingFunction=My_dream[k].dataset.animate.split(&#39;,&#39;)[2];
        &#125;
    &#125;
&#125;;

// 判断元素父集是否有已定位元素
function getOffsetTop(ele) &#123;
    var rtn = ele.offsetTop;
    var o = ele.offsetParent;
    while(o!=null)
    &#123;
        rtn += o.offsetTop;
        o = o.offsetParent;
    &#125;
    return rtn;
&#125;

// 滚动条等于0时执行第一屏效果
function my_animation() &#123;
    var _scrollTop = document.body.scrollTop || document.documentElement.scrollTop;
    // 效果方法
    for (var k=0;k&lt;My_dream.length;k++)&#123;
        if (_scrollTop &gt;= getOffsetTop(My_dream[k]) - window_height &amp;&amp; _scrollTop &lt;= getOffsetTop(My_dream[k]) )&#123;
            My_dream[k].style.animationName=My_dream[k].dataset.animate.split(&#39;,&#39;)[0];
            My_dream[k].style.animationDuration=My_dream[k].dataset.animate.split(&#39;,&#39;)[1];
            My_dream[k].style.animationTimingFunction=My_dream[k].dataset.animate.split(&#39;,&#39;)[2];
        &#125;
    &#125;
&#125;
my_animation();
&lt;/script&gt;</code></pre>
<p>这个里面包含丰富的javascript基础知识，如果你是一位初学者，那么这个很值得你好好学习。</p>
<hr>
<p>关于这些基础知识，笔者摘录了网上一些内容，可以参考：</p>
<p>这里是javascript中制作滚动代码的常用属性</p>
<p>页可见区域宽： document.body.clientWidth;</p>
<p>网页可见区域高： document.body.clientHeight;</p>
<p>window.innerHeight;</p>
<p>网页可见区域宽： document.body.offsetWidth   (包括边线的宽);</p>
<p>网页可见区域高： document.body.offsetHeight (包括边线的宽);</p>
<p>网页正文全文宽： document.body.scrollWidth;</p>
<p>网页正文全文高： document.body.scrollHeight;</p>
<p>网页被卷去的高： document.body.scrollTop;</p>
<p>网页被卷去的左： document.body.scrollLeft;</p>
<p>网页正文部分上： window.screenTop;</p>
<p>网页正文部分左： window.screenLeft;</p>
<p>屏幕分辨率的高： window.screen.height;</p>
<p>屏幕分辨率的宽： window.screen.width;</p>
<p>屏幕可用工作区高度： window.screen.availHeight;</p>
<p>上一张示意图吧。</p>
<p><img src="https://i.imgur.com/wI59Hyp.gif"></p>
<p><strong>1、offsetLeft</strong></p>
<p>假设 obj 为某个 HTML 控件。</p>
<p>obj.offsetTop 指 obj 距离上方或上层控件的位置，整型，单位像素。</p>
<p>obj.offsetLeft 指 obj 距离左方或上层控件的位置，整型，单位像素。</p>
<p>obj.offsetWidth 指 obj 控件自身的宽度，整型，单位像素。</p>
<p>obj.offsetHeight 指 obj 控件自身的高度，整型，单位像素。</p>
<p>我们对前面提到的“上方或上层”与“左方或上层”控件作个说明。</p>
<p>例如：</p>
<pre><code>&lt;div id=&quot;tool&quot;&gt;

&lt;input type=&quot;button&quot; value=&quot;提交&quot;&gt;

&lt;input type=&quot;button&quot; value=&quot;重置&quot;&gt;

&lt;/div&gt;</code></pre>
<p>“提交”按钮的 offsetTop 指“提交”按钮距“tool”层上边框的距离，因为距其上边最近的是 “tool” 层的上边框。</p>
<p>“重置”按钮的 offsetTop 指“重置”按钮距“tool”层上边框的距离，因为距其上边最近的是 “tool” 层的上边框。</p>
<p>“提交”按钮的 offsetLeft 指“提交”按钮距“tool”层左边框的距离，因为距其左边最近的是 “tool” 层的左边框。</p>
<p>“重置”按钮的 offsetLeft 指“重置”按钮距“提交”按钮右边框的距离，因为距其左边最近的是“提交”按钮的右边框。</p>
<p>以上属性在 FireFox 中也有效。</p>
<p>另外：我们这里所说的是指 HTML 控件的属性值，并不是 document.body，document.body 的值在不同浏览器中有不同解释（实际上大多数环境是由于对 document.body 解释不同造成的，并不是由于对 offset 解释不同造成的）。</p>
<p><strong>标题：offsetTop 与 style.top 的区别</strong></p>
<p>我们知道 offsetTop 可以获得 HTML 元素距离上方或外层元素的位置，style.top 也是可以的，二者的区别是：</p>
<p>一、offsetTop 返回的是数字，而 style.top 返回的是字符串，除了数字外还带有单位：px。</p>
<p>二、offsetTop 只读，而 style.top 可读写。</p>
<p>三、如果没有给 HTML 元素指定过 top 样式，则 style.top 返回的是空字符串。</p>
<p>offsetLeft 与 style.left、offsetWidth 与 style.width、offsetHeight 与 style.height 也是同样道理。</p>
<p><strong>2、clientHeight</strong></p>
<p>clientHeight</p>
<p>大家对 clientHeight 都没有什么异议，都认为是内容可视区域的高度，也就是说页面浏览器中可以看到内容的这个区域的高度，一般是最后一个工具条以下到状态栏以上的这个区域，与页面内容无关。</p>
<p>offsetHeight</p>
<p>IE、Opera 认为 offsetHeight = clientHeight + 滚动条 + 边框。</p>
<p>NS、FF 认为 offsetHeight 是网页内容实际高度，可以小于 clientHeight。</p>
<p>scrollHeight</p>
<p>IE、Opera 认为 scrollHeight 是网页内容实际高度，可以小于 clientHeight。</p>
<p>NS、FF 认为 scrollHeight 是网页内容高度，不过最小值是 clientHeight。</p>
<p>简单地说</p>
<p>clientHeight 就是透过浏览器看内容的这个区域高度。</p>
<p>NS、 FF 认为 offsetHeight 和 scrollHeight 都是网页内容高度，只不过当网页内容高度小于等于 clientHeight 时，scrollHeight 的值是 clientHeight，而 offsetHeight 可以小于 clientHeight。</p>
<p>IE、Opera 认为 offsetHeight 是可视区域 clientHeight 滚动条加边框。scrollHeight 则是网页内容实际高度。</p>
<p>同理</p>
<p>clientWidth、offsetWidth 和 scrollWidth 的解释与上面相同，只是把高度换成宽度即可。</p>
<p>但是</p>
<p>FF 在不同的 DOCTYPE 中对 clientHeight 的解释不同， xhtml 1 trasitional 中则不是如上解释的。其它浏览器则不存在此问题。</p>
<p>标题：scrollTop、scrollLeft、scrollWidth、scrollHeight</p>
<p><strong>3、scrollLeft</strong></p>
<p>scrollTop 是“卷”起来的高度值，示例：</p>
<pre><code>&lt;div style=&quot;width:100px;height:100px;background-color:#FF0000;overflow:hidden;&quot; id=&quot;p&quot;&gt;

&lt;div style=&quot;width:50px;height:300px;background-color:#0000FF;&quot; id=&quot;t&quot;&gt;如果为 p 设置了 scrollTop，这些内容可能不会完全显示。&lt;/div&gt;

&lt;/div&gt;

&lt;script type=&quot;text/javascript&quot;&gt;

var p = document.getElementById(&quot;p&quot;);

p.scrollTop = 10;

&lt;/script&gt;</code></pre>
<p>由于为外层元素 p 设置了 scrollTop，所以内层元素会向上卷。</p>
<p>scrollLeft 也是类似道理。</p>
<p>我们已经知道 offsetHeight 是自身元素的宽度。</p>
<p>而 scrollHeight 是内部元素的绝对宽度，包含内部元素的隐藏的部分。</p>
<p>上述中 p 的 scrollHeight 为 300，而 p 的 offsetHeight 为 100。</p>
<p>scrollWidth 也是类似道理。</p>
<p>IE 和 FireFox 全面支持，而 Netscape 和 Opera 不支持 scrollTop、scrollLeft（document.body 除外）。</p>
<p>**4、clientLeft **</p>
<p>返回对象的offsetLeft属性值和到当前窗口左边的真实值之间的距离，可以理解为边框的长度</p>
<p>一直以来对offsetLeft，offsetTop，scrollLeft，scrollTop这几个方法很迷糊，花了一天的时间好好的学习了一下．得出了以下的结果：</p>
<p>结论：</p>
<p><strong>1.offsetTop:</strong></p>
<p>当前对象到其上级层顶部的距离.</p>
<p>不能对其进行赋值.设置对象到页面顶部的距离请用style.top属性.</p>
<p><strong>2.offsetLeft :</strong></p>
<p>当前对象到其上级层左边的距离.</p>
<p>不能对其进行赋值.设置对象到页面左部的距离请用style.left属性.</p>
<p><strong>3.offsetWidth :</strong></p>
<p>当前对象的宽度.</p>
<p>与style.width属性的区别在于:如对象的宽度设定值为百分比宽度,则无论页面变大还是变小,style.width都返回此百分比,而offsetWidth则返回在不同页面中对象的宽度值而不是百分比值</p>
<p><strong>4.offsetHeight :</strong></p>
<p>与style.height属性的区别在于:如对象的宽度设定值为百分比高度,则无论页面变大还是变小,style.height都返回此百分比,而offsetHeight则返回在不同页面中对象的高度值而不是百分比值</p>
<p><strong>5.offsetParent :</strong></p>
<p>当前对象的上级层对象.</p>
<p>注意.如果对象是包括在一个DIV中时,此DIV不会被当做是此对象的上级层,(即对象的上级层会跳过DIV对象)上级层是Table时则不会有问题.</p>
<p>利用这个属性，可以得到当前对象在不同大小的页面中的绝对位置．</p>
<p>得到绝对位置脚本代码</p>
<pre><code>function GetPosition(obj)  
&#123;  

 var left = 0;  

 var top   = 0;  

 while(obj != document.body)  

&#123;  

    left = obj.offsetLeft;  

    top   = obj.offsetTop;  

    obj = obj.offsetParent;  

&#125;  
    alert(&quot;Left Is : &quot; + left + &quot;\r\n&quot; + &quot;Top   Is : &quot; + top);  
&#125;</code></pre>
<p><strong>6.scrollLeft :</strong></p>
<p>对象的最左边到对象在当前窗口显示的范围内的左边的距离．</p>
<p>即是在出现了横向滚动条的情况下，滚动条拉动的距离．</p>
<p><strong>7.scrollTop</strong></p>
<p>对象的最顶部到对象在当前窗口显示的范围内的顶边的距离．</p>
<p>即是在出现了纵向滚动条的情况下，滚动条拉动的距离．</p>
<p>我们这里说说四种浏览器对 document.body 的 clientHeight、offsetHeight 和 scrollHeight 的解释，这里说的是 document.body，如果是 HTML 控件，则又有不同。</p>
<p>这四种浏览器分别为IE（Internet Explorer）、NS（Netscape）、Opera、FF（FireFox）。</p>
<p><strong>clientHeight</strong></p>
<p>大家对 clientHeight 都没有什么异议，都认为是内容可视区域的高度，也就是说页面浏览器中可以看到内容的这个区域的高度，一般是最后一个工具条以下到状态栏以上的这个区域，与页面内容无关（即使内容只有一行）。</p>
<p><strong>offsetHeight</strong></p>
<p>IE、Opera 认为 offsetHeight = clientHeight + 滚动条 + 边框。</p>
<p>NS、FF 认为 offsetHeight 是网页内容实际高度，可以小于 clientHeight。</p>
<p><strong>scrollHeight</strong></p>
<p>IE、Opera 认为 scrollHeight 是网页内容实际高度，可以小于 clientHeight。</p>
<p>NS、FF 认为 scrollHeight 是网页内容高度，不过最小值是 clientHeight。</p>
<p>简单地说</p>
<p>clientHeight 就是透过浏览器看内容的这个区域高度。</p>
<p>NS、 FF 认为 offsetHeight 和 scrollHeight 都是网页内容高度，只不过当网页内容高度小于等于 clientHeight 时，scrollHeight 的值是 clientHeight，而 offsetHeight 可以小于 clientHeight。</p>
<p>IE、Opera 认为 offsetHeight 是可视区域 clientHeight 滚动条加边框。scrollHeight 则是网页内容实际高度。</p>
<p>同理</p>
<p>clientWidth、offsetWidth 和 scrollWidth 的解释与上面相同，只是把高度换成宽度即可。</p>
<hr>
<p>了解了这个偏移量的概念之后，我们基本对鼠标滚动，视口与内容的距离等有了一个清晰的了解，我们再看下一些属性。</p>
<ul>
<li>animationName</li>
<li>animationDuration</li>
<li>animationTimingFunction</li>
<li>dataset</li>
</ul>
<p>这些概念，我们都是需要清楚的，这样我们就会明白在遍历的时候，执行相应的自定义属性（<code>data-animate</code>）中的动画。而这些我们都需要明白浏览器的兼容性，有些浏览器是不支持某些css3的特性的。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/12/08/%E8%AE%BE%E8%AE%A1%E5%B8%88%E7%9A%84%E4%BF%AE%E4%B8%BA/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/08/%E8%AE%BE%E8%AE%A1%E5%B8%88%E7%9A%84%E4%BF%AE%E4%B8%BA/" class="post-title-link" itemprop="url">设计师的修为</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-08 19:01:24" itemprop="dateCreated datePublished" datetime="2018-12-08T19:01:24+08:00">2018-12-08</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:06" itemprop="dateModified" datetime="2020-10-11T11:58:06+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E5%BF%83%E5%BE%97/" itemprop="url" rel="index"><span itemprop="name">心得</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我们公司设计师分享的宝贵经验，当然学习他们这些也是很重要的。</p>
<h3 id="网页设计师要有一个营销的思维，这个高级设计师应该具备的能力"><a href="#网页设计师要有一个营销的思维，这个高级设计师应该具备的能力" class="headerlink" title="网页设计师要有一个营销的思维，这个高级设计师应该具备的能力"></a>网页设计师要有一个营销的思维，这个高级设计师应该具备的能力</h3><p>设计一个网页，就比如说首页设计吧，那么首页的作用是什么，首页是干什么的，根据分享，笔者总结了下：</p>
<ol>
<li><p>首页是用来吸引客户了解网站最重要的窗口，首页的东西不应该是网站的全部，而是网站的精华的浓缩，但是又不能表露得太彻底，如果表露得太彻底，那么就没有内页的事了。因此，首页的每一个板块的设计都是大有来头的，而不是平白无故的放置内容上去就行了的。高明的做法是，选择网站每个领域最有代表性的内容精选有限的几个放在首页，分板块放置，文案要写得有意犹未尽，以此吸引用户点击链接进入到内页去了解详情。</p>
</li>
<li><p>找对比，看下优秀的同行的首页是怎么设计以及布局的，以此作为参考，客户也有从众心理：大牌企业都这样干，我们也要。这个就需要调研了，海量访问同行优秀网站参考。</p>
</li>
<li><p>用数据说话，首页的设计是有讲究的，而不是东西越多越好，根据行业数据分析，用户在首页的浏览停留时间大概是5s-8s，这个数据是很关键的，如何让这个时间段内吸引用户这个就是首页设计很重要的一个参考指标。所以在跟客户沟通之所以首页这样设计就是为了能够吸引用户在短时间内有欲望进入到内页浏览。</p>
</li>
<li><p>首页内容的多少，根据用户浏览习惯，首页在手机版上的屏数控制在5屏左右，多了用户没耐心，所以内容放置的多少也可以参考这个指标。</p>
</li>
<li><p>总结：高明的设计师要有一颗营销思维头脑，从经济的角度去考虑设计的理念。</p>
</li>
</ol>
<h3 id="设计师的沟通能力"><a href="#设计师的沟通能力" class="headerlink" title="设计师的沟通能力"></a>设计师的沟通能力</h3><p>当设计需要经常与客户交涉的时候，难免需要沟通，这个时候如何沟通是个很有学位的话题。</p>
<ol>
<li><p>当客户固执己见的时候，我们不要急着去反驳客户，耐心倾听，理解客户的需求再进行自己的表达。因为急着反驳，客户会有逆反心理，到时候无论怎么沟通，客户都感觉自己的需求没有被尊重。</p>
</li>
<li><p>帮助客户去理解自己的设计理念，当我们把自己的设计作品，或者把自己的修改方案给到客户的时候，客户难免会有些不理解，这个时候就是耐心讲解给客户听，为什么这样设计，这样设计是从哪些角度考虑的，比如，这样设计不仅优美（审美观）也符合用户（用户观）的浏览习惯，更符合当前的设计潮流（时代观），而且从网站的性能（技术观）来说，都是大大减少加载时间的，等等各方面的角度去阐述。</p>
</li>
<li><p>倾听客户需求，自己也要有主见，但是不能脱离客户的几个需求点。</p>
</li>
</ol>
<h3 id="售后的几个能力"><a href="#售后的几个能力" class="headerlink" title="售后的几个能力"></a>售后的几个能力</h3><p>公司的售后也是非常重要的岗位，刚好也分享了些，这里整理一下。</p>
<p>售后培训客户的时候，心态要摆正，当我们以培训师培训客户的时候，我们已经不是售后了，我们是客户的老师。就像学校一样，学生的成绩，学生学习吸收的快慢取决于这个老师是如何教的。</p>
<ol>
<li><p>老师如果有100%的能力，而学生只吸收了其中的20%，那么这个老师充其量就是20%的能力。老师的目的就是让传授的知识的100%让学生吸收，可能学生的吸收能力不行，这个时候怎么办？这个时候就考验老师的讲解能力了，能不能以最简单的道理说明最复杂的问题。</p>
</li>
<li><p>当售后去培训客户的时候，我们不能一直觉得自己是个售后，这个时候我们要忘记我们的身份，此时此刻我们是一名老师，听众都是学生。拿出老师的气场，控场能力要表现出来。</p>
</li>
<li><p>讲解之前的准备工作，演练是必要的。</p>
</li>
</ol>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/12/06/%E6%A0%B9%E6%8D%AEIP%E7%BB%9F%E8%AE%A1%E7%82%B9%E5%87%BB%E5%9B%BE%E7%89%87%E7%9A%84%E4%BA%BA%E6%95%B0%EF%BC%8C%E4%BB%A5%E5%8F%8A%E7%BB%9F%E8%AE%A1%E7%82%B9%E5%87%BB%E4%BA%86%E5%93%AA%E5%BC%A0%E5%9B%BE%E7%89%87/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/12/06/%E6%A0%B9%E6%8D%AEIP%E7%BB%9F%E8%AE%A1%E7%82%B9%E5%87%BB%E5%9B%BE%E7%89%87%E7%9A%84%E4%BA%BA%E6%95%B0%EF%BC%8C%E4%BB%A5%E5%8F%8A%E7%BB%9F%E8%AE%A1%E7%82%B9%E5%87%BB%E4%BA%86%E5%93%AA%E5%BC%A0%E5%9B%BE%E7%89%87/" class="post-title-link" itemprop="url">根据IP统计点击图片的人数，以及统计点击了哪张图片</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-12-06 17:09:39" itemprop="dateCreated datePublished" datetime="2018-12-06T17:09:39+08:00">2018-12-06</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:05" itemprop="dateModified" datetime="2020-10-11T11:58:05+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/wordpress/" itemprop="url" rel="index"><span itemprop="name">wordpress</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>客户新要求，希望统计某张图片有多少人点击了。</p>
<p><strong>方案：</strong></p>
<p>在wordpress上我们的做法如下：</p>
<p>在wordpress主题目录里面创建一个文件夹（user_click）用来存放这个需求的相关代码，首先创建一个添加用户信息的php文件（save_click_info.php）,代码如下：</p>
<pre><code>&lt;?php
//字符编码设置，以及处理跨域的问题
header(&quot;Content-type:text/html;charset=utf-8;Access-Control-Allow-Origin:*;Access-Control-Allow-Methods:GET,POST&quot;);
//获取当前文件所在目录
$gen=$_SERVER[&#39;DOCUMENT_ROOT&#39;];
require_once(&quot;$gen/wordpress/wp-config.php&quot;);

//链接mysql服务器 开始
$con = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD);
mysqli_select_db($con, DB_NAME);

//不同环境下获取真实的IP
// $ip = $_SERVER[&quot;REMOTE_ADDR&quot;];
$user_IP = ($_SERVER[&quot;HTTP_VIA&quot;]) ? $_SERVER[&quot;HTTP_X_FORWARDED_FOR&quot;] : $_SERVER[&quot;REMOTE_ADDR&quot;];
$ip = ($user_IP) ? $user_IP : $_SERVER[&quot;REMOTE_ADDR&quot;];
$url = $_GET[&#39;urls&#39;];
$created_time = date(&quot;Y-m-d H:i:s&quot;);

$getold = mysqli_query($con,&quot;SELECT * FROM user_click WHERE url = &#39;$url&#39; and ip = &#39;$ip&#39;&quot;);

if (mysqli_num_rows($getold) &lt; 1) &#123;
    $sql = &quot;INSERT INTO user_click (url,ip,created_time) VALUES (&#39;$url&#39;,&#39;$ip&#39;,&#39;$created_time&#39;)&quot;;
&#125;else&#123;
    $sql = &quot;UPDATE user_click SET created_time = &#39;$created_time&#39; WHERE url = &#39;$url&#39; and ip = &#39;$ip&#39;&quot;;
&#125;

$result = mysqli_query($con,$sql);
if (!$result) &#123;
    printf(&quot;Error: %s\n&quot;, mysqli_error($con));
    exit();
&#125;
$jarr = array();
while ($rows=mysqli_fetch_array($result,MYSQL_ASSOC))&#123;
    $count=count($rows);  
    for($i=0;$i&lt;$count;$i++)&#123;
        unset($rows[$i]);  
    &#125;
    array_push($jarr,$rows);
&#125;
//查看数组
echo $str=json_encode($jarr,JSON_UNESCAPED_UNICODE);//将数组进行json编码，并且解决中文乱码的问题
mysqli_close($con);
?&gt;</code></pre>
<p>由于笔者在本地测试，wordpress网站在服务器的目录是www/wordpress，所以这里写成：</p>
<pre><code>require_once(&quot;$gen/wordpress/wp-config.php&quot;);</code></pre>
<p>如果是单纯的放在本地服务器的根目录下，那么就写成：</p>
<pre><code>require_once(&quot;$gen/wp-config.php&quot;);</code></pre>
<p>这里调用了wordpress配置文件的信息，里面有数据库账号信息，这样就实现了获取网站的数据库信息，以便保存数据到数据库的表中。</p>
<p>数据表：user_click，相关的sql代码：</p>
<pre><code>SET FOREIGN_KEY_CHECKS=0;

-- ----------------------------
-- Table structure for user_click
-- ----------------------------
DROP TABLE IF EXISTS `user_click`;
CREATE TABLE `user_click` (
  `url` varchar(255) DEFAULT NULL,
  `ip` varchar(255) DEFAULT NULL,
  `created_time` timestamp NULL DEFAULT NULL ON UPDATE CURRENT_TIMESTAMP
) ENGINE=InnoDB DEFAULT CHARSET=utf8;

-- ----------------------------
-- Records of user_click
-- ----------------------------
INSERT INTO `user_click` VALUES (&#39;http://www.baidu.com&#39;, &#39;23.112.105.114&#39;, &#39;2018-12-06 06:45:59&#39;);
INSERT INTO `user_click` VALUES (&#39;http://www.alibaba.com&#39;, &#39;110.201.8.88&#39;, &#39;2018-12-06 06:45:59&#39;);</code></pre>
<p>然后就是创建一个获取用户点击图片信息的php文件（get_click_info.php），代码如下：</p>
<pre><code>&lt;?php
header(&quot;Content-type:text/html;charset=utf-8;Access-Control-Allow-Origin:*;Access-Control-Allow-Methods:GET,POST&quot;);//字符编码设置

//获取当前文件所在目录
$gen=$_SERVER[&#39;DOCUMENT_ROOT&#39;];
require_once(&quot;$gen/wordpress/wp-config.php&quot;);

//链接mysql服务器 开始
$con = mysqli_connect(DB_HOST, DB_USER, DB_PASSWORD);
mysqli_select_db($con, DB_NAME);

// 检测连接
$sql = &quot;SELECT * FROM user_click&quot;;
$result = mysqli_query($con,$sql);
if (!$result) &#123;
    printf(&quot;Error: %s\n&quot;, mysqli_error($con));
    exit();
&#125;

$jarr = array();
while ($rows=mysqli_fetch_array($result,MYSQL_ASSOC))&#123;
    $count=count($rows);//不能在循环语句中，由于每次删除 row数组长度都减小  
    for($i=0;$i&lt;$count;$i++)&#123;
        unset($rows[$i]);//删除冗余数据  
    &#125;
    array_push($jarr,$rows);
&#125;
//查看数组
// print_r($jarr);
echo $str=json_encode($jarr,JSON_UNESCAPED_UNICODE);//将数组进行json编码，并且解决中文乱码的问题
mysqli_close($con);
?&gt;</code></pre>
<p>剩下的就是一个js文件了，我们在user_click文件夹中创建它（js.js）,代码如下：</p>
<pre><code>$(document).ready(function()&#123;
    $roots = &quot;http://localhost:8080/wordpress/wp-content/themes/nocti/user_click&quot;;

    htmlob= $.ajax(&#123;
        url: $roots+&quot;/get_click_info.php&quot;,
        type: &quot;get&quot;,
        dataType: &quot;json&quot;,
        contentType: &quot;application/json&quot;,
        success: function (res) &#123;
            console.log(res);
        &#125;,
        error: function (xhr, err, exception) &#123;
            console.log(err);
        &#125;
    &#125;);

    $(&quot;#renus&quot;).on(&quot;click&quot;,&quot;img&quot;,function()&#123;
        var ss =new Object();
        ss.urls = $(this).attr(&quot;src&quot;);
        console.log(ss.urls);

        $.ajax(&#123;
            url: $roots+&quot;/save_click_info.php&quot;,
            type: &quot;get&quot;,
            dataType: &quot;json&quot;,
            data: ss,
            contentType: &quot;application/json&quot;,
            success: function (res) &#123;
                console.log(res);
            &#125;,
            error: function (xhr, err, exception) &#123;
                console.log(err);
            &#125;
        &#125;);
    &#125;);

    $(&quot;#contact&quot;).on(&quot;click&quot;,&quot;img&quot;,function()&#123;
        var ss =new Object();
        ss.urls = $(this).attr(&quot;src&quot;);
        console.log(ss.urls);

        $.ajax(&#123;
            url: $roots+&quot;/save_click_info.php&quot;,
            type: &quot;get&quot;,
            dataType: &quot;json&quot;,
            data: ss,
            contentType: &quot;application/json&quot;,
            success: function (res) &#123;
                console.log(res);
            &#125;,
            error: function (xhr, err, exception) &#123;
                console.log(err);
            &#125;
        &#125;);
    &#125;);
&#125;);</code></pre>
<p>这个里面很简单，就是处理了几个ajax请求，我们在页面中添加两个图片，分别为这个图片添加两个ID，</p>
<pre><code>&lt;div class=&quot;avia_textblock&quot; id=&quot;renus&quot;&gt;
   &lt;img src=&quot;http://localhost:8080/wordpress/wp-content/uploads/2018/12/he.jpg&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;
&lt;/div&gt;

&lt;div class=&quot;avia_textblock&quot; id=&quot;contact&quot;&gt;
   &lt;img src=&quot;http://localhost:8080/wordpress/wp-content/uploads/2018/12/51911.jpg&quot; alt=&quot;&quot; width=&quot;100%&quot;&gt;
&lt;/div&gt;</code></pre>
<p>然后，就是点击图片发起ajax请求，把获取的信息保存的数据中。</p>
<p>最后，我只需要在公共头部或者公共底部添加对这个js文件的引用了。笔者这里采用header.php，在</head>前面添加：</p>
<pre><code>&lt;script src=&quot;&lt;?php bloginfo(&#39;template_url&#39;); ?&gt;/js/jquery-3.2.1.min.js&quot;&gt;&lt;/script&gt;   //依赖了jquery，因此这里需要引入这个库
&lt;script src=&quot;&lt;?php bloginfo(&#39;template_url&#39;); ?&gt;/user_click/js.js&quot;&gt;&lt;/script&gt;</code></pre>
<p>好的，完成这个之后，我们就可以在前台点击上面这两种图片，我们就可以在数据表中收集到信息了。</p>
<p>本文旨在抛砖引玉，真正用到生产环境中，需要优化一下,最后的效果：</p>
<p><img src="https://i.imgur.com/WaJw9hs.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/30/%E9%87%8D%E7%BD%AEmagento1-x%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/30/%E9%87%8D%E7%BD%AEmagento1-x%E7%AE%A1%E7%90%86%E5%91%98%E5%AF%86%E7%A0%81/" class="post-title-link" itemprop="url">重置magento1.x管理员密码</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-30 11:06:43" itemprop="dateCreated datePublished" datetime="2018-11-30T11:06:43+08:00">2018-11-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:07" itemprop="dateModified" datetime="2020-10-11T11:58:07+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento1/" itemprop="url" rel="index"><span itemprop="name">magento1</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>原文链接和内容：</p>
<p><a target="_blank" rel="noopener" href="https://magento2.atlassian.net/wiki/spaces/m1wiki/pages/14024839/Resetting+the+admin+Password">https://magento2.atlassian.net/wiki/spaces/m1wiki/pages/14024839/Resetting+the+admin+Password</a></p>
<p>If you are having troubles and want to reset it to a different password, just run at your sql database:</p>
<pre><code>SELECT * FROM admin_user;</code></pre>
<p>Then, find the username you want to modify in the listing provided - ‘admin’ in this example. Then, to update the password, type:</p>
<pre><code>UPDATE admin_user SET password=CONCAT(MD5(&#39;qXpassword&#39;), &#39;:qX&#39;) WHERE username=&#39;admin&#39;;</code></pre>
<p>‘qX’ would be changed to whatever you want it to be and same goes for ‘password’</p>
<p>You can also do this in phpMyAdmin, find the admin_user field and choose MD5 when updating password.</p>
<p>If you want to add a new admin user, you must not only create a new entry in the table ‘admin_user’, but you also have to insert an entry in the table ‘admin_role’ which has to be associated with the user by the field ‘user_id’.</p>
<p>说明：</p>
<p>如果你想要修改自己的magento管理员账号信息，比如修改密码，那么我们可以进入到数据库里面运行命令：</p>
<pre><code>SELECT * FROM admin_user;</code></pre>
<p>先查询有哪些管理员，然后就是选择自己要修改的那个账号，比如这里是admin这个账号。</p>
<pre><code>UPDATE admin_user SET password=CONCAT(MD5(&#39;qXpassword&#39;), &#39;:qX&#39;) WHERE username=&#39;admin&#39;;</code></pre>
<p>这个里面对密码采用md5加密，password这里是你的密码，qX是一个自己随意添加用来跟密码拼接的字符串，当用来做MD5加密的时候作为混淆。比如笔者是这样更新另外一个管理员账号信息的，</p>
<pre><code>UPDATE admin_user SET password=CONCAT(MD5(&#39;nbabc123456&#39;),&#39;:nb&#39;) WHERE username=&#39;zhang san&#39;;</code></pre>
<p>更新后管理员账号名是：zhang san，密码：abc123456</p>
<p><strong>提示：</strong>这里运用sql的CONCAT函数进行拼接字符串。这里科目一下这个函数吧。</p>
<p>SQL CONCAT函数用于将两个字符串连接起来，形成一个单一的字符串。试试下面的例子：</p>
<pre><code>SQL&gt; SELECT CONCAT(&#39;FIRST &#39;, &#39;SECOND&#39;);
+----------------------------+
| CONCAT(&#39;FIRST &#39;, &#39;SECOND&#39;) |
+----------------------------+
| FIRST SECOND               |
+----------------------------+
1 row in set (0.00 sec)</code></pre>
<p>想要更详细了解CONCAT函数，考虑EMPLOYEE_TBL的表具有以下记录：</p>
<pre><code>SQL&gt; SELECT * FROM employee_tbl;
+------+------+------------+--------------------+
| id   | name | work_date  | daily_typing_pages |
+------+------+------------+--------------------+
|    1 | John | 2007-01-24 |                250 |
|    2 | Ram  | 2007-05-27 |                220 |
|    3 | Jack | 2007-05-06 |                170 |
|    3 | Jack | 2007-04-06 |                100 |
|    4 | Jill | 2007-04-06 |                220 |
|    5 | Zara | 2007-06-06 |                300 |
|    5 | Zara | 2007-02-06 |                350 |
+------+------+------------+--------------------+
7 rows in set (0.00 sec)</code></pre>
<p>现在，假设根据上述表要连接名员工ID和work_date，那么你可以使用下面的命令：</p>
<pre><code>SQL&gt; SELECT CONCAT(id, name, work_date) FROM employee_tbl;
+-----------------------------+
| CONCAT(id, name, work_date) |
+-----------------------------+
| 1John2007-01-24             |
| 2Ram2007-05-27              |
| 3Jack2007-05-06             |
| 3Jack2007-04-06             |
| 4Jill2007-04-06             |
| 5Zara2007-06-06             |
| 5Zara2007-02-06             |
+-----------------------------+
7 rows in set (0.00 sec)</code></pre>
<p>到此为止，谢谢。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/30/magento1-x%E7%94%9F%E6%88%90%E4%BC%98%E6%83%A0%E5%88%B8%E5%92%8C%E6%89%B9%E9%87%8F%E7%94%9F%E6%88%90%E4%BC%98%E6%83%A0%E5%88%B8/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/30/magento1-x%E7%94%9F%E6%88%90%E4%BC%98%E6%83%A0%E5%88%B8%E5%92%8C%E6%89%B9%E9%87%8F%E7%94%9F%E6%88%90%E4%BC%98%E6%83%A0%E5%88%B8/" class="post-title-link" itemprop="url">magento1.x生成优惠券和批量生成优惠券</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-30 09:18:29" itemprop="dateCreated datePublished" datetime="2018-11-30T09:18:29+08:00">2018-11-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:57:58" itemprop="dateModified" datetime="2020-10-11T11:57:58+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento1/" itemprop="url" rel="index"><span itemprop="name">magento1</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本文主要目的就是生成magento1.x的优惠券，以及批量生成优惠券。</p>
<h2 id="生成单张优惠券"><a href="#生成单张优惠券" class="headerlink" title="生成单张优惠券"></a>生成单张优惠券</h2><p>首先，登录magento后台，来到Promotions—Shopping Cart Price Rule，然后新建一个促销规则。</p>
<p><img src="https://i.imgur.com/SH2ka58.jpg"></p>
<p>接着往下填写，我们就可以设置自己的优惠券码了，</p>
<p><img src="https://i.imgur.com/jjcdqDu.jpg"></p>
<p>然后我们再完成优惠券的使用规则和条件设置之后，点击保存即可完成，我们就可以去前台使用了。</p>
<h2 id="批量生成优惠券"><a href="#批量生成优惠券" class="headerlink" title="批量生成优惠券"></a>批量生成优惠券</h2><p>我们跟着前面的来进行，我们看到在设置优惠券的地方，下面有个复选框（Use Auto Generation），勾选这个复选框之后，点击保存，我们就可以看到还多了一个设置项：</p>
<p><img src="https://i.imgur.com/uQgWxru.jpg"></p>
<p><img src="https://i.imgur.com/nDLddNS.jpg"></p>
<p>我们来到Manage Coupon Codes，里面有一些设置：</p>
<pre><code>Coupon Qty *

Code Length *

Code Format *

Code Prefix

Code Suffix

Dash Every X Characters</code></pre>
<p><img src="https://i.imgur.com/BlX1WmH.jpg"></p>
<p>这里包含了生成优惠券的个数，优惠券的长度，以及优惠券的格式，有随机生成的格式，也有数字格式等。接着就是优惠券的前缀，优惠券的后缀，以及划掉每个有x的字符等，设置完成之后，点击下方按钮即可批量生成。</p>
<p><img src="https://i.imgur.com/eMajR4J.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/29/magento1-x%E9%87%8D%E5%86%99%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C%E9%A1%B5%E9%9D%A2%EF%BC%8C%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AD%97%E6%AE%B5%E6%AF%94%E5%A6%82%E9%82%80%E8%AF%B7%E7%A0%81%EF%BC%8C%E8%81%8C%E4%B8%9A%E7%AD%89%E5%AD%97%E6%AE%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/29/magento1-x%E9%87%8D%E5%86%99%E7%94%A8%E6%88%B7%E6%B3%A8%E5%86%8C%E9%A1%B5%E9%9D%A2%EF%BC%8C%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E5%AD%97%E6%AE%B5%E6%AF%94%E5%A6%82%E9%82%80%E8%AF%B7%E7%A0%81%EF%BC%8C%E8%81%8C%E4%B8%9A%E7%AD%89%E5%AD%97%E6%AE%B5/" class="post-title-link" itemprop="url">magento1.x重写用户注册页面，添加用户自定义的字段比如邀请码，职业等字段</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-29 18:38:23" itemprop="dateCreated datePublished" datetime="2018-11-29T18:38:23+08:00">2018-11-29</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:57:59" itemprop="dateModified" datetime="2020-10-11T11:57:59+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento1/" itemprop="url" rel="index"><span itemprop="name">magento1</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本文将会讲解如下几个问题：</p>
<ol>
<li>通过重写magento的customer模块，对用户注册页面进行字段的添加</li>
<li>获取添加的自定义字段，显示到用户个人中心</li>
<li>对新注册用户发送一条优惠券到个人中心</li>
<li>邀请码在网站后台设置，用户填写的邀请码只要在后台设置的邀请码列表中的将会获得一条优惠券</li>
</ol>
<p>参考原文链接：<a target="_blank" rel="noopener" href="https://magento.stackexchange.com/questions/65751/add-new-field-in-magento1-9-customer-registration">https://magento.stackexchange.com/questions/65751/add-new-field-in-magento1-9-customer-registration</a></p>
<h2 id="重写customer模块"><a href="#重写customer模块" class="headerlink" title="重写customer模块"></a>重写customer模块</h2><p>新建一个模块在app/code/local下，比如这里的package命名为：StackExchange，模块名命名为：Customer（废话，既然要重写Customer，当然是要这个名字了）</p>
<p>在目录app/etc/modules/，新建StackExchange_Customer.xml，代码如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;StackExchange_Customer&gt;
            &lt;active&gt;true&lt;/active&gt;
            &lt;codePool&gt;local&lt;/codePool&gt;
            &lt;depends&gt;&lt;Mage_Customer/&gt;&lt;/depends&gt;
        &lt;/StackExchange_Customer&gt;
    &lt;/modules&gt;
&lt;/config&gt;</code></pre>
<p>新建目录app/code/local/StackExchange/Customer/etc/config.xml，config.xml的代码如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config&gt;
    &lt;modules&gt;
        &lt;StackExchange_Customer&gt;
            &lt;version&gt;1.0.0&lt;/version&gt;
        &lt;/StackExchange_Customer&gt;
    &lt;/modules&gt;
    &lt;global&gt;
        &lt;helpers&gt;
            &lt;stackexchange_customer&gt;
                &lt;class&gt;StackExchange_Customer_Helper&lt;/class&gt;
            &lt;/stackexchange_customer&gt;
        &lt;/helpers&gt;
        &lt;resources&gt;
            &lt;stackexchange_customer_setup&gt;
                &lt;setup&gt;
                    &lt;module&gt;StackExchange_Customer&lt;/module&gt;
                    &lt;class&gt;Mage_Customer_Model_Resource_Setup&lt;/class&gt;
                &lt;/setup&gt;
            &lt;/stackexchange_customer_setup&gt;
        &lt;/resources&gt;
    &lt;/global&gt;
    &lt;frontend&gt;
        &lt;layout&gt;
            &lt;updates&gt;
                &lt;stackexchange_customer&gt;
                    &lt;file&gt;stackexchange_customer.xml&lt;/file&gt;
                &lt;/stackexchange_customer&gt;
            &lt;/updates&gt;
        &lt;/layout&gt;
        &lt;translate&gt;
            &lt;modules&gt;
                &lt;StackExchange_Customer&gt;
                    &lt;files&gt;
                        &lt;default&gt;StackExchange_Customer.csv&lt;/default&gt;
                    &lt;/files&gt;
                &lt;/StackExchange_Customer&gt;
            &lt;/modules&gt;
        &lt;/translate&gt;
    &lt;/frontend&gt;
&lt;/config&gt;</code></pre>
<p>新建目录app/code/local/StackExchange/Customer/sql/stackexchange_customer_setup/install-1.0.0.php</p>
<p>这个是安装文件，添加新的属性到数据表中，<code>install-1.0.0.php</code>代码如下：</p>
<pre><code>&lt;?php
$this-&gt;addAttribute(&#39;customer&#39;, &#39;license_number&#39;, array(
    &#39;type&#39;      =&gt; &#39;varchar&#39;,
    &#39;label&#39;     =&gt; &#39;License Number&#39;,
    &#39;input&#39;     =&gt; &#39;text&#39;,
    &#39;position&#39;  =&gt; 120,
    &#39;required&#39;  =&gt; false,//or true
    &#39;is_system&#39; =&gt; 0,
));
$attribute = Mage::getSingleton(&#39;eav/config&#39;)-&gt;getAttribute(&#39;customer&#39;, &#39;license_number&#39;);
$attribute-&gt;setData(&#39;used_in_forms&#39;, array(
    &#39;adminhtml_customer&#39;,
    &#39;checkout_register&#39;,
    &#39;customer_account_create&#39;,
    &#39;customer_account_edit&#39;,
));
$attribute-&gt;setData(&#39;is_user_defined&#39;, 0);
$attribute-&gt;save();</code></pre>
<p>这里需要说明一下如果是测试话，最好第二次运行的时候，先去相应的几张表里面删除license_number这个字段，原味是这样说的：</p>
<blockquote>
<p>i follow as per you way, but the field not show on the admin crate user page. – senthil May 6 ‘15 at 5:32<br>@senthil. You are right. Sorry about that. I pasted the wrong install script. I updated the answer with the correct app/code/local/StackExchange/Customer/sql/stackexchange_customer_setup/install-1.0.0.php file. Since you already installed the module, the new install script won’t run again. To make it run again you need to delete from the table eav_attribute the attribute with the code license_number and from the table core_resource the record with the code StackExchange_Customer. Clear the cache and refresh the page. The install script should run again.</p>
</blockquote>
<blockquote>
<p>If you plan to add other fields you should clone install-1.0.0 to upgrade-1.0.0-1.0.1 and do your modifications in the cloned file. Then change the version tag in config.xml to 1.0.1. See how upgrade scripts work here:<a target="_blank" rel="noopener" href="http://magento.stackexchange.com/q/26313/146">http://magento.stackexchange.com/q/26313/146</a></p>
</blockquote>
<p>大家需要这几个数据表中国删除，或者把install-1.0.0.php这个文件复制一份，然后命名成更高版本的。具体的可以看下笔者写过类似这样一篇文章的。</p>
<p>新建目录app/code/local/StackExchange/Customer/Helper/Data.php，Data.php代码如下：</p>
<pre><code>&lt;?php
class StackExchange_Customer_Helper_Data extends Mage_Core_Helper_Abstract
&#123;

&#125;</code></pre>
<p>这将为用户户添加属性。它应该在后台运行得很好。可是，您现在必须手动编辑前端模板，因为Magento没有任何事件或空块可以放置这个字段。为此，您需要以下内容，</p>
<p>app/design/frontend/yourtheme/default/layout/stackexchange_customer.xml，代码如下：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;layout&gt;
    &lt;customer_account_edit&gt;
        &lt;reference name=&quot;customer_edit&quot;&gt;
            &lt;action method=&quot;setTemplate&quot;&gt;
                &lt;template&gt;stackexchange_customer/form/edit.phtml&lt;/template&gt;
            &lt;/action&gt;
        &lt;/reference&gt;
    &lt;/customer_account_edit&gt;
    &lt;customer_account_create&gt;
        &lt;reference name=&quot;customer_form_register&quot;&gt;
            &lt;action method=&quot;setTemplate&quot;&gt;
                &lt;template&gt;stackexchange_customer/register.phtml&lt;/template&gt;
            &lt;/action&gt;
        &lt;/reference&gt;
    &lt;/customer_account_create&gt;
&lt;/layout&gt;</code></pre>
<p>在模板目录下，新建这个布局文件里面的两个文件edit.phtml和register.phtml</p>
<p>新建目录app/design/frontend/yourtheme/default/template/stackexchange_customer/register.phtml </p>
<p>这个是用户注册模板.</p>
<p>我们需要去app/design/frontend/yourtheme/default/template/persistent/customer/form/register.phtml，复制这个register.phtml里面的代码，然后粘贴到新建的这个app/design/frontend/yourtheme/default/template/stackexchange_customer/register.phtml里面去。然后添加如下代码到合适的位置：</p>
<pre><code>&lt;li&gt;
    &lt;label for=&quot;license_number&quot;&gt;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&lt;/label&gt;
    &lt;div class=&quot;input-box&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;license_number&quot; id=&quot;license_number&quot; value=&quot;&lt;?php echo $this-&gt;escapeHtml($this-&gt;getFormData()-&gt;getLicenseNumber()) ?&gt;&quot; title=&quot;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&quot; class=&quot;input-text&quot; /&gt;
    &lt;/div&gt;
&lt;/li&gt;</code></pre>
<p>比如笔者想要在电邮后面添加邀请码，那么就在：</p>
<pre><code>&lt;li class=&quot;wide&quot;&gt;
    &lt;label for=&quot;email_address&quot; class=&quot;required&quot;&gt;&lt;em&gt;*&lt;/em&gt;&lt;?php echo $this-&gt;__(&#39;Email Address&#39;) ?&gt;&lt;/label&gt;
    &lt;div class=&quot;input-box&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;email&quot; id=&quot;email_address&quot; value=&quot;&lt;?php echo $this-&gt;escapeHtml($this-&gt;getFormData()-&gt;getEmail()) ?&gt;&quot; title=&quot;&lt;?php echo $this-&gt;__(&#39;Email Address&#39;) ?&gt;&quot; class=&quot;input-text validate-email required-entry&quot; /&gt;
    &lt;/div&gt;
&lt;/li&gt;</code></pre>
<p>这个后面添加即可。</p>
<p>接着一样的，我们新建目录/app/design/frontend/base/default/template/stackexchange_customer/form/edit.phtml，并且复制目录app/design/frontend/yourtheme/default/template/customer/form/edit.phtml中的代码到我们新建的这个edit.phtml中，然后在这个新建的文件中的合适位置添加如下代码：</p>
<pre><code>&lt;li&gt;
    &lt;label for=&quot;license_number&quot;&gt;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&lt;/label&gt;
    &lt;div class=&quot;input-box&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;license_number&quot; id=&quot;license_number&quot; value=&quot;&lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;&quot; title=&quot;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&quot; class=&quot;input-text&quot; /&gt;
    &lt;/div&gt;
&lt;/li&gt;</code></pre>
<p>这里需要提醒一下：</p>
<p>咋看，我们在这两个新建的文件里面的添加的自定义代码很相似，其中我们需要注意的是htmlEscape()和escapeHtml()，这两个函数在magento中的区别：</p>
<blockquote>
<p>The answer is found in the class where it is defined: app/code/core/Mage/Core/Block/Abstract.php</p>
<p>So it seems that some time after version CE 1.4.0.0-rc1 they decided that htmlEscape should be renamed to escapeHtml.</p>
</blockquote>
<p>意思就是在社区版1.4后面的版本，这个就被命名为escapeHtml了，所以尽量用escapeHtml。</p>
<p>您还可以创建翻译文件，尽管不是强制性的，但是这样做会很不错，方便后面进行多语言翻译。</p>
<p>新建目录app/locale/en_US/StackExchange_Customer.csv，StackExchange_Customer.csv内容如下：</p>
<pre><code>&quot;License Number&quot;,&quot;License Number&quot;</code></pre>
<p>然后，清除缓存就可以去注册页面看到效果了。</p>
<h2 id="获取添加的自定义字段，显示到用户个人中心"><a href="#获取添加的自定义字段，显示到用户个人中心" class="headerlink" title="获取添加的自定义字段，显示到用户个人中心"></a>获取添加的自定义字段，显示到用户个人中心</h2><p>我们如果想要把这个添加的自定义的邀请码显示到某个页面或者某个地方的时候，怎么做呢？我们不妨来到edit.phtml这个页面，就是前面我们创建的那个，当我们在用户的个人中心点击编辑的时候，就可以看到我们在注册的时候添加的那个邀请码，</p>
<pre><code>&lt;li&gt;
    &lt;label for=&quot;license_number&quot;&gt;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&lt;/label&gt;
    &lt;div class=&quot;input-box&quot;&gt;
        &lt;input type=&quot;text&quot; name=&quot;license_number&quot; id=&quot;license_number&quot; value=&quot;&lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;&quot; title=&quot;&lt;?php echo $this-&gt;__(&#39;License Number&#39;) ?&gt;&quot; class=&quot;input-text&quot; /&gt;
    &lt;/div&gt;
&lt;/li&gt;</code></pre>
<p>根据这个代码，我们可以看到这个是来自：</p>
<pre><code>&lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;</code></pre>
<p>说明这个就是获取我们添加的自定义字段的获取代码了，我们只需要在我们想要调用的模板文件的某个位置调用就行了，比如我们在dashbord.phtml里面添加代码：</p>
<pre><code>&lt;p&gt;您的邀请码为：&lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;&lt;/p&gt;</code></pre>
<p>这个就可以显示在用户的控制台那里了。其他的页面调用方法一样的。</p>
<h2 id="对新注册用户发送一条优惠券到个人中心"><a href="#对新注册用户发送一条优惠券到个人中心" class="headerlink" title="对新注册用户发送一条优惠券到个人中心"></a>对新注册用户发送一条优惠券到个人中心</h2><p>为了让优惠券鼓励新用户注册，或者是只发送一次优惠券，那么这个做法是可取的，我们看下如何实现：</p>
<p>找到文件目录：app/code/core/Mage/Customer/controllers/AccountController.php，打开该文件，找到</p>
<pre><code>createPostAction()</code></pre>
<p>方法，在这个方法里面找到</p>
<pre><code>$customer-&gt;save();</code></pre>
<p>在这个代码下面增加</p>
<pre><code>$this-&gt;_getSession()-&gt;setIsNewUser(true);</code></pre>
<p>然后来到模板文件目录，在/app/design/frontend/base/default/template/customer/account/dashboard.phtml适当位置增加如下代码，这里可能不一定是这个目录，如果有的主题重写了这个base，那么就在自己的主题模板下面找到这个进行修改，</p>
<pre><code>&lt;?php
if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
echo &quot;Coupon is:xxxxxx&quot;;
&#125;
?&gt;</code></pre>
<p>那么这样就可以做到新注册用户就可以在个人中心页面看到一个优惠券了。</p>
<h2 id="邀请码在网站后台设置，用户填写的邀请码只要在后台设置的邀请码列表中的将会获得一条优惠券"><a href="#邀请码在网站后台设置，用户填写的邀请码只要在后台设置的邀请码列表中的将会获得一条优惠券" class="headerlink" title="邀请码在网站后台设置，用户填写的邀请码只要在后台设置的邀请码列表中的将会获得一条优惠券"></a>邀请码在网站后台设置，用户填写的邀请码只要在后台设置的邀请码列表中的将会获得一条优惠券</h2><p>这个我们需要现在后台新建一个静态的CMS块，然后在dashbord.phtml（笔者以这个页面作为演示）或者其他想要调用的页面调用这个新建的CMS块，</p>
<blockquote>
<p>Block Title *   license code</p>
<p>Identifier *     license-code</p>
</blockquote>
<pre><code>&lt;div class=&quot;license_number_list&quot;&gt;
  &lt;?php
      if ($this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;license-code&#39;)-&gt;toHtml()) &#123;
          echo $this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;license-code&#39;)-&gt;toHtml();
      &#125;
  ?&gt;
&lt;/div&gt;</code></pre>
<p>在magento后台新建的邀请码列表的html代码结构如下：</p>
<pre><code>&lt;ul&gt;
&lt;li&gt;789&lt;/li&gt;
&lt;li&gt;788&lt;/li&gt;
&lt;li&gt;786&lt;/li&gt;
&lt;li&gt;787&lt;/li&gt;
&lt;li&gt;785&lt;/li&gt;
&lt;li&gt;784&lt;/li&gt;
&lt;li&gt;110&lt;/li&gt;
&lt;/ul&gt;</code></pre>
<p>好的，我们需要对这个进行遍历，然后逐个跟用户的邀请码进行比对，如果有合适的就显示出来。完整的代码如下：</p>
<pre><code>&lt;script&gt;
    jQuery(document).ready(function() &#123;
        var all_license = jQuery(&quot;.license_number_list li&quot;);
        var lists = new Array();
        for (var i = 0; i &lt; all_license.length; i++) &#123;
            console.log(all_license[i]);
            lists.push(jQuery(all_license[i]).text());
            if (lists[i] == &lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;) &#123;
                jQuery(&quot;.license_number_list&quot;).append(&quot;&lt;p&gt;你是邀请用户，赠送你一张优惠券，券码：16868681688&lt;/p&gt;&quot;);
                break;
            &#125;
        &#125;
        // console.log(lists);
    &#125;);
&lt;/script&gt;</code></pre>
<p>这样确实很方便地进行在magento进行设置，当然如果不是经常更改的话，也可以通过if语句或者switch来实现，代码如下：</p>
<pre><code>&lt;?php 
        if ($this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) == 123123) &#123;
            if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
                echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
            &#125;
        &#125;else&#123;
            if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
                echo &quot;你是非邀请用户，赠送你一张优惠券，券码：1314521&quot;;
            &#125;
        &#125;
?&gt;</code></pre>
<p>如果用switch来实现的话，</p>
<pre><code>&lt;?php
    switch ($this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()))
    &#123;
    case 123122:
        if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
            echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        &#125;
        break;
    case 123123:
        if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
            echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        &#125;
        break;
    case 123125:
        if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
            echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        &#125;
        break;
    default:
        if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
            echo &quot;你是非邀请用户，赠送你一张优惠券，券码：1314521&quot;;
        &#125;
    &#125;
?&gt;</code></pre>
<p>当然，最符合生产环境的，个人觉得还是用js的方式实现的那种。最后笔者的dashbord.phtml里面的代码如下：</p>
<pre><code>&lt;div class=&quot;dashboard&quot;&gt;
    &lt;div class=&quot;page-title&quot;&gt;
        &lt;h1&gt;&lt;?php echo $this-&gt;__(&#39;My Dashboard&#39;) ?&gt;&lt;/h1&gt;
    &lt;/div&gt;
    &lt;?php echo $this-&gt;getMessagesBlock()-&gt;toHtml() ?&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;hello&#39;) ?&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;top&#39;) ?&gt;

    &lt;div class=&quot;license_number_list&quot;&gt;
        &lt;?php
            if ($this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;license-code&#39;)-&gt;toHtml()) &#123;
                echo $this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;license-code&#39;)-&gt;toHtml();
            &#125;
        ?&gt;
     &lt;/div&gt;
    &lt;p&gt;您的邀请码为：&lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;&lt;/p&gt;
    &lt;script&gt;
    jQuery(document).ready(function() &#123;
        var all_license = jQuery(&quot;.license_number_list li&quot;);
        var lists = new Array();
        for (var i = 0; i &lt; all_license.length; i++) &#123;
            console.log(all_license[i]);
            lists.push(jQuery(all_license[i]).text());
            if (lists[i] == &lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) ?&gt;) &#123;
                jQuery(&quot;.license_number_list&quot;).append(&quot;&lt;p&gt;你是邀请用户，赠送你一张优惠券，券码：16868681688&lt;/p&gt;&quot;);
                break;
            &#125;
        &#125;
        // console.log(lists);
    &#125;);
    &lt;/script&gt;
    &lt;?php 

        // if ($this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()) == 123123) &#123;
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        //     &#125;
        // &#125;else&#123;
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是非邀请用户，赠送你一张优惠券，券码：1314521&quot;;
        //     &#125;
        // &#125;

        // switch ($this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber()))
        // &#123;
        // case 123122:
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        //     &#125;
        //     break;
        // case 123123:
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        //     &#125;
        //     break;
        // case 123125:
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是邀请用户，赠送你一张优惠券，券码：16868681688&quot;;
        //     &#125;
        //     break;
        // default:
        //     if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
        //         echo &quot;你是非邀请用户，赠送你一张优惠券，券码：1314521&quot;;
        //     &#125;
        // &#125;

     ?&gt;

    &lt;div class=&quot;box-account box-info&quot;&gt;
        &lt;div class=&quot;box-head&quot;&gt;
            &lt;h2&gt;&lt;?php echo $this-&gt;__(&#39;Account Information&#39;) ?&gt;&lt;/h2&gt;
        &lt;/div&gt;
        &lt;?php /* Extensions placeholder */ ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;customer.account.dashboard.extra&#39;) ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;info&#39;) ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;address&#39;) ?&gt;
    &lt;/div&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;info1&#39;) ?&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;info2&#39;) ?&gt;
&lt;/div&gt;</code></pre>
<p>好的，这样就可以根据用户注册的邀请码来自行判断是否发送优惠券了，符合邀请码的就会得到优惠券了。</p>
<hr>
<p>**更新：2019/1/31 20:56:14 **</p>
<p>笔者在处理一个客户需求的时候，安装了一个自定义用户属性的插件，然后新建了一个自定义属性：</p>
<p><img src="https://i.imgur.com/BbVaV5p.jpg"></p>
<p><img src="https://i.imgur.com/6MjQH5w.jpg"></p>
<p>看到这个自定义属性的名字没？笔者为这个自定义属性命名为：Invitation code</p>
<p>现在笔者想要获取这个自定义属性的值在页面显示出来，那么该怎么取呢？前面说的是笔者自己创建的，现在这个是通过插件安装的，那么取值的方式是怎么样的呢？请看如下：</p>
<pre><code>&lt;?php
    echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getInvitationCode())
?&gt;</code></pre>
<p>这个getInvitationCode()又是怎么冒出来的呢？在magento里面我们是没有的，这个都是我们自定义的，那么根据笔者的实践经验这个自定义的函数规则应该就是get加上自定义属性名字接起来，然后用驼峰式命名，接起来就行了。比如：</p>
<pre><code>echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getInvitationCode())    //获取自定义属性为Invitation code的值
echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getLicenseNumber())   //获取自定义属性为license number的值
...    </code></pre>
<p>这个很重要，特别是在自定义用户属性的时候，运用起来会很方便。</p>
<p>这个插件的下载地址：链接：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1W64g0nv-EfRYZSoeYPH9UA">https://pan.baidu.com/s/1W64g0nv-EfRYZSoeYPH9UA</a> 提取码：8a0y </p>
<p>相关的知识分享：</p>
<p>定制magento的后台配置相关的模块文件下载地址：<a target="_blank" rel="noopener" href="https://pan.baidu.com/s/1YFDJoXFE11PdC-olG2nW6w">https://pan.baidu.com/s/1YFDJoXFE11PdC-olG2nW6w</a> 提取码：66yz </p>
<p>相关效果图：</p>
<p><img src="https://i.imgur.com/QLC06nX.jpg"></p>
<p><img src="https://i.imgur.com/gBwTXqA.jpg"></p>
<p><img src="https://i.imgur.com/UVpnTOl.jpg"></p>
<p><img src="https://i.imgur.com/eEcDGWG.jpg"></p>
<p>magento用户中心的文件（dashboard.phtml）代码如下，大家可以参考下：</p>
<p>目录：/app/design/frontend/base/default/template/customer/account/dashboard.phtml</p>
<pre><code>&lt;?php
/**
 * Magento
 *
 * NOTICE OF LICENSE
 *
 * This source file is subject to the Academic Free License (AFL 3.0)
 * that is bundled with this package in the file LICENSE_AFL.txt.
 * It is also available through the world-wide-web at this URL:
 * http://opensource.org/licenses/afl-3.0.php
 * If you did not receive a copy of the license and are unable to
 * obtain it through the world-wide-web, please send an email
 * to license@magento.com so we can send you a copy immediately.
 *
 * DISCLAIMER
 *
 * Do not edit or add to this file if you wish to upgrade Magento to newer
 * versions in the future. If you wish to customize Magento for your
 * needs please refer to http://www.magento.com for more information.
 *
 * @category    design
 * @package     base_default
 * @copyright   Copyright (c) 2006-2016 X.commerce, Inc. and affiliates (http://www.magento.com)
 * @license     http://opensource.org/licenses/afl-3.0.php  Academic Free License (AFL 3.0)
 */
?&gt;
&lt;div class=&quot;dashboard&quot;&gt;
    &lt;div class=&quot;page-title&quot;&gt;
        &lt;h1&gt;&lt;?php echo $this-&gt;__(&#39;My Dashboard&#39;) ?&gt;&lt;/h1&gt;
    &lt;/div&gt;
    &lt;?php echo $this-&gt;getMessagesBlock()-&gt;toHtml() ?&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;hello&#39;) ?&gt;

    &lt;!-- 额外添加的代码 开始 --&gt;

    &lt;?php
        if (Mage::getSingleton(&#39;customer/session&#39;)-&gt;getIsNewUser())&#123;
            echo &quot;&lt;br /&gt;&lt;div class=&#39;welcome-msg&#39; id=&#39;youhuiquan&#39;&gt;&lt;p&gt;Your invitation code is：&quot;.$this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getInvitationCode()).&quot;&lt;/p&gt;&lt;/div&gt;&quot;;
        &#125;
    ?&gt;

    &lt;div class=&quot;license_number_list&quot;&gt;
        &lt;?php
            if ($this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;invitation_code&#39;)-&gt;toHtml()) &#123;
                echo $this-&gt;getLayout()-&gt;createBlock(&#39;cms/block&#39;)-&gt;setBlockId(&#39;invitation_code&#39;)-&gt;toHtml();
            &#125;
        ?&gt;
    &lt;/div&gt;

    &lt;?php 
        echo &quot;&lt;div class=&#39;youhq&#39;&gt;&lt;ul&gt;&quot;;
        echo &quot;&lt;li class=&#39;invitationcode_coupon&#39;&gt;&quot;.Mage::getStoreConfig(&#39;coupon_options/messages/invitationcode_register_user_coupon&#39;).&quot;&lt;/li&gt;&quot;;
        echo &quot;&lt;li class=&#39;default_coupon&#39;&gt;&quot;.Mage::getStoreConfig(&#39;coupon_options/messages/defaultregister_user_coupon&#39;).&quot;&lt;/li&gt;&quot;;
        echo &quot;&lt;/ul&gt;&lt;/div&gt;&quot;;
    ?&gt;
    &lt;style&gt;
        .license_number_list ul,.youhq&#123;display: none&#125;
    &lt;/style&gt;

    &lt;script&gt;
        jQuery(document).ready(function() &#123;
            var all_license = jQuery(&quot;.license_number_list li&quot;);
            var invitationcode_co = jQuery(&quot;.invitationcode_coupon&quot;).text();
            var default_co = jQuery(&quot;.invitationcode_coupon&quot;).text();
            var lists = new Array();
            for (var i = 0; i &lt; all_license.length; i++) &#123;
                lists.push(jQuery(all_license[i]).text());
                if (lists[i] == &lt;?php echo $this-&gt;htmlEscape($this-&gt;getCustomer()-&gt;getInvitationCode()) ?&gt;) &#123;
                    jQuery(&quot;.license_number_list&quot;).append(&quot;&lt;br&gt;&lt;p class=&#39;welcome-msg&#39;&gt;Your discount coupon is：&quot;+invitationcode_co+&quot;&lt;/p&gt;&quot;);
                &#125;
            &#125;
        &#125;);
    &lt;/script&gt;

    &lt;!-- 额外添加的代码 结束 --&gt;

    &lt;?php echo $this-&gt;getChildHtml(&#39;top&#39;) ?&gt;
    &lt;div class=&quot;box-account box-info&quot;&gt;
        &lt;div class=&quot;box-head&quot;&gt;
            &lt;h2&gt;&lt;?php echo $this-&gt;__(&#39;Account Information&#39;) ?&gt;&lt;/h2&gt;
        &lt;/div&gt;
        &lt;?php /* Extensions placeholder */ ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;customer.account.dashboard.extra&#39;) ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;info&#39;) ?&gt;
        &lt;?php echo $this-&gt;getChildHtml(&#39;address&#39;) ?&gt;
    &lt;/div&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;info1&#39;) ?&gt;
    &lt;?php echo $this-&gt;getChildHtml(&#39;info2&#39;) ?&gt;
&lt;/div&gt;</code></pre>
<p>如果在将来的自定义开发magento的后台的时候，这个示例文件相信能够帮助大家获得更多的启发。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/28/Magento1-x%E5%90%8E%E5%8F%B0%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E9%A1%B5%EF%BC%8C%E5%A2%9E%E5%8A%A0SKU%E3%80%81Qty%E3%80%81%E5%AE%A2%E6%88%B7%E9%82%AE%E7%AE%B1%EF%BC%8C%E5%85%AC%E5%8F%B8%E5%9C%B0%E5%9D%80%E7%AD%89%E5%AD%97%E6%AE%B5/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/28/Magento1-x%E5%90%8E%E5%8F%B0%E8%AE%A2%E5%8D%95%E5%88%97%E8%A1%A8%E9%A1%B5%EF%BC%8C%E5%A2%9E%E5%8A%A0SKU%E3%80%81Qty%E3%80%81%E5%AE%A2%E6%88%B7%E9%82%AE%E7%AE%B1%EF%BC%8C%E5%85%AC%E5%8F%B8%E5%9C%B0%E5%9D%80%E7%AD%89%E5%AD%97%E6%AE%B5/" class="post-title-link" itemprop="url">Magento1.x后台订单列表页，增加SKU、Qty、客户邮箱公司地址字段</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-28 16:51:24" itemprop="dateCreated datePublished" datetime="2018-11-28T16:51:24+08:00">2018-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:57:58" itemprop="dateModified" datetime="2020-10-11T11:57:58+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento1/" itemprop="url" rel="index"><span itemprop="name">magento1</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在做的一个Magento网站，客户要求在后台订单列表里增加一列，用来显示用户的公司名称，在Magento1.9.2上测试通过，代码步骤如下：</p>
<p>1、打开app/code/core/Mage/Adminhtml/Block/Sales/Order/Grid.php</p>
<p>2.将如下函数</p>
<pre><code>protected function _prepareCollection()
&#123;
    $collection = Mage::getResourceModel($this-&gt;_getCollectionClass());
    $this-&gt;setCollection($collection);
    return parent::_prepareCollection();
&#125;</code></pre>
<p>替换为</p>
<pre><code>protected function _prepareCollection()
    &#123;
        $collection = Mage::getResourceModel($this-&gt;_getCollectionClass());
        $collection-&gt;getSelect()-&gt;join(&#39;sales_flat_order_address&#39;, &#39;main_table.entity_id = sales_flat_order_address.parent_id&#39;,array(&#39;company&#39;));
        $collection-&gt;getSelect()-&gt;group(&#39;main_table.entity_id&#39;);  //注意这句不可少
        $this-&gt;setCollection($collection);
        return parent::_prepareCollection();
    &#125;</code></pre>
<p>3.搜索函数：<code>protected function _prepareColumns()</code></p>
<p>该函数是用来显示列表名称的，在适当的位置增加如下代码：</p>
<pre><code>$this-&gt;addColumn(&#39;billing_name&#39;, array(
    //&#39;header&#39; =&gt; Mage::helper(&#39;sales&#39;)-&gt;__(&#39;Bill to Name&#39;),
    &#39;header&#39; =&gt; Mage::helper(&#39;sales&#39;)-&gt;__(&#39;Company Name&#39;),
    &#39;index&#39; =&gt; &#39;billing_name&#39;,
));</code></pre>
<p>保存，然后刷新网站后台，我们就可以看到：</p>
<p><img src="https://i.imgur.com/OHmD4Lo.jpg"></p>
<hr>
<p>又比如：</p>
<blockquote>
<p>注意：这里修改之后分页和总记录数被破坏，还需要进一步优化（如果查询客户邮箱就不会出现这样的问题，目前还没找到解决方案）</p>
</blockquote>
<p>修改前：</p>
<p><img src="https://i.imgur.com/m9L2qaJ.png"></p>
<p>修改后：</p>
<p><img src="https://i.imgur.com/JXgNMqi.png"></p>
<p>打开</p>
<p>app/code/core/Mage/Adminhtml/Block/Sales/Order/Grid.php</p>
<p>找到 <code>protected function _prepareCollection()</code>方法，大约57行</p>
<p>添加关联查询：</p>
<pre><code>$collection-&gt;getSelect()
-&gt;join(&#39;customer_entity&#39;,&#39;main_table.customer_id = customer_entity.entity_id&#39;, 
        array(&#39;customer_email&#39; =&gt; &#39;email&#39;)) //客户email
-&gt;join(&#39;sales_flat_order_item&#39;,&#39;main_table.entity_id = sales_flat_order_item.order_id&#39;,
        array(&#39;qty_ordered&#39; =&gt; new Zend_Db_Expr(&#39;group_concat( `sales_flat_order_item`.qty_ordered SEPARATOR &quot;, &quot;)&#39;),//Qty
               &#39;sku&#39;  =&gt; new Zend_Db_Expr(&#39;group_concat(`sales_flat_order_item`.sku SEPARATOR &quot;, &quot;)&#39;//SKU
               )
         ));</code></pre>
<p>最后的该方法如下： </p>
<pre><code>protected function _prepareCollection()
&#123;
    $collection = Mage::getResourceModel($this-&gt;_getCollectionClass());

    $collection-&gt;getSelect()
    -&gt;join(&#39;customer_entity&#39;,&#39;main_table.customer_id = customer_entity.entity_id&#39;, 
            array(&#39;customer_email&#39; =&gt; &#39;email&#39;)) //客户email
    -&gt;join(&#39;sales_flat_order_item&#39;,&#39;main_table.entity_id = sales_flat_order_item.order_id&#39;,
            array(&#39;qty_ordered&#39; =&gt; new Zend_Db_Expr(&#39;group_concat( `sales_flat_order_item`.qty_ordered SEPARATOR &quot;, &quot;)&#39;),//Qty
                   &#39;sku&#39;  =&gt; new Zend_Db_Expr(&#39;group_concat(`sales_flat_order_item`.sku SEPARATOR &quot;, &quot;)&#39;//SKU
                   )
             ));

    //分组
    $collection-&gt;getSelect()-&gt;group(&#39;main_table.entity_id&#39;);//注意这句不可少

    $this-&gt;setCollection($collection);
    return parent::_prepareCollection();
&#125;</code></pre>
<p>接下来，</p>
<p>找到 <code>protected function _prepareColumns()</code>方法，大约84行</p>
<p>添加代码如下：</p>
<pre><code>$this-&gt;addColumn(&#39;sku&#39;, array(
    &#39;header&#39;    =&gt; Mage::helper(&#39;catalog&#39;)-&gt;__(&#39;SKU&#39;),
    &#39;index&#39;     =&gt; &#39;sku&#39;,
    &#39;width&#39; =&gt; &#39;150px&#39;,
    &#39;type&#39; =&gt; &#39;text&#39;
));
$this-&gt;addColumn(&#39;qty&#39;, array(
    &#39;header&#39; =&gt; Mage::helper(&#39;sales&#39;)-&gt;__(&#39;Qty&#39;),
    &#39;index&#39; =&gt; &#39;qty_ordered&#39;,
    &#39;width&#39; =&gt; &#39;70px&#39;
));
$this-&gt;addColumn(&#39;Email&#39;, array(
    &#39;header&#39; =&gt; Mage::helper(&#39;Sales&#39;)-&gt;__(&#39;Email&#39;),
    &#39;width&#39; =&gt; &#39;100px&#39;,
    &#39;index&#39; =&gt; &#39;customer_email&#39;,
    &#39;type&#39; =&gt; &#39;text&#39;
));</code></pre>
<p>其他：如果报“1052 Column increment_id in where clause is ambiguous”错误。注意修改以下代码： </p>
<pre><code>$this-&gt;addColumn(&#39;real_order_id&#39;, array(
    &#39;header&#39;=&gt; Mage::helper(&#39;sales&#39;)-&gt;__(&#39;Order #&#39;),
    &#39;width&#39; =&gt; &#39;80px&#39;,
    &#39;type&#39;  =&gt; &#39;text&#39;,
    &#39;index&#39; =&gt; &#39;increment_id&#39;,
    &#39;filter_index&#39; =&gt;&#39;main_table.increment_id&#39;//// 这个参数将会解决上述问题  
));</code></pre>
<p>刷新一下后台就可以看到效果了，如果没有及时看到效果，需要Compilation一下。</p>
<p><img src="https://i.imgur.com/JXgNMqi.png"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/28/magento1-x%E7%9A%84porto%E4%B8%BB%E9%A2%98%E8%B0%83%E7%94%A8%E6%9F%90%E4%B8%AA%E5%88%86%E7%B1%BB%E4%B8%8B%E7%9A%84%E4%BA%A7%E5%93%81%E7%9A%84%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/28/magento1-x%E7%9A%84porto%E4%B8%BB%E9%A2%98%E8%B0%83%E7%94%A8%E6%9F%90%E4%B8%AA%E5%88%86%E7%B1%BB%E4%B8%8B%E7%9A%84%E4%BA%A7%E5%93%81%E7%9A%84%E5%BF%AB%E6%8D%B7%E6%96%B9%E5%BC%8F/" class="post-title-link" itemprop="url">magento1.x的porto主题调用某个分类下的产品的快捷方式，以及新型的布局片段</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-28 11:21:58" itemprop="dateCreated datePublished" datetime="2018-11-28T11:21:58+08:00">2018-11-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:57:59" itemprop="dateModified" datetime="2020-10-11T11:57:59+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento1/" itemprop="url" rel="index"><span itemprop="name">magento1</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>本篇文章仅仅是用作笔记，方便自己查找：</p>
<pre><code>&lt;div class=&quot;row&quot;&gt;
    &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;Personal ESD&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
    &lt;div id=&quot;perteg&quot; class=&quot;owl-top-narrow&quot;&gt;
        &#123;&#123;block type="filterproducts/latest_home_list" name="featured_list" category_id="10" product_count="10" column_count="5" template="filterproducts/flex_grid.phtml"&#125;&#125;
    &lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#perteg .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 3], [1200, 4] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
    &lt;/script&gt;
&lt;/div&gt;</code></pre>
<p>这里说明一下：</p>
<p>这里是调用分类为Personal ESD，它对应的ID是10，五列显示，总共显示10个产品，采用flex_grid.phtml这个模板文件。</p>
<p>type – 这是模块类的标识符，它定义了区块的功能。此属性不应该被修改。</p>
<p>name – 这是名称，其他的区块可以通过此名称引用此区块。</p>
<p>最后的效果：</p>
<p><img src="https://i.imgur.com/ue8kwkx.jpg"></p>
<p><img src="https://i.imgur.com/DJrrh91.jpg"></p>
<p>这个是两个不同的分类，根据分类名进行分类显示出来。</p>
<p>最后，笔者为了方便后期调用，这里把代码片段保存了一份：</p>
<pre><code>&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-sm-6&quot;&gt;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;BestSellers&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div id=&quot;bestsellers_product&quot; class=&quot;owl-top-narrow move-action hide-addtolinks&quot;&gt;
            &#123;&#123;block type="filterproducts/bestsellers_home_list" name="bestsellers_list" product_count="10" template="filterproducts/list.phtml"&#125;&#125;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#bestsellers_product .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 2], [1280, 3] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
        &lt;/script&gt;
    &lt;/div&gt;
    &lt;div class=&quot;col-sm-6&quot;&gt;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;New&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div id=&quot;new_product&quot; class=&quot;owl-top-narrow move-action hide-addtolinks&quot;&gt;
            &#123;&#123;block type="filterproducts/newproduct_home_list" name="new_list" product_count="10" template="filterproducts/list.phtml"&#125;&#125;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#new_product .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 2], [1280, 3] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
        &lt;/script&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-sm-6&quot;&gt;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;Personal ESD&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div id=&quot;bestsellers_product&quot; class=&quot;owl-top-narrow move-action hide-addtolinks&quot;&gt;
            &#123;&#123;block type="filterproducts/bestsellers_home_list" name="bestsellers_list" product_count="10" category_id="3" template="filterproducts/list.phtml"&#125;&#125;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#bestsellers_product .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 2], [1280, 3] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
        &lt;/script&gt;
    &lt;/div&gt;
    &lt;div class=&quot;col-sm-6&quot;&gt;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;ESD Protection Area&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div id=&quot;new_product&quot; class=&quot;owl-top-narrow move-action hide-addtolinks&quot;&gt;
            &#123;&#123;block type="filterproducts/newproduct_home_list" name="new_list" product_count="10" category_id="78" template="filterproducts/list.phtml"&#125;&#125;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#new_product .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 2], [1280, 3] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
        &lt;/script&gt;
    &lt;/div&gt;
&lt;/div&gt;

&lt;div class=&quot;row&quot;&gt;
    &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;Personal ESD&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
    &lt;div id=&quot;perteg&quot; class=&quot;owl-top-narrow&quot;&gt;
        &#123;&#123;block type="filterproducts/latest_home_list" name="featured_list" category_id="10" product_count="10" column_count="5" template="filterproducts/flex_grid.phtml"&#125;&#125;
    &lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#perteg .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 3], [1200, 4] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
    &lt;/script&gt;
&lt;/div&gt;

&lt;div class=&quot;row&quot;&gt;
    &lt;h2 class=&quot;filter-title&quot; style=&quot;margin-top:30px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;ESD Protection Area&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
    &lt;div id=&quot;perteg&quot; class=&quot;owl-top-narrow&quot;&gt;
        &#123;&#123;block type="filterproducts/latest_home_list" name="featured_list" category_id="78" product_count="10" column_count="5" template="filterproducts/flex_grid.phtml"&#125;&#125;
    &lt;/div&gt;

    &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#perteg .filter-products .owl-carousel&quot;).owlCarousel(&#123;lazyLoad: true,    itemsCustom: [ [0, 1], [320, 1], [480, 2], [768, 3], [992, 3], [1200, 4] ],    responsiveRefreshRate: 50,    slideSpeed: 200,    paginationSpeed: 500,    scrollPerPage: false,    stopOnHover: true,    rewindNav: true,    rewindSpeed: 600,    pagination: false,    navigation: true,    autoPlay: true,    navigationText:[&quot;&lt;i class=&#39;icon-left-open&#39;&gt;&lt;/i&gt;&quot;,&quot;&lt;i class=&#39;icon-right-open&#39;&gt;&lt;/i&gt;&quot;]&#125;);
        &#125;);
    &lt;/script&gt;
&lt;/div&gt;</code></pre>
<p>布局效果如下：</p>
<p><img src="https://i.imgur.com/L5blevu.jpg"></p>
<p><img src="https://i.imgur.com/LBZDXcl.jpg"></p>
<p><img src="https://i.imgur.com/ue8kwkx.jpg"></p>
<p><img src="https://i.imgur.com/DJrrh91.jpg"></p>
<hr>
<p>这里笔者再分享点很妙的布局，代码片段如下：</p>
<pre><code>&lt;div class=&quot;row&quot;&gt;
    &lt;div class=&quot;col-md-9 col-sm-8 small-padding&quot;&gt;
        &lt;div class=&quot;filterproducts-tab&quot; style=&quot;padding-top: 25px;&quot;&gt;
            &lt;div class=&quot;filter-title&quot;&gt;
                &lt;ul class=&quot;content&quot;&gt;
                    &lt;li id=&quot;tab_featured&quot; class=&quot;active first&quot;&gt;&lt;a href=&quot;#&quot;&gt;&lt;strong&gt;FEATURED&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
                    &lt;li id=&quot;tab_new&quot; class=&quot;last&quot;&gt;&lt;a href=&quot;#&quot;&gt;&lt;strong&gt;NEW PRODUCTS&lt;/strong&gt;&lt;/a&gt;&lt;/li&gt;
                &lt;/ul&gt;
            &lt;/div&gt;
            &lt;div class=&quot;clearer&quot;&gt;&lt;/div&gt;
            &lt;div class=&quot;tab-content&quot; id=&quot;tab_featured_contents&quot;&gt;
                &lt;div id=&quot;featured_product&quot; class=&quot;hide-addtolinks move-action&quot;&gt;
                    &#123;&#123;block type="filterproducts/featured_home_list" name="featured_list" product_count="12" column_count="4" template="filterproducts/grid.phtml"&#125;&#125;
                &lt;/div&gt;
            &lt;/div&gt;
            &lt;div class=&quot;tab-content&quot; id=&quot;tab_new_contents&quot;&gt;
                &lt;div id=&quot;new_product&quot; class=&quot;hide-addtolinks move-action&quot;&gt;
                    &#123;&#123;block type="filterproducts/newproduct_home_list" name="newproduct_list" product_count="12" column_count="4" template="filterproducts/grid.phtml"&#125;&#125;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;new Varien.Tabs(&#39;.filterproducts-tab &gt; div.filter-title &gt; ul&#39;);&lt;/script&gt;
        &lt;div class=&quot;homepage-grid-banner&quot; style=&quot;padding: 20px 0 30px;&quot;&gt;
            &lt;div class=&quot;row&quot;&gt;
                &lt;div class=&quot;col-sm-4&quot;&gt;
                    &lt;div class=&quot;grid3 col-sm-margin&quot; style=&quot;position:relative;&quot;&gt;
                        &lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/02/grid2.jpg"&#125;&#125;&quot; alt=&quot;&quot; /&gt;
                        &lt;div class=&quot;content&quot; style=&quot;position:absolute;right:12%;top:15%;text-align:right;&quot;&gt;
                            &lt;p style=&quot;font-weight:300;color:#313131;&quot;&gt;MOBILE&lt;/p&gt;
                            &lt;p style=&quot;font-weight:700;color:#313131;&quot;&gt;MEGA SALE&lt;/p&gt;
                            &lt;h4 style=&quot;font-weight:400;color:#444;&quot;&gt;&lt;span&gt;$&lt;/span&gt;450.&lt;span&gt;00&lt;/span&gt;&lt;/h4&gt;
                            &lt;h3 style=&quot;font-weight:400;color:#08c;&quot;&gt;&lt;span&gt;$&lt;/span&gt;350.&lt;span&gt;00&lt;/span&gt;&lt;/h3&gt;
                            &lt;a href=&quot;http://newsmartwave.net/magento/porto/index.php/electronics/cameras/cell-phones-accessories.html&quot;&gt;Shop now &amp;gt;&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;grid4&quot; style=&quot;position:relative;&quot;&gt;
                        &lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/02/grid3.jpg"&#125;&#125;&quot; alt=&quot;&quot; /&gt;
                        &lt;div class=&quot;content&quot; style=&quot;position:absolute;right:10%;top:30%;text-align:right;width:88%;&quot;&gt;
                            &lt;h2 style=&quot;font-weight:600;color:#fff;&quot;&gt;HUGE &lt;b style=&quot;font-weight:800;&quot;&gt;SALE&lt;/b&gt;&lt;/h2&gt;
                            &lt;p style=&quot;font-weight:300;color:#fff;opacity:0.7;filter:alpha(opacity=70);&quot;&gt;Now starting at &lt;b style=&quot;font-weight:600;&quot;&gt;$99&lt;/b&gt;&lt;/p&gt;
                            &lt;a href=&quot;http://newsmartwave.net/magento/porto/index.php/fashion/women.html&quot;&gt;Shop now &amp;gt;&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
                &lt;div class=&quot;col-sm-8&quot;&gt;
                    &lt;div class=&quot;grid1&quot; style=&quot;position:relative;&quot;&gt;
                        &lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/02/grid1.jpg"&#125;&#125;&quot; alt=&quot;&quot; /&gt;
                        &lt;div class=&quot;ribbon&quot; style=&quot;position:absolute;right:0;top:0;border-color:#08c;color:#fff;&quot;&gt;
                            &lt;div style=&quot;position:absolute;right:9%;top:10%;width:90%;text-align:right;&quot;&gt;
                                &lt;em style=&quot;font-weight:300;font-style:normal;color:#fff;margin-right:26%;&quot;&gt;UP TO&lt;/em&gt;
                                &lt;h4 style=&quot;font-weight:700;color:#fff;&quot;&gt;70%&lt;/h4&gt;
                                &lt;h5 style=&quot;font-weight:600;color:#fff;&quot;&gt;OFF&lt;/h5&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                        &lt;div class=&quot;content&quot; style=&quot;position:absolute;left:7.5%;top:14%;text-align:left;&quot;&gt;
                            &lt;h2 style=&quot;font-weight:600;color:#08c;&quot;&gt;HUGE &lt;b style=&quot;font-weight:800;&quot;&gt;SALE&lt;/b&gt;&lt;/h2&gt;
                            &lt;p style=&quot;font-weight:300;color:#525252;&quot;&gt;Now starting at &lt;b style=&quot;font-weight:600;&quot;&gt;$99&lt;/b&gt;&lt;/p&gt;
                            &lt;a href=&quot;http://newsmartwave.net/magento/porto/index.php/fashion/jewellery.html&quot;&gt;Shop now &amp;gt;&lt;/a&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;h2 class=&quot;filter-title&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;Our Brands&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div class=&quot;owl-no-narrow&quot;&gt;
            &lt;div id=&quot;brands-slider-demo-2&quot; class=&quot;owl-carousel owl-theme&quot;&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand1.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand2.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand3.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand4.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand5.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand1.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand2.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand3.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand4.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
                &lt;div class=&quot;item&quot; style=&quot;padding-top:20px;&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/slider/02/brand5.png"&#125;&#125;&quot; alt=&quot;&quot; /&gt;&lt;/div&gt;
            &lt;/div&gt;
            &lt;script type=&quot;text/javascript&quot;&gt;
            jQuery(function($)&#123;
                $(&quot;#brands-slider-demo-2&quot;).owlCarousel(&#123;
                    lazyLoad: true,
                    itemsCustom: [ [0, 1], [320, 1], [480, 2], [640, 3], [768, 3], [992, 4], [1200, 5] ],
                    responsiveRefreshRate: 50,
                    slideSpeed: 200,
                    paginationSpeed: 500,
                    scrollPerPage: false,
                    stopOnHover: true,
                    rewindNav: true,
                    rewindSpeed: 600,
                    pagination: true,
                    navigation: false,
                    autoPlay: true
                &#125;);
            &#125;);
            &lt;/script&gt;
        &lt;/div&gt;
    &lt;/div&gt;
    &lt;div class=&quot;col-md-3 col-sm-4 sidebar&quot;&gt;
        &lt;div class=&quot;custom-block custom-block-1&quot; style=&quot;padding-top:35px;&quot;&gt;
            &lt;div&gt;
                &lt;i class=&quot;icon-truck&quot; style=&quot;font-size:36px;margin-left:-5px;&quot;&gt;&lt;/i&gt;&lt;h3&gt;FREE SHIPPING&lt;/h3&gt;&lt;p&gt;Free shipping on all orders over $99.&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;i class=&quot;icon-dollar&quot;&gt;&lt;/i&gt;&lt;h3&gt;MONEY BACK GUARANTEE&lt;/h3&gt;&lt;p&gt;100% money back guarantee.&lt;/p&gt;
            &lt;/div&gt;
            &lt;div&gt;
                &lt;i class=&quot;icon-lifebuoy&quot; style=&quot;font-size:32px;&quot;&gt;&lt;/i&gt;&lt;h3&gt;ONLINE SUPPORT 24/7&lt;/h3&gt;&lt;p&gt;Lorem ipsum dolor sit amet.&lt;/p&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;div class=&quot;custom-block&quot;&gt;
                &lt;div id=&quot;custom-owl-slider-product&quot; class=&quot;owl-carousel owl-theme&quot;&gt;
                        &lt;div class=&quot;item&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/01/ad1.png"&#125;&#125;&quot; alt=&quot;&quot; style=&quot;width: 270px;&quot; /&gt;&lt;/div&gt;
                        &lt;div class=&quot;item&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/01/ad2.png"&#125;&#125;&quot; alt=&quot;&quot; style=&quot;width: 270px;&quot; /&gt;&lt;/div&gt;
                        &lt;div class=&quot;item&quot;&gt;&lt;img src=&quot;&#123;&#123;media url="wysiwyg/porto/homepage/content/01/ad1.png"&#125;&#125;&quot; alt=&quot;&quot; style=&quot;width: 270px;&quot; /&gt;&lt;/div&gt;
                &lt;/div&gt;
                &lt;script type=&quot;text/javascript&quot;&gt;
                    jQuery(function($)&#123;
                        $(&quot;#custom-owl-slider-product&quot;).owlCarousel(&#123;
                            lazyLoad: true,
                                slideSpeed : 300,
                    paginationSpeed : 400,
                    singleItem:true,
                    responsiveRefreshRate: 50,
                    slideSpeed: 200,
                    paginationSpeed: 500,
                    stopOnHover: true,
                    rewindNav: true,
                    rewindSpeed: 600,
                    navigation: false
                &#125;);
            &#125;);
            &lt;/script&gt;
        &lt;/div&gt;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;background-image:none;margin-top:20px;margin-bottom:5px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;BEST SELLERS&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &#123;&#123;block type="filterproducts/bestsellers_home_list" name="bestsellers_list" product_count="3" template="filterproducts/small_list.phtml"&#125;&#125;
        &lt;h2 class=&quot;filter-title&quot; style=&quot;background-image:none;margin-bottom:-15px;margin-top:20px;&quot;&gt;&lt;span class=&quot;content&quot;&gt;&lt;strong&gt;From the Blog&lt;/strong&gt;&lt;/span&gt;&lt;/h2&gt;
        &lt;div id=&quot;latest_news&quot; style=&quot;margin:0 -10px;&quot;&gt;
            &lt;div class=&quot;recent-posts&quot;&gt;
                &lt;div class=&quot;owl-carousel owl-theme&quot;&gt;
                    &lt;div class=&quot;item&quot;&gt;
                        &lt;div class=&quot;row&quot;&gt;
                            &lt;div class=&quot;col-sm-5&quot;&gt;
                                &lt;div class=&quot;post-image&quot;&gt;
                                    &lt;img src=&quot;&#123;&#123;media url="wysiwyg/smartwave/blog/01.jpg"&#125;&#125;&quot; alt=&quot;&quot;&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;col-sm-7&quot;&gt;
                                &lt;div class=&quot;post-date&quot;&gt;
                                    &lt;span class=&quot;day&quot;&gt;08&lt;/span&gt;
                                    &lt;span class=&quot;month&quot;&gt;Dec&lt;/span&gt;
                                &lt;/div&gt;
                                &lt;div class=&quot;postTitle&quot;&gt;
                                    &lt;h2&gt;&lt;a href=&quot;#&quot;&gt;Post Format – Video&lt;/a&gt;&lt;/h2&gt;
                                &lt;/div&gt;
                                &lt;div class=&quot;postContent&quot;&gt;&lt;p&gt;Lorem ipsum dolor sit amet, consectetur adipiscing elit. Cras non placerat mi…&lt;/p&gt;&lt;/div&gt;
                                &lt;a class=&quot;readmore&quot; href=&quot;#&quot;&gt;Read more &amp;gt;&lt;/a&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                    &lt;div class=&quot;item&quot;&gt;
                        &lt;div class=&quot;row&quot;&gt;
                            &lt;div class=&quot;col-sm-5&quot;&gt;
                                &lt;div class=&quot;post-image&quot;&gt;
                                &lt;img src=&quot;&#123;&#123;media url="wysiwyg/smartwave/blog/02.jpg"&#125;&#125;&quot; alt=&quot;&quot;&gt;
                                &lt;/div&gt;
                            &lt;/div&gt;
                            &lt;div class=&quot;col-sm-7&quot;&gt;
                                &lt;div class=&quot;post-date&quot;&gt;
                                    &lt;span class=&quot;day&quot;&gt;07&lt;/span&gt;
                                    &lt;span class=&quot;month&quot;&gt;Dec&lt;/span&gt;
                                &lt;/div&gt;
                                &lt;div class=&quot;postTitle&quot;&gt;
                                    &lt;h2&gt;&lt;a href=&quot;#&quot;&gt;Post Format – Image Gallery&lt;/a&gt;&lt;/h2&gt;
                                &lt;/div&gt;
                                &lt;div class=&quot;postContent&quot;&gt;&lt;p&gt;Euismod atras vulputate iltricies etri elit. Class aptent taciti sociosqu ad litora torquent…&lt;/p&gt;&lt;/div&gt;
                                &lt;a class=&quot;readmore&quot; href=&quot;#&quot;&gt;Read more &amp;gt;&lt;/a&gt;
                            &lt;/div&gt;
                        &lt;/div&gt;
                    &lt;/div&gt;
                &lt;/div&gt;
            &lt;/div&gt;
        &lt;/div&gt;
        &lt;style type=&quot;text/css&quot;&gt;.recent-posts .item .col-sm-5, .recent-posts .item .col-sm-7&#123;width:100%;&#125;&lt;/style&gt;
        &lt;script type=&quot;text/javascript&quot;&gt;
        jQuery(function($)&#123;
            $(&quot;#latest_news .owl-carousel&quot;).owlCarousel(&#123;
                lazyLoad: true,
                responsiveRefreshRate: 50,
                slideSpeed: 200,
                paginationSpeed: 500,
                scrollPerPage: true,
                stopOnHover: true,
                rewindNav: true,
                rewindSpeed: 600,
                pagination: true,
                navigation: false,
                autoPlay: true,
                singleItem: true
            &#125;);
        &#125;);
        &lt;/script&gt;
    &lt;/div&gt;
&lt;/div&gt;</code></pre>
<p>效果如下：</p>
<p><img src="https://i.imgur.com/huQ2OHv.jpg"></p>
<p><img src="https://i.imgur.com/UdvqgF2.jpg"></p>
<p><img src="https://i.imgur.com/8PCIn4k.jpg"></p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/27/ubuntu%E4%B8%8B%E5%AE%89%E8%A3%85Apache%EF%BC%8C%E4%BF%AE%E6%94%B9%E4%BA%86web%E7%9B%AE%E5%BD%95%E5%90%8E%EF%BC%8C%E6%8A%A5-You-don%E2%80%99t-have-permission-to-access-on-this-server%E9%94%99%E8%AF%AF/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/27/ubuntu%E4%B8%8B%E5%AE%89%E8%A3%85Apache%EF%BC%8C%E4%BF%AE%E6%94%B9%E4%BA%86web%E7%9B%AE%E5%BD%95%E5%90%8E%EF%BC%8C%E6%8A%A5-You-don%E2%80%99t-have-permission-to-access-on-this-server%E9%94%99%E8%AF%AF/" class="post-title-link" itemprop="url">ubuntu下安装Apache，修改了web目录后，报You don’t have permission to access / on this server错误</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-27 18:16:26" itemprop="dateCreated datePublished" datetime="2018-11-27T18:16:26+08:00">2018-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:02" itemprop="dateModified" datetime="2020-10-11T11:58:02+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/%E7%BC%96%E7%A8%8B%E5%9F%BA%E7%A1%80/" itemprop="url" rel="index"><span itemprop="name">编程基础</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>今天安装ubuntu到笔记本电脑，安装了apache然后启动服务，这个都是没问题的，可是笔者为了方便调试，就修改了一下apache的配置文件，找到apache在ubuntu的安装配置目录：</p>
<pre><code>etc/apache2/</code></pre>
<p>在这个目录下找到sites-enable/000-default.conf，然后把这个里面的：</p>
<pre><code>DocumentRoot /var/www/html/</code></pre>
<p>换成</p>
<pre><code>DocumentRoot /home/username/www/</code></pre>
<p>此处的www是笔者在个人目录下新建的，当把这个修改了之后，重启apache，再次在浏览器访问的时候，报错了：</p>
<blockquote>
<p>you don’t have permission to access / on this server</p>
</blockquote>
<p>这个问题笔者一想应该是一个权限的问题，然后就把自己创建的这个目录设置了一下权限，</p>
<pre><code>chmod -R 777 www</code></pre>
<p>可是没啥用，后来网上搜索了下，大家说是要修改apache配置文件，把</p>
<pre><code>&lt;Directory /&gt;
Options FollowSymLinks
AllowOverride None
Order deny,allow
Deny from all
&lt;/Directory&gt;</code></pre>
<p>改成：</p>
<pre><code>&lt;Directory /&gt;
Options FollowSymLinks
AllowOverride None
Order deny,allow
Allow from all
&lt;/Directory&gt;</code></pre>
<p>可是，并没有什么用，后来看了这样一篇文章获得了启发：<a target="_blank" rel="noopener" href="https://blog.csdn.net/qq_21956483/article/details/78732160">https://blog.csdn.net/qq_21956483/article/details/78732160</a></p>
<p>笔者把apache配置文件那里复制了一个片段，如下：</p>
<pre><code>&lt;Directory /var/www/&gt;
Options Indexes FollowSymLinks
AllowOverride None
Require all granted
&lt;/Directory&gt;</code></pre>
<p>把这个代码放在000-default.conf里，在DocumentRoot /home/username/www/后面添加，类似如下：</p>
<pre><code>...
DocumentRoot /home/username/www/

&lt;Directory &quot;/home/username/www/&quot;&gt;
Options Indexes FollowSymLinks
AllowOverride none
Require all granted
&lt;/Directory&gt;
...</code></pre>
<p>保存，然后重启一下apache，搞定！如果还是不行，可以考虑把防火墙关闭：</p>
<p>运行如下两个命令</p>
<pre><code>setenforce 0                  # 暂时禁用SELinux服务
service iptables stop        # 暂时禁用防火墙</code></pre>
<p>访问页面，看问题是否解决；总之，笔者在这个折腾了一整子，大家多搜索一下，看下哪些是符合自己问题的解决方案。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="https://helongquan.github.io/2018/11/27/ubuntu%E6%A1%8C%E9%9D%A2%E7%89%88%E7%8B%AC%E7%AB%8B%E5%AE%89%E8%A3%85php-apache-mysql%E7%AD%89%EF%BC%8C%E4%B8%BAmagento2%E6%90%AD%E5%BB%BA%E6%89%80%E9%9C%80%E7%9A%84%E7%8E%AF%E5%A2%83%E7%A2%B0%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="泉哥">
      <meta itemprop="description" content="日记">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="鸢尾花序">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2018/11/27/ubuntu%E6%A1%8C%E9%9D%A2%E7%89%88%E7%8B%AC%E7%AB%8B%E5%AE%89%E8%A3%85php-apache-mysql%E7%AD%89%EF%BC%8C%E4%B8%BAmagento2%E6%90%AD%E5%BB%BA%E6%89%80%E9%9C%80%E7%9A%84%E7%8E%AF%E5%A2%83%E7%A2%B0%E5%88%B0%E7%9A%84%E9%97%AE%E9%A2%98%E4%BB%A5%E5%8F%8A%E7%9B%B8%E5%85%B3%E7%9A%84%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88/" class="post-title-link" itemprop="url">ubuntu桌面版独立安装php,apache,mysql等，为magento2搭建所需的环境碰到的问题以及相关的解决方案</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2018-11-27 16:48:08" itemprop="dateCreated datePublished" datetime="2018-11-27T16:48:08+08:00">2018-11-27</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:58:02" itemprop="dateModified" datetime="2020-10-11T11:58:02+08:00">2020-10-11</time>
              </span>
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-folder"></i>
              </span>
              <span class="post-meta-item-text">In</span>
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/magento2/" itemprop="url" rel="index"><span itemprop="name">magento2</span></a>
                </span>
            </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>这里记录一下在ubuntu操作系统上逐个安装web环境，而不是采用集成安装包的形式（xampp,wamp），这样会更加灵活的配置php、mysql、apache、nginx的版本，我们开始吧。</p>
<p>环境：ubuntu16.04桌面版</p>
<p>其实这个过程网上已经很多教程了，笔者这里精简一下：</p>
<p><strong>Apache安装</strong></p>
<p>首先安装apache服务器，ubuntu下面使用apt-get来下载安装软件</p>
<pre><code>sudo apt-get install apache2</code></pre>
<p>安装成功后，在浏览器输入localhost查看是否安装成功。有关于apache简介的就是成功了。</p>
<p><strong>PHP安装</strong></p>
<p>由于笔者是要在ubuntu上调试magento2，因此这里我准备安装PHP7.0版本的，在命令行输入:</p>
<pre><code>sudo apt-get install php7.0</code></pre>
<p>安装完成后输入：<code>php -v</code> 查看PHP是否安装成功。</p>
<p>PHP和Apache都安装好后就需要让Apache能够识别解析PHP文件，我们先搜一下有没有适合PHP7的插件，输入命令：</p>
<pre><code>sudo apt-cache search libapache2-mod-php</code></pre>
<p><img src="https://i.imgur.com/XouA5Q3.png"></p>
<p>可以看到搜出来的结果里面有一个是PHP7.0版本的，我们就安装这个：</p>
<pre><code>sudo apt-get install libapache2-mod-php7.0</code></pre>
<p>下面我们就可以随便写一个php文件看是否可以解析访问。输入命令:</p>
<pre><code>cd /var/www/html </code></pre>
<p>切换到apache项目目录下，新建文件：</p>
<pre><code>sudo vim test.php</code></pre>
<p>保存后浏览器访问：localhost/test.php</p>
<p>如果能够正常显示内容出来，说明这个已经解析成功。</p>
<p><strong>Mysql安装</strong></p>
<p>接下来就是安装数据库Mysql了,数据库需要装服务端和客户端两个，输入命令：</p>
<pre><code>sudo apt-get install mysql-server mysql-client</code></pre>
<p>安装过程中会提示设置root账号的登录密码，输入后选择OK继续安装。</p>
<p>安装完成后，输入mysql -V 查看安装的版本信息。</p>
<p>同样的，我们还需要让mysql能够和php互动，安装php的mysql插件：</p>
<pre><code>sudo apt-get install php7.0-mysql</code></pre>
<p>最后我们还可以安装一些常用的php扩展，，因为笔者就是没有安装必要的扩展，导致在运行magento的安装程序的时候页面直接一篇空白，为了确认是否缺少扩展，笔者为此还单独下载了一个wordpress进行安装，发现在安装wordpress的时候提示缺少必要的wordpress扩展，这才引起笔者的注意，这里罗列一下php7.0的一些扩展：</p>
<p>ubuntu所有php扩展php-7.0扩展列表，可能会根据计算机位数不同有所差异，笔者电脑是64为。</p>
<pre><code>sudo apt-get install php7.0-bcmath 

sudo apt-get install php7.0-bz2 

sudo apt-get install php7.0-calendar 

sudo apt-get install php7.0-ctype 

sudo apt-get install php7.0-curl 

sudo apt-get install php7.0-dom 

sudo apt-get install php7.0-enchant 

sudo apt-get install php7.0-exif 

sudo apt-get install php7.0-fileinfo 

sudo apt-get install php7.0-ftp 

sudo apt-get install php7.0-gd 

sudo apt-get install php7.0-gettext 

sudo apt-get install php7.0-gmp 

sudo apt-get install php7.0-iconv 

sudo apt-get install php7.0-intl 

sudo apt-get install php7.0-json 

sudo apt-get install php7.0-ldap 

sudo apt-get install php7.0-mbstring 

sudo apt-get install php7.0-mysqli 

sudo apt-get install php7.0-mysqlnd 

sudo apt-get install php7.0-opcache 

sudo apt-get install php7.0-pdo 

sudo apt-get install php7.0-phar 

sudo apt-get install php7.0-posix 

sudo apt-get install php7.0-pspell 

sudo apt-get install php7.0-readline 

sudo apt-get install php7.0-shmop 

sudo apt-get install php7.0-simplexml 

sudo apt-get install php7.0-snmp 

sudo apt-get install php7.0-soap 

sudo apt-get install php7.0-sockets 

sudo apt-get install php7.0-sqlite3 

sudo apt-get install php7.0-sysvmsg 

sudo apt-get install php7.0-sysvsem 

sudo apt-get install php7.0-sysvshm 

sudo apt-get install php7.0-wddx 

sudo apt-get install php7.0-xml 

sudo apt-get install php7.0-xsl</code></pre>
<p>以下不能一次性全部安装，因为要选y </p>
<pre><code>sudo apt-get install php7.0-recode 

sudo apt-get install php7.0-dba 

sudo apt-get install php7.0-imap 

sudo apt-get install php7.0-interbase 

sudo apt-get install php7.0-odbc 

sudo apt-get install php7.0-pgsql 

sudo apt-get install php7.0-tidy 

sudo apt-get install php7.0-zip</code></pre>
<p>php-7.0 扩展列表 </p>
<pre><code>bcmath 
bz2 
calendar 
com_dotnet 
ctype 
curl 
date 
dba 
dom 
enchant 
exif 
fileinfo 
filter 
ftp 
gd 
gettext 
gmp 
hash 
iconv 
imap 
interbase 
intl 
json 
ldap 
libxml 
mbstring 
mcrypt 
mysqli 
mysqlnd 
oci8 
odbc 
opcache 
openssl 
pcntl 
pcre 
pdo 
pdo_dblib 
pdo_firebird 
pdo_mysql 
pdo_oci 
pdo_odbc 
pdo_pgsql 
pdo_sqlite 
pgsql 
phar 
posix 
pspell 
readline 
recode 
reflection 
session 
shmop 
simplexml 
skeleton 
snmp 
soap 
sockets 
spl 
sqlite3 
standard 
sysvmsg 
sysvsem 
sysvshm 
tidy 
vtokenizer 
wddx 
xml 
xmlreader 
xmlrpc 
xmlwriter 
xsl 
zip 
zlib</code></pre>
<p>好的，完成这些之后，我们需要各自的配置文件进行一个设置，由于笔者这个是magento，所以对环境的配置要求比较高，所以笔者只能逐个进入里面修改配置。</p>
<pre><code>/etc/php/7.0/apache2/php.ini      //这个设置一些参数，比如max size等等之类的
/etc/apache2/sites-enable/    //自定义设置一下web服务器的根目录
/etc/mysql/mysql.conf.d/mysqld.cnf     //设置一下关于mysql的一些参数</code></pre>
<p>这些配置文件的设置很重要，这里说一下关于apache修改默认的web根目录的问题，笔者在另外一篇文章里有写到，大家可以参考一下，搜索关键词即可。</p>
<blockquote>
<p>ubuntu下安装Apache，修改了web目录后，报You don’t have permission to access / on this server错误</p>
</blockquote>
<p><strong>因为设置完成了这些可以避免这样一个问题，如下：</strong></p>
<h3 id="问题描述："><a href="#问题描述：" class="headerlink" title="问题描述："></a>问题描述：</h3><p><strong>问题一：</strong>安装卡在 sample data 部分，没有错误提示</p>
<p><img src="https://i.imgur.com/gpM9PHs.png"></p>
<p>解决方法：</p>
<p>increasing the MySQL max_allowed_packet</p>
<p>如果你是用的集成包，比如Wamp，那么可以去mysql配置文件设置一下。可以通过 sql 语句</p>
<pre><code>show VARIABLES like &#39;%max_allowed_packet%&#39;;</code></pre>
<p>查看设置值。所以这一步就是前面的修改配置文件的默认值，默认值是很低的，不能满足magento的安装需要。</p>
<p><strong>问题二：</strong>安装到 91% 卡住，但是看不出有问题</p>
<p>解决方法：</p>
<p>可能已经安装好了，可以尝试直接访问。</p>
<p>十有八九访问发现样式丢失，则执行</p>
<pre><code>php bin/magento  setup:static-content:deploy</code></pre>
<p>如果这样运行有提示那么，就换成如下：</p>
<pre><code>php bin/magento  setup:static-content:deploy -f</code></pre>
<hr>
<p>完成了这些之后，我们基本可以算是配置了一个符合magento运行的web环境，当然不能说全部都已经解决，这个时候我们可以在浏览器运行magento的安装，一步一步的完成安装，通常如果中途卡住了，如果再次运行或者刷新，等安装成功后，多半问出现样式问题，这个时候需要在命令框中输入：</p>
<pre><code>php bin/magento  setup:static-content:deploy</code></pre>
<p>也可以删除一下缓存试试。本文会持续更新，敬请关注。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/6/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/6/">6</a><span class="page-number current">7</span><a class="page-number" href="/page/8/">8</a><span class="space">&hellip;</span><a class="page-number" href="/page/43/">43</a><a class="extend next" rel="next" href="/page/8/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">泉哥</p>
  <div class="site-description" itemprop="description">日记</div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">424</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">400</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">泉哥</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>

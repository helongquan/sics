<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=2">
<meta name="theme-color" content="#222">
<meta name="generator" content="Hexo 5.2.0">
  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png">
  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png">
  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png">
  <link rel="mask-icon" href="/images/logo.svg" color="#222">

<link rel="stylesheet" href="/css/main.css">


<link rel="stylesheet" href="/lib/font-awesome/css/all.min.css">

<script id="hexo-configurations">
    var NexT = window.NexT || {};
    var CONFIG = {"hostname":"example.com","root":"/","scheme":"Gemini","version":"7.8.0","exturl":false,"sidebar":{"position":"left","display":"post","padding":18,"offset":12,"onmobile":false},"copycode":{"enable":false,"show_result":false,"style":null},"back2top":{"enable":true,"sidebar":false,"scrollpercent":false},"bookmark":{"enable":false,"color":"#222","save":"auto"},"fancybox":false,"mediumzoom":false,"lazyload":false,"pangu":false,"comments":{"style":"tabs","active":null,"storage":true,"lazyload":false,"nav":null},"algolia":{"hits":{"per_page":10},"labels":{"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}},"localsearch":{"enable":false,"trigger":"auto","top_n_per_article":1,"unescape":false,"preload":false},"motion":{"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}}};
  </script>

  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://example.com/page/30/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="en_US">
<meta property="article:author" content="John Doe">
<meta name="twitter:card" content="summary">

<link rel="canonical" href="http://example.com/page/30/">


<script id="page-configurations">
  // https://hexo.io/docs/variables.html
  CONFIG.page = {
    sidebar: "",
    isHome : true,
    isPost : false,
    lang   : 'en'
  };
</script>

  <title>Hexo</title>
  






  <noscript>
  <style>
  .use-motion .brand,
  .use-motion .menu-item,
  .sidebar-inner,
  .use-motion .post-block,
  .use-motion .pagination,
  .use-motion .comments,
  .use-motion .post-header,
  .use-motion .post-body,
  .use-motion .collection-header { opacity: initial; }

  .use-motion .site-title,
  .use-motion .site-subtitle {
    opacity: initial;
    top: initial;
  }

  .use-motion .logo-line-before i { left: initial; }
  .use-motion .logo-line-after i { right: initial; }
  </style>
</noscript>

</head>

<body itemscope itemtype="http://schema.org/WebPage">
  <div class="container use-motion">
    <div class="headband"></div>

    <header class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-container">
  <div class="site-nav-toggle">
    <div class="toggle" aria-label="Toggle navigation bar">
      <span class="toggle-line toggle-line-first"></span>
      <span class="toggle-line toggle-line-middle"></span>
      <span class="toggle-line toggle-line-last"></span>
    </div>
  </div>

  <div class="site-meta">

    <a href="/" class="brand" rel="start">
      <span class="logo-line-before"><i></i></span>
      <h1 class="site-title">Hexo</h1>
      <span class="logo-line-after"><i></i></span>
    </a>
  </div>

  <div class="site-nav-right">
    <div class="toggle popup-trigger">
    </div>
  </div>
</div>




<nav class="site-nav">
  <ul id="menu" class="main-menu menu">
        <li class="menu-item menu-item-home">

    <a href="/" rel="section"><i class="fa fa-home fa-fw"></i>Home</a>

  </li>
        <li class="menu-item menu-item-archives">

    <a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>Archives</a>

  </li>
  </ul>
</nav>




</div>
    </header>

    
  <div class="back-to-top">
    <i class="fa fa-arrow-up"></i>
    <span>0%</span>
  </div>


    <main class="main">
      <div class="main-inner">
        <div class="content-wrap">
          

          <div class="content index posts-expand">
            
      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/31/xshell%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BAmysql%E6%95%B0%E6%8D%AE%E5%BA%93/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/31/xshell%E4%B8%AD%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BAmysql%E6%95%B0%E6%8D%AE%E5%BA%93/" class="post-title-link" itemprop="url">xshell中导入导出mysql数据库</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-31 21:06:02" itemprop="dateCreated datePublished" datetime="2017-08-31T21:06:02+08:00">2017-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:07" itemprop="dateModified" datetime="2020-10-11T11:53:07+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>先用xshell登录到服务器，然后进入到mysql数据库中去，我这里用的是阿里云一键web安装包，所以我这里的mysql数据的存放位置在</p>
<pre><code>/alidata/server/mysql-5.6.21/data</code></pre>
<p>先查看下自己要导出的数据库是否存在，我这里以magento为例，这里有magento，接着在这个目录下运行命令：</p>
<pre><code>mysqldump -u 用户名 -p 数据库名 &gt; 导出的文件名</code></pre>
<p>这里我运行的命令如下：</p>
<pre><code>mysqldump -u root -p magento &gt; magento.sql</code></pre>
<p>完成后，这个时候运行命令：</p>
<pre><code>ls</code></pre>
<p>就可以看到在当前目录下多了一个magento.sql</p>
<p>然后，我们可以通过linux的命令，把这个sql文件下载到电脑本地，运行命令如下</p>
<pre><code>sz magento.sql</code></pre>
<p>这里值得提醒的是，先看下服务器是否已经安装这个模块，先查看</p>
<pre><code>rpm -qa | grep lrzsz    利用此命令查看是否安装了lrzsz</code></pre>
<p>如果没有任何反应则是没有安装<br>若没有安装</p>
<pre><code>yum install lrzsz   安装</code></pre>
<p>安装完毕后，再运行</p>
<pre><code>sz magento.sql</code></pre>
<p>到此为止，我们已经完成了在服务器端，通过命令的方式导出数据库数据到电脑本地，现在我们想把本地的数据库数据上传到服务器，然后导入数据，那该怎么办呢？请往下看：</p>
<p>假设我们电脑本地有个magento.sql文件，我们直接在服务器根目录下运行，为了确保是否在根目录，只需运行</p>
<pre><code>cd /</code></pre>
<p>就可以回到跟目录了</p>
<pre><code>rz</code></pre>
<p>这时候会弹出一个窗口，然后找到magento.sql，点击上传就行了，当上传完毕后，在服务器根目录下会看到一个magento.sql的文件，然后我们登录服务器的数据库，运行如下命令:</p>
<pre><code>mysql -u root -p</code></pre>
<p>然后输入命令</p>
<p>然后查看数据库</p>
<pre><code>show databases;</code></pre>
<p>如果要把这个上传的数据导入到一个空的数据库中，假设是news数据库，我们先要选择这个数据库</p>
<pre><code>use news</code></pre>
<p>然后，我们运行命令：</p>
<pre><code>source /magento.sql</code></pre>
<p>这样我们就顺利完成了。</p>
<p>其实，这个跟数据库还原数据是一个道理，比如：</p>
<pre><code>[root@localhost ~]# cd /alidata/server/mysql-5.6.21/data  (进入到MySQL库目录，根据自己的MySQL的安装情况调整目录)
[root@localhost mysql]# mysql -u root -p news&lt;magento.sql   输入密码即可,这里我想要实现的是对数据库news恢复数据，而数据在magento.sql中。</code></pre>
<p>当然也可以这样运行</p>
<pre><code>[root@jdu4e00u53f7 /]# cd /</code></pre>
<p>magento.sql文件在根目录下，然后运行命令：</p>
<pre><code>mysql -u root -p news &lt; magento.sql</code></pre>
<p>然后输入密码即可。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/31/Magento2-Blog-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E6%9D%90/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/31/Magento2-Blog-%E6%8F%92%E4%BB%B6%E5%BC%80%E5%8F%91%E6%95%99%E6%9D%90/" class="post-title-link" itemprop="url">Magento2 Blog 插件开发教材</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-31 17:17:57" itemprop="dateCreated datePublished" datetime="2017-08-31T17:17:57+08:00">2017-08-31</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:26" itemprop="dateModified" datetime="2020-10-11T11:53:26+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>Magento2 博客插件开发系列，插件名称是Cattheme_Blog</p>
<p>1.首先在Magento2后台添加插件，这里需要说一下，可能在magento2版本里未必有code这个文件夹，没有的话，就新建一个文件夹，反正是目录一致就对了：</p>
<p>在 app/code/Cattheme/Blog/ 目录下添加 registration.php 文件：</p>
<pre><code>&lt;?php
\Magento\Framework\Component\ComponentRegistrar::register(
    \Magento\Framework\Component\ComponentRegistrar::MODULE,
    &#39;Cattheme_Blog&#39;,
    __DIR__
);</code></pre>
<p>在 app/code/Cattheme/Blog/etc/ 下添加 module.xml：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;urn:magento:framework:Module/etc/module.xsd&quot;&gt;
    &lt;module name=&quot;Cattheme_Blog&quot; setup_version=&quot;1.0.0&quot;&gt;
    &lt;/module&gt;
&lt;/config&gt;</code></pre>
<p>然后，在字符终端下cd 到Magento2的目录，用下面CLI命令激活插件：</p>
<pre><code>$ php bin/magento setup:upgrade</code></pre>
<p>在该命令的输出中如果有 Cattheme_Blog，就表明插件已经激活。</p>
<p>2.添加后台菜单：</p>
<p>在 app/code/Cattheme/Blog/etc/adminhtml/ 添加 menu.xml：</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;urn:magento:module:Magento_Backend:etc/menu.xsd&quot;&gt;
    &lt;menu&gt;
        &lt;add id=&quot;Cattheme_Blog::elements&quot; title=&quot;Blog&quot; module=&quot;Cattheme_Blog&quot; parent=&quot;Magento_Backend::content&quot; sortOrder=&quot;10&quot; resource=&quot;Cattheme_Blog::elements&quot; /&gt;
        &lt;add id=&quot;Cattheme_Blog::post&quot; title=&quot;Posts&quot; module=&quot;Cattheme_Blog&quot; parent=&quot;Cattheme_Blog::elements&quot; sortOrder=&quot;10&quot; action=&quot;blog/post&quot; resource=&quot;Cattheme_Blog::post&quot; /&gt;
        &lt;add id=&quot;Cattheme_Blog::category&quot; title=&quot;Categories&quot; module=&quot;Cattheme_Blog&quot; parent=&quot;Cattheme_Blog::elements&quot; sortOrder=&quot;20&quot; action=&quot;blog/category&quot; resource=&quot;Cattheme_Blog::category&quot; /&gt;
        &lt;add id=&quot;Cattheme_Blog::import&quot; title=&quot;Import&quot; module=&quot;Cattheme_Blog&quot; parent=&quot;Cattheme_Blog::elements&quot; sortOrder=&quot;30&quot; action=&quot;blog/import&quot; resource=&quot;Cattheme_Blog::import&quot; /&gt;
    &lt;/menu&gt;
&lt;/config&gt;</code></pre>
<p>加菜单后，加入Magento2 后台，可以在 Content 里看到新添加的菜单项：</p>
<p><img src="http://i.imgur.com/EwPqsdS.png"></p>
<p>3.添加菜单控制：</p>
<p>我们注意第二步添加的菜单项中的 action 分别是 blog/post, blog/category, blog/import, 我们现在要添加 blog 这个 route, 在 app/code/Cattheme/Blog/etc/adminhtml/ 下添加 routes.xml</p>
<pre><code>&lt;?xml version=&quot;1.0&quot;?&gt;
&lt;config xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot; xsi:noNamespaceSchemaLocation=&quot;urn:magento:framework:App/etc/routes.xsd&quot;&gt;
    &lt;router id=&quot;admin&quot;&gt;
        &lt;route id=&quot;blog&quot; frontName=&quot;blog&quot;&gt;
            &lt;module name=&quot;Cattheme_Blog&quot; /&gt;
        &lt;/route&gt;
    &lt;/router&gt;
&lt;/config&gt;</code></pre>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/30/xshell5%E5%90%91linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/30/xshell5%E5%90%91linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E4%B8%8A%E4%BC%A0%E4%B8%8B%E8%BD%BD%E6%96%87%E4%BB%B6/" class="post-title-link" itemprop="url">xshell5向linux服务器上传下载文件</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-30 20:55:30" itemprop="dateCreated datePublished" datetime="2017-08-30T20:55:30+08:00">2017-08-30</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:07" itemprop="dateModified" datetime="2020-10-11T11:53:07+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>利用 lrzsz工具</p>
<p>首先通过xshell登录到服务器上</p>
<pre><code>rpm -qa | grep lrzsz    利用此命令查看是否安装了lrzsz</code></pre>
<p>如果没有任何反应则是没有安装</p>
<p>若没有安装</p>
<pre><code>yum install lrzsz     安装</code></pre>
<p>之后输入</p>
<pre><code>rz</code></pre>
<p>弹出窗口</p>
<p><img src="http://i.imgur.com/6T8ECZq.png"></p>
<p>弹出以上窗口选择上传文件</p>
<p>上传的文件的路径在输入rz命令的路径</p>
<p>下载文件的话就</p>
<pre><code>sz filename</code></pre>
<p><img src="http://i.imgur.com/lEp7smN.png"></p>
<p>完成下载</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/14/%E4%B8%BAwordpress%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E4%BD%8D%E7%BD%AE/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/14/%E4%B8%BAwordpress%E6%B7%BB%E5%8A%A0%E8%87%AA%E5%AE%9A%E4%B9%89%E8%8F%9C%E5%8D%95%E4%BD%8D%E7%BD%AE/" class="post-title-link" itemprop="url">为wordpress添加自定义菜单位置和自定义添加小工具</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-14 21:16:30" itemprop="dateCreated datePublished" datetime="2017-08-14T21:16:30+08:00">2017-08-14</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:52:53" itemprop="dateModified" datetime="2020-10-11T11:52:53+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在设计 WordPress 主题的时候需要在主题里的模板文件里显示出我们在 WordPress 的管理后台定制的导航菜单。下面介绍一下流程跟方法。</p>
<p><strong>注册导航菜单的位置</strong></p>
<p>你可以注册多个导航菜单的位置，然后你可以在模板文件中决定什么地方使用什么位置的导航菜单。注册导航菜单位置是在主题的 functions.php 文件里。像下面这样：</p>
<pre><code>function mycustommenu_setup()&#123;
  // 注册菜单
  register_nav_menu( &#39;primary&#39;, __( &#39;自定义菜单位置一&#39;, &#39;mytheme&#39; ) );
&#125;
add_action( &#39;after_setup_theme&#39;, &#39;mycustommenu_setup&#39; );</code></pre>
<p>如果要添加多个菜单位置的话，可以如下方式：</p>
<pre><code>function mycustommenu_setup_one()&#123;
  // 注册菜单
  register_nav_menu( &#39;primary_one&#39;, __( &#39;自定义菜单位置一&#39;, &#39;mytheme_one&#39; ) );
&#125;
add_action( &#39;after_setup_theme&#39;, &#39;mycustommenu_setup_one&#39; );


function mycustommenu_setup_two()&#123;
      // 注册菜单
      register_nav_menu( &#39;primary_two&#39;, __( &#39;自定义菜单位置二&#39;, &#39;mytheme_two&#39; ) );
    &#125;
add_action( &#39;after_setup_theme&#39;, &#39;mycustommenu_setup_two&#39; );</code></pre>
<p>mycustommenu_setup()是我们自己创建的一个函数，函数下面的 add_action( ‘after_setup_theme’, ‘mycustommenu_setup’ ); 这行代码，是把我们自己创建的 mycustommenu_setup() 这个函数挂载到 after_setup_theme() 这个函数上面，这个函数会在 WordPress 初始化主题的时候调用，调用它的同时，也会调用我们自己的 mycustommenu_setup() 这个函数。</p>
<p>在 mycustommenu_setup() 这个函数里，我们使用 register_nav_menu() 来注册了一个导航菜单的位置。这个位置的名字叫 primary，名字的后面是一个描述，这个描述文件可以显示在 WordPress 的管理后台上，我们把描述文字定义成了可被翻译的字符串，你可以为它创建不同语言的翻译版本。</p>
<blockquote>
<p>注：如果在你自已的主题中应用这段代码，需要把这里所有出现的mytheme修改成你自己的主题的名称。</p>
</blockquote>
<p><strong>在管理后台创建菜单</strong></p>
<p>在主题中注册了导航菜单的位置，然后打开 WordPress 管理后台，外观 - 菜单，在这里你可以创建一个菜单。然后在 主题位置 这里，你可以看到你注册的菜单位置，这里应该会显示一个 Primary Menu。点击下拉菜单，选择你想在这个位置上显示的菜单，然后，保存。</p>
<p><strong>在主题的模板文件中显示导航菜单</strong></p>
<p>目前在我们注册的导航菜单位置上已经指定了一个菜单，如果你想在主题模板文件中显示这个位置上的导航菜单，可以使用 wp_nav_menu() ，看起来像这样：</p>
<pre><code>&lt;?php wp_nav_menu( array(
  &#39;theme_location&#39;     =&gt;     &#39;primary&#39;,
  ) );
 ?&gt;</code></pre>
<p>我们设置了一下 wp_nav_menu() 的 theme_location 参数，参数的值为 primary，意思就是，我们在这里要显示在 primary 这个位置上的导航菜单。 现在，在 WordPress 的某些页面中就应该可以显示出这个导航菜单了，剩下的事儿就是为这个导航菜单添加一些自定义的样式。</p>
<p><strong>wp_nav_menu() 输出的导航菜单代码演示</strong></p>
<p>代码：</p>
<pre><code>&lt;ul&gt;
  &lt;li id=&quot;menu-item-422&quot; class=&quot;menu-item menu-item-type-custom menu-item-object-custom current-menu-item current_page_item menu-item-home menu-item-422&quot;&gt;&lt;a href=&quot;http://fenikso:8888/&quot;&gt;首页&lt;/a&gt;&lt;/li&gt;
  &lt;li id=&quot;menu-item-56&quot; class=&quot;menu-item menu-item-type-taxonomy menu-item-object-category menu-item-56&quot;&gt;&lt;a href=&quot;http://fenikso:8888/?cat=3&quot;&gt;真实婚礼&lt;/a&gt;
    &lt;ul class=&quot;sub-menu&quot;&gt;
      &lt;li id=&quot;menu-item-57&quot; class=&quot;menu-item menu-item-type-taxonomy menu-item-object-category menu-item-57&quot;&gt;&lt;a href=&quot;http://fenikso:8888/?cat=4&quot;&gt;后院婚礼&lt;/a&gt;&lt;/li&gt;
      &lt;li id=&quot;menu-item-58&quot; class=&quot;menu-item menu-item-type-taxonomy menu-item-object-category menu-item-58&quot;&gt;&lt;a href=&quot;http://fenikso:8888/?cat=8&quot;&gt;海滩婚礼&lt;/a&gt;&lt;/li&gt;
      &lt;li id=&quot;menu-item-59&quot; class=&quot;menu-item menu-item-type-taxonomy menu-item-object-category menu-item-59&quot;&gt;&lt;a href=&quot;http://fenikso:8888/?cat=7&quot;&gt;绿色婚礼&lt;/a&gt;&lt;/li&gt;
    &lt;/ul&gt;
  &lt;/li&gt;
&lt;/ul&gt;</code></pre>
<p>视图：</p>
<ul>
<li>首页</li>
<li>真实婚礼</li>
<li>后院婚礼</li>
<li>海滩婚礼</li>
<li>绿色婚礼</li>
</ul>
<p><strong>激活菜单项</strong></p>
<p>WordPress 会在当前页面的菜单项上添加一个 .current-menu-item 类，如果当前页面是某个菜单项的子菜单，那么在这个父菜单项上会添加一个 .current-menu-ancestor 类。你可以根据这两个类在样式表里添加样式，让用户很容易区分出当前所在的位置属于哪个菜单项。</p>
<p><strong>在激活菜单项上添加自定义的 CSS 类</strong></p>
<p>我们可以在主题的 functions.php 文件里创建一个函数，用来改变添加到菜单项上的 css 类。可以使用下面的代码：</p>
<pre><code>/*
 * 给激活的导航菜单添加 .active
 */
function mytheme_nav_menu_css_class( $classes ) &#123;
     if ( in_array(&#39;current-menu-item&#39;, $classes ) OR in_array( &#39;current-menu-ancestor&#39;, $classes ) )
          $classes[]     =     &#39;active&#39;;
     return $classes;
&#125;
add_filter( &#39;nav_menu_css_class&#39;, &#39;mytheme_nav_menu_css_class&#39; );</code></pre>
<p>上面这段代码的意思是，查找菜单项里是否有 .current-menu-item 或 .current-menu-ancestor ，如果有，那么在这个菜单项上再添加一个 .active 类。 add_filter( ‘nav_menu_css_class’, ‘mytheme_nav_menu_css_class’ ); 这行代码是把我们自己创建的函数挂载到 nab_menu_css_class() 这个函数上，它应该是为菜单项添加 css 类的函数，当 WordPress 执行这个函数的时候，同时也会执行我们自已创建的 mytheme_nav_menu_css_class() 这个函数。<br>注 在自己的主题中使用这段代码，要把 mytheme 替换成你自己的主题的名称。</p>
<p>这里我们也可以为wordpress主题添加自定义的小工具显示位置，继续往下面看：</p>
<p>大多数童鞋和起点一样喜欢下载现成的模板使用。但是对于有些模板，作者是禁用小工具的，而我们这时又很需要它，怎么给wordpress自定义添加个小工具呢？起点SEO是这么做的：</p>
<p>首先，需要在functions.php函数文件里添加小工具的函数参数。如果你的模板没有小工具，直接添加在functions.php的?&gt;最下面即可；如果已有小工具，你想再添加几个，可选择?&gt;最下面或者已有小工具函数下面。下面起点SEO，就先写一段代码详细描述一下：</p>
<pre><code>&lt;?php
if ( function_exists(&#39;register_sidebar&#39;) ) register_sidebar(array(
&#39;name&#39; =&gt; &#39;Sidebar_1&#39;,
&#39;before_widget&#39; =&gt; &#39;&lt;li&gt;&#39;,
&#39;after_widget&#39; =&gt; &#39;&lt;/li&gt;&#39;,
&#39;before_title&#39; =&gt; &#39;&lt;h3&gt;&#39;,
&#39;after_title&#39; =&gt; &#39;&lt;/h3&gt;&#39;,
));

if ( function_exists(&#39;register_sidebar&#39;) ) register_sidebar(array(
&#39;name&#39; =&gt; &#39;Sidebar_2&#39;,
&#39;before_widget&#39; =&gt; &#39;&lt;li&gt;&#39;,
&#39;after_widget&#39; =&gt; &#39;&lt;/li&gt;&#39;,
&#39;before_title&#39; =&gt; &#39;&lt;h3&gt;&#39;,
&#39;after_title&#39; =&gt; &#39;&lt;/h3&gt;&#39;,
));

if ( function_exists(&#39;register_sidebar&#39;) ) register_sidebar(array(
&#39;name&#39; =&gt; &#39;Sidebar_3&#39;,
&#39;before_widget&#39; =&gt; &#39;&lt;li&gt;&#39;,
&#39;after_widget&#39; =&gt; &#39;&lt;/li&gt;&#39;,
&#39;before_title&#39; =&gt; &#39;&lt;h3&gt;&#39;,
&#39;after_title&#39; =&gt; &#39;&lt;/h3&gt;&#39;,
));
?&gt;</code></pre>
<p>上面这段代码中，起点定义了3个小工具，一共5个参数，name定义小工具的ID名，此ID名必须唯一；’before_widget’ 定义的是小工具内容的开始标记； ‘after_widget’ 定义的是小工具内容的结束标记； ‘before_title’ 定义的是小工具标题的开始标记；’after_title’ 定义的是小工具标题的结束标记。值得一提的是，由于5个参数直接对应前段网页显示，如果我们想给小工具的内容定义一个类名为“content”的样式，标题定义一个类名为“title”的样式，按如下修改参数即可:</p>
<pre><code>&#39;before_widget&#39; =&gt; &#39;&lt;li class=&quot;content&quot;&gt;&#39;,

&#39;before_title&#39; =&gt; &#39;&lt;h3 class=&quot;title&quot;&gt;&#39;,</code></pre>
<p>然后，在想添加小工具位置，修改模板代码。一般来说，小工具代码都是放置在sidebar.php里面的，我们只需要在想要添加小工具的位置放如下代码即可：</p>
<pre><code>&lt;div&gt;
&lt;ul&gt;
&lt;?php if ( !function_exists(&#39;dynamic_sidebar&#39;)
|| !dynamic_sidebar(Sidebar_1) ) : ?&gt;
&lt;?php endif; ?&gt;
&lt;/ul&gt;
&lt;/div&gt;</code></pre>
<p>细心的童鞋已经发现dynamic_sidebar(Sidebar_1) 调用的是小工具ID名为Sidebar_1的小工具。由于添加的小工具，里面定义的内容开始标记是li，所以php代码外面嵌套的是ul。这里留一个小问题，为什么开始我要给小工具内容参数的开始标记定义为li呢？</p>
<p>如果要调用其他小工具如法炮制，最后后台的显示样式如下:</p>
<p><img src="http://i.imgur.com/lrHWvaY.jpg"></p>
<p>这里再额外补充一个小知识吧，有时候我们栏目页和首页需要调用不同的边栏，显示不同的小工具怎么办呢？我们可以自定义一个边栏文件，取名为sidebar_left.php（注意：一定要为side_XX.php的模式）。因为这样，我们只需要把如下代码</p>
<pre><code>&lt;?php get_sidebar();?&gt;</code></pre>
<p>修改为</p>
<pre><code>&lt;?php get_sidebar(&#39;left&#39;);?&gt;</code></pre>
<p>即可，就可以改调用sidebar_left.php文件了，非常方便。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/11/%E5%9C%A8%E5%AE%89%E8%A3%85magento%E5%AE%98%E7%BD%91%E7%BA%AF%E5%87%80%E7%89%88%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/11/%E5%9C%A8%E5%AE%89%E8%A3%85magento%E5%AE%98%E7%BD%91%E7%BA%AF%E5%87%80%E7%89%88%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">在安装magento官网纯净版遇到的一些问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-11 18:41:53" itemprop="dateCreated datePublished" datetime="2017-08-11T18:41:53+08:00">2017-08-11</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:52:49" itemprop="dateModified" datetime="2020-10-11T11:52:49+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>在从magento的中文社区下载了一个magento，下载地址<a target="_blank" rel="noopener" href="https://github.com/magento/magento2/archive/develop.zip">https://github.com/magento/magento2/archive/develop.zip</a>，解压到本地服务器的根目录下，开始安装，可是安装的时候出现这样的一个报错：</p>
<pre><code>Autoload error

Vendor autoload is not found. Please run &#39;composer install&#39; under application root directory.</code></pre>
<p>这个时候我们在根目录下，我这个是在windows的操作系统下，然后打开命令窗口，运行命令：</p>
<pre><code>composer install</code></pre>
<p>然后根据提示运行了这条命令在magento的根目录（<a target="_blank" rel="noopener" href="http://localhost/magento2/%EF%BC%89%E4%B8%8B%EF%BC%8C%E5%BD%93%E7%84%B6%E8%BF%99%E4%B8%AA%E6%A0%B9%E7%9B%AE%E5%BD%95%E6%88%91%E6%8A%8A%E5%AE%83%E5%91%BD%E5%90%8D%E4%B8%BAmagento2%EF%BC%8C%E4%BD%A0%E5%8F%AF%E4%BB%A5%E9%9A%8F%E4%BE%BF%E5%8F%96%E4%BB%BB%E4%BD%95%E7%9A%84%E5%90%8D%E5%AD%97%EF%BC%8C%E6%9C%80%E5%BC%80%E5%A7%8B%E7%9A%84%E6%97%B6%E5%80%99%E8%BF%90%E8%A1%8C%E5%87%BA%E7%8E%B0%E8%BF%99%E6%A0%B7%E4%B8%80%E4%B8%AA%E9%94%99%E8%AF%AF%EF%BC%8C%E8%AF%B4%E6%98%AF">http://localhost/magento2/）下，当然这个根目录我把它命名为magento2，你可以随便取任何的名字，最开始的时候运行出现这样一个错误，说是</a></p>
<pre><code>The requested PHP extension ext-soap * is missing from your system. Install or enable PHP&#39;s soap extension.</code></pre>
<p>很显然，这个是PHP配置文件的配置的问题，然后找到php.ini文件，把</p>
<pre><code>;extension=php_soap.dll</code></pre>
<p>变成</p>
<pre><code>extension=php_soap.dll</code></pre>
<p>然后重启下apache，再次在根目录下运行</p>
<pre><code>composer install</code></pre>
<p>就开始安装了。</p>
<p>这个时候在浏览器的地址栏输入：<a target="_blank" rel="noopener" href="http://localhost/magento2/%E7%9A%84%E6%97%B6%E5%80%99%E5%B0%B1%E7%9C%8B%E5%88%B0%E7%86%9F%E6%82%89%E7%9A%84%E5%AE%89%E8%A3%85%E7%95%8C%E9%9D%A2%EF%BC%9A">http://localhost/magento2/的时候就看到熟悉的安装界面：</a></p>
<p><img src="http://i.imgur.com/aJJGNJH.jpg"></p>
<p>然后第一步是检查服务器的配置是否符合magento2的要求，我这里是成功的：</p>
<p><img src="http://i.imgur.com/AgMOolt.jpg"></p>
<p>这里顺便插句话，我们在开始使用magento的时候，就需要明白这样一个事实，就是环境配置的问题，magento2根magento1.v有很多地方是不一样的，配置要求如下：</p>
<p><img src="http://i.imgur.com/uPP0Yu9.jpg"></p>
<p>安装Magento2.0.X PHP的扩展需求：</p>
<pre><code>5.6.x
5.5.x ( x 大于 22)
7.0.2 至 7.0.14 (除了 7.0.5 和 7.0.4)
php 扩展
bc-math (商业版才需要）
curl
gd 或者 ImageMagick 6.3.7及以上版本 也可以两个都装
intl
mbstring
mcrypt
mhash
openssl
PDO/MySQL
SimpleXML
soap
xml
xsl
zip
PHP 7 only:
  json
  iconv</code></pre>
<p>还需要给Magento2开启Mysql的InnodB引擎。</p>
<p>然后，后面的步骤基本没啥问题，进行安装就行。</p>
<p>安装完成后，作为一个中国用户，我习惯性的把语言调成中文版的，方便调试。这个时候先去下载中文语言包</p>
<pre><code>https://www.mageoo.com/media/wysiwyg/2016/11/zh_Hans_CN.zip</code></pre>
<p>你也可以在这里下载：</p>
<pre><code>http://pan.baidu.com/s/1jHZvR98</code></pre>
<p>密码：xgoi</p>
<p>然后就是安装语言</p>
<p>上传到mage2.store/app/i18n/Magento/zh_Hans_CN文件夹【备注：mage2.store/vendor/magento/language-zh_hans_cn】运行脚本命令：</p>
<p>在magento的根目录下运行命令</p>
<pre><code>php bin/magento setup:static-content:deploy zh_Hans_CN</code></pre>
<p><strong>后台显示中文界面</strong></p>
<p>编辑后台用户账号，把Interface Locale 设为中文。如下图： </p>
<p><img src="http://i.imgur.com/oN90MaY.png"></p>
<p><img src="http://i.imgur.com/qtJm1Hl.png"></p>
<p><strong>前台使用中文</strong></p>
<p>修改店铺配置，把Locale Options 下面的locale 设为中文，如下图： </p>
<p><img src="http://i.imgur.com/g2XBmc1.png"></p>
<p><img src="http://i.imgur.com/33nScor.png"></p>
<p>这样magento基本的安装和语言包的安装就完成了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/05/%E7%94%A8nginx%E5%81%9A%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E6%97%B6%E5%80%99%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/05/%E7%94%A8nginx%E5%81%9A%E5%8F%8D%E5%90%91%E4%BB%A3%E7%90%86%E7%9A%84%E6%97%B6%E5%80%99%E9%81%87%E5%88%B0%E7%9A%84%E4%B8%80%E4%BA%9B%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">用nginx做反向代理的时候遇到的一些问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-05 22:47:08" itemprop="dateCreated datePublished" datetime="2017-08-05T22:47:08+08:00">2017-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:52:52" itemprop="dateModified" datetime="2020-10-11T11:52:52+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我在做一个用nginx做反向代理的时候，出现了一些问题，根据文章<a target="_blank" rel="noopener" href="http://www.habotalk.com/server/1399.html%E5%BC%80%E5%B1%95%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%9C%AC%E5%9C%B0%E5%AE%89%E8%A3%85%E8%BF%99%E4%B8%A4%E4%B8%AA%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E6%B2%A1%E4%BB%80%E4%B9%88%E5%A4%A7%E9%97%AE%E9%A2%98%EF%BC%8C%E5%9C%A8%E5%AE%89%E8%A3%85nginx%E6%9C%8D%E5%8A%A1%E7%9A%84%E6%97%B6%E5%80%99%EF%BC%8C%E5%BD%93%E6%88%91%E6%8A%8Anginx%E4%B8%8B%E8%BD%BD%E5%88%B0%E6%9C%AC%E5%9C%B0%EF%BC%8C%E5%9C%A8nginx%E6%89%80%E5%9C%A8%E7%9A%84%E7%9B%AE%E5%BD%95%E4%B8%8B%EF%BC%8C%E7%84%B6%E5%90%8E%E8%BF%90%E8%A1%8C">http://www.habotalk.com/server/1399.html开展的时候，本地安装这两个服务器的时候，没什么大问题，在安装nginx服务的时候，当我把nginx下载到本地，在nginx所在的目录下，然后运行</a></p>
<pre><code>start nginx</code></pre>
<p>这个时候成功，然后打开浏览器，输入127.0.0.1的时候并没有显示预期的，这个时候我看了下，是因为80端口被占用，然后就修改，找到conf文件夹下的nginx.conf，进去编辑了下，把端口号改成了8088，然后重启服务器，然后访问127.0.0.1:8088然后就对了。</p>
<p>apache的话，我是通过XAMPP这个一起安装的，所以端口我改成了80，以便经常性的使用。</p>
<p>好了本地的两个服务器都搭建好了，服务也开启了，现在我就要开启虚拟机中的apache了，先运行</p>
<pre><code>service httpd start</code></pre>
<p>居然报错，启动失败，然后我又把端口修改成了8001,还是不行，报错信息为：</p>
<pre><code>Starting httpd: (98)Address already in use: make_sock: could not bind to address [::]:80
(98)Address already in use: make_sock: could not bind to address 0.0.0.0:80
no listening sockets available, shutting down
Unable to open logs</code></pre>
<p>查看selinux状态：</p>
<pre><code>[root@guest-4-205 httpd]# sestatus
SELinux status:                 enabled
SELinuxfs mount:                /selinux
Current mode:                   permissive
Mode from config file:          enforcing
Policy version:                     24
Policy from config file:        targeted</code></pre>
<p>解决方案：</p>
<p>增加selinux中http的端口</p>
<pre><code>semanage port -l|grep http #查看SELinux下http相关端口

semanage port -a -t http_port_t -p tcp 8001 #增加这个非标准端口即可</code></pre>
<p>可是我在运行这个命令的时候报错了，说是没有这么一条命令，什么鬼？</p>
<p>报错命令：</p>
<pre><code>Command Not Found</code></pre>
<p>说明这个东西没有安装，该怎么办呢？运行如下命令：</p>
<pre><code>yum provides /usr/sbin/semanage </code></pre>
<p>然后接着运行如下命令：</p>
<pre><code>yum -y install policycoreutils-python</code></pre>
<p>安装完毕后，再运行下命令：</p>
<pre><code>semanage port -l|grep http #查看SELinux下http相关端口

semanage port -a -t http_port_t -p tcp 8001 #增加这个非标准端口即可</code></pre>
<p>就不会报错了，注意的是8001这个是根据你自己为apache设置的端口而定的，因为我这里的apache端口我改成了8001，我这里就写8001，如果是其他的端口号，一一对应就行了。</p>
<p>然后，我再次运行：</p>
<pre><code>service httpd start</code></pre>
<p>的时候就正常了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/05/woocommerce%E5%AE%9A%E5%88%B6/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/05/woocommerce%E5%AE%9A%E5%88%B6/" class="post-title-link" itemprop="url">woocommerce定制</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-05 14:41:46" itemprop="dateCreated datePublished" datetime="2017-08-05T14:41:46+08:00">2017-08-05</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:15" itemprop="dateModified" datetime="2020-10-11T11:53:15+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>1，如何把WooCommerce 集成到自己的新theme中？</p>
<p>Moving the calculate shipping module before the proceed to checkout is relatively easy.</p>
<ol>
<li><p>Create a woocommerce directory in your theme at the root if you haven’t already.</p>
</li>
<li><p>Go to the woocommerce plugin folder (/plugins/woocommerce/) and locate a folder called templates</p>
</li>
<li><p>Navigate to the cart directory within the templates directory and find the cart.PHP template file (/plugins/woocommerce/cart/cart.php)</p>
</li>
<li><p>Copy that file to your woocommerce directory within you theme using the same directory path (/woocommerce/cart/cart.php) - Meaning you have to have a folder of cart within the woocommerce folder</p>
</li>
</ol>
<p>Remember that this copy of cart.php now overrides the file in the plugin directory.</p>
<ol start="5">
<li><p>Look at the bottom of the cart.php file that you are now editing. At the very bottom is the following code:</p>
<pre><code> &lt;div class=&quot;cart-collaterals&quot;&gt;

     &lt;?php do_action(&#39;woocommerce_cart_collaterals&#39;); ?&gt;

     &lt;?php woocommerce_cart_totals(); ?&gt;

     &lt;?php woocommerce_shipping_calculator(); ?&gt;

 &lt;/div&gt;</code></pre>
</li>
</ol>
<p>The part that says woocommerce_shipping_calculater can be moved around.</p>
<ol start="6">
<li>Move woocommerce_shipping_calculater to where you want and test. I’m not sure that it can go anywhere but I tested moving it and it worked for me.</li>
</ol>
<p>This is an example of customizing WooCommerce using the method of overriding template files.</p>
<p><strong>2，如何修改woocommerce模板的的内容？</strong></p>
<p>You can edit and override any file within the woocommerce template directory using that method.</p>
<p>Rearranging some elements around may require actions and hooks within a functions.php file. I have created a file called functions-custom-woocommerce.php to separate my WooCommerce customizations.</p>
<p>If you create a separate WooCommerce functions file for customizations you will need to call it from your main functions.php file.</p>
<pre><code>&lt;?php
   /*---Include WooCommerce Custom Functions File*/
   include_once (TEMPLATEPATH . &#39;/functions-woocommerce-custom.php&#39;);
   /*---main theme functions go below...*/
?&gt;</code></pre>
<p>As an example, if we wanted to move the product title out of the summary section and position it above the main product image or somewhere at the top of the page we need to look at the content-single-product.php template file.</p>
<p>Here are the two sections we we need to look at in that file:</p>
<pre><code>&lt;?php
   /**
    * woocommerce_show_product_images hook
    *
    * @hooked woocommerce_show_product_sale_flash - 10
    * @hooked woocommerce_show_product_images - 20
    */
   do_action( &#39;woocommerce_before_single_product_summary&#39; );
   ?&gt;
&lt;div class=&quot;summary&quot;&gt;
   &lt;?php
      /**
       * woocommerce_single_product_summary hook
       *
       * @hooked woocommerce_template_single_title - 5
       * @hooked woocommerce_template_single_price - 10
       * @hooked woocommerce_template_single_excerpt - 20
       * @hooked woocommerce_template_single_add_to_cart - 30
       * @hooked woocommerce_template_single_meta - 40
       * @hooked woocommerce_template_single_sharing - 50
       */
      do_action( &#39;woocommerce_single_product_summary&#39; );
      ?&gt;
&lt;/div&gt;
&lt;!-- .summary --&gt;</code></pre>
<p>The part that outputs the main product image is woocommerce_before_single_product_summary</p>
<p>The part that outputs the product title is woocommerce_single_product_summary</p>
<p>Let’s pull the title out of the summary block and place it in the block that precedes it so the product title is above the product images.</p>
<p>Place this in your functions.php file or the custom functions file.</p>
<pre><code>/*---Move Product Title*/
remove_action( &#39;woocommerce_single_product_summary&#39;, &#39;woocommerce_template_single_title&#39;, 5 );
add_action( &#39;woocommerce_before_single_product_summary&#39;,
&#39;woocommerce_template_single_title&#39;, 5 );</code></pre>
<p>Hope that helps. I’m not a developer but have had to hack my way through WooCommerce to figure all this out.</p>
<p>**3 功能api引用 **</p>
<p> <a target="_blank" rel="noopener" href="http://code.tutsplus.com/articles/an-introduction-to-theming-woocommerce-for-wordpress--wp-31577">http://code.tutsplus.com/articles/an-introduction-to-theming-woocommerce-for-wordpress--wp-31577</a></p>
<p><strong>Disabling the Default Stylesheet and Starting From Scratch</strong></p>
<p>The default stylesheet can be disabled by adding a small snippet of code to your themes functions.php:</p>
<pre><code>define(&#39;WOOCOMMERCE_USE_CSS&#39;,
 false);</code></pre>
<p>The quickest way to get all of the WooCommerce classes is to copy the original WooCommerce CSS file in to your own and remove anything that you do not require.</p>
<p><strong>Declaring WooCommerce Support in Your Theme</strong></p>
<p>This is particularly important if you are selling themes or releasing them to the public.</p>
<p>Without specifically declaring WooCommerce support within your theme, users will be shown an error message upon installation of WooCommerce and it will stay there until it is dismissed.</p>
<p>Fortunately, this can all be solved with a small snippet of code inserted in to your themes functions.php file:</p>
<pre><code>add_theme_support(
&#39;woocommerce&#39;
);</code></pre>
<p><strong>Diving in a Bit Deeper: Editing Templates</strong></p>
<p>Editing the CSS within WooCommerce will get you quite a long way, but what about if you really want to customize the layout of pages? Luckily, there’s a nice way to do this.</p>
<p>The WooCommerce plugin comes with a number of front-end HTML templates as well as email templates. Instead of editing these files directly within the plugin (which is a very bad idea because once update the plugin and all of your changes will be lost!), you can copy them into your theme:</p>
<ol>
<li>In your theme directory, make a new folder called “woocommerce.”</li>
<li>Navigate to the WooCommerce plugin directory and open the “templates” folder. The templates folder has a lot of subfolders with all of the different templates that WooCommerce uses.  Fortunately, the template file structure and naming in WooCommerce is easy to follow.</li>
<li>In your newly created “woocommerce” folder, copy the template file that you want to edit. Remember to keep the directory structure the same here. If the template you want to edit is within a subfolder then remember to create that subfolder within your theme’s directory.</li>
<li>Edit the file from within your “woocommerce” folder and save the changes.</li>
</ol>
<p><strong>A Practical Example</strong></p>
<p>Let’s say that we want to change some of the HTML within the “My Orders” screen of WooCommerce.</p>
<p>The first thing we need to do is locate the correct template. In this case, the “My Orders” section is under “My Account” in WooCommerce. The directory structure looks like the following:</p>
<pre><code>/wp-content/plugins/woocommerce/templates/myaccount/my-orders.php</code></pre>
<p>Next, make a folder within your theme called “woocommerce” and within that folder make a second folder called “myaccount.” After that, copy the my-orders.php file into that directory.</p>
<p>You should be left with the following:</p>
<pre><code>/wp-content/themes/yourtheme/woocommerce/myaccount/my-orders.php</code></pre>
<p>Any changes made to this file will now override the original.</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/08/04/VPS%E4%B8%BB%E6%9C%BA%E4%B8%8A%E5%BB%BA%E7%AB%8BWordPress%E7%BD%91%E7%AB%99%E5%90%8E%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E5%8A%9F%E8%83%BD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/08/04/VPS%E4%B8%BB%E6%9C%BA%E4%B8%8A%E5%BB%BA%E7%AB%8BWordPress%E7%BD%91%E7%AB%99%E5%90%8E%E6%80%8E%E6%A0%B7%E5%AE%9E%E7%8E%B0%E9%82%AE%E4%BB%B6%E5%8F%91%E9%80%81%E5%8A%9F%E8%83%BD/" class="post-title-link" itemprop="url">VPS主机上建立WordPress网站后怎样实现邮件发送功能</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-08-04 10:22:43" itemprop="dateCreated datePublished" datetime="2017-08-04T10:22:43+08:00">2017-08-04</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:16" itemprop="dateModified" datetime="2020-10-11T11:53:16+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>VPS主机上建立WordPress网站后怎样实现邮件发送功能<br>Wordpress通过mail()函数来实现邮件发送，而mail函数需要sendmail模块支持才能正常工作。</p>
<blockquote>
<p>这里请先把整篇文章阅读完了，再开始实操。</p>
</blockquote>
<p>一般来说大多数人都是直接购买虚拟主机来搭建wordpress博客，而虚拟主机一般都默认安装了senmail模块，因此缺省的建在直接购买的虚拟主机上的wordpress的邮件发送功能是直接可以正常工作的。而在VPS上，需要手工安装sendmail模块予以实现。</p>
<p>一般情况下，VPS是需要安装VPS控制面板的，以便于对主机环境进行配置、方便建站和网站维护。有的VPS面板的安装程序已经集成了sendmail模块的安装，当vps控制面板安装完成后，wordpress的邮件发送也就可以直接使用了。如果sendmail模块没有被一起安装，则需要手工安装。</p>
<p>下面以Ubuntu为例说明如何安装sendmail：</p>
<p>1、安装：apt-get install sendmail</p>
<p>2、启动服务：service sendmail start</p>
<p>3、设置sendmail开机自动运行：</p>
<pre><code>apt-get install chkconfig
chkconfig sendmail on</code></pre>
<p>4.修改下php.ini的配置，调用sendmail功能：</p>
<pre><code>vim /usr/local/php/etc/php.ini </code></pre>
<p>找到有关sendmail_path的那一行，去掉行首注释，并改成如下的样子：</p>
<pre><code>sendmail_path = /usr/sbin/sendmail -t –i</code></pre>
<p>下面是centos下安装和配置sendmail：</p>
<p><strong>1、 Sendmail安装</strong></p>
<p>在CentOS下，sendmail一般默认是随操作系统一起安装的。如果安装系统时没有安装sendmail服务，手动安装sendmail也很简单：</p>
<pre><code># yum install -y sendmail 
# yum install -y sendmail-cf </code></pre>
<p>2、 Senmail的SMTP认证配置（不需要认证的可忽略此步）</p>
<p>首先确认saslauthd服务是否安装或启动。</p>
<p>安装saslauthd服务：# yum install -y saslauthd</p>
<p>启动saslauthd服务：# service saslauthd start</p>
<p><strong>(1) 配置Senmail的SMTP认证</strong></p>
<pre><code># vi /etc/mail/sendmail.mc</code></pre>
<p>然后找到以下两行代码</p>
<pre><code>dnl TRUST_AUTH_MECH(`EXTERNAL DIGEST-MD5 CRAM-MD5 LOGIN PLAIN&#39;)dnl 
dnl define(`confAUTH_MECHANISMS&#39;, `EXTERNAL GSSAPI DIGEST-MD5 CRAM-MD5 LOGIN PLAIN&#39;)dnl </code></pre>
<p>将上面两行的dnl去掉。在sendmail文件中，dnl表示该行为注释行，是无效的，因此通过去除行首的dnl字符串可以开启相应的设置行。</p>
<p><strong>(2) 设置Sendmail服务的网络访问权限</strong></p>
<pre><code># vi /etc/mail/sendmail.mc</code></pre>
<p>找到以下这句代码</p>
<pre><code>DAEMON_OPTIONS(`Port=smtp,Addr=127.0.0.1, Name=MTA&#39;)dnl </code></pre>
<p>将127.0.0.1改为0.0.0.0，意思是任何主机都可以访问Sendmail服务。如果仅让某一个网段能够访问到Sendmail服务，将127.0.0.1改为形如192.168.1.0/24的一个特定网段地址。</p>
<p><strong>3、 生成Sendmail配置文件</strong></p>
<p>Sendmail的配置文件由m4来生成，m4工具在sendmail-cf包中。如果系统无法识别m4命令，说明sendmail-cf软件包没有安装。</p>
<p>生成Sendmail的配置文件：</p>
<pre><code>m4 /etc/mail/sendmail.mc &gt; /etc/mail/sendmail.cf </code></pre>
<p>需要重启Sendmail才能使配置文件生效。</p>
<p><strong>4、 Sendmail邮件域名配置</strong></p>
<p>配置sendmail使用合法的域名分两步，修改sendmail的配置文件和添加域名MX记录。</p>
<p>sendmail可以直接使用 “-r <a href="mailto:&#97;&#x63;&#x63;&#111;&#x75;&#110;&#x74;&#x40;&#x64;&#111;&#x6d;&#97;&#x69;&#110;&#46;&#99;&#x6f;&#109;">&#97;&#x63;&#x63;&#111;&#x75;&#110;&#x74;&#x40;&#x64;&#111;&#x6d;&#97;&#x69;&#110;&#46;&#99;&#x6f;&#109;</a>” 参数来以任意源地址发送邮件，但目前主流的邮箱都会将源地址和反向解析IP进行比较，如果解析不到或是解析的IP不匹配，轻则将邮件直接归为SPAM，严重的就直接拒绝接收。</p>
<p>MX记录（Mail Exchanger Record）主要是接收邮件时使用，即当投递一封新邮件时，会查询收件人域名的MX记录，然后通过MX记录得到的IP地址进行投递。同时邮件厂商在接收邮件的时候也会将源地址和MX记录进行比较，作为垃圾邮件的判断标准之一。</p>
<p>第一步：添加域名</p>
<p>(1) 将域名加入到local-host-names文件</p>
<p>vi /etc/mail/local-host-names，添加</p>
<pre><code>abc123.com </code></pre>
<p>(2) 修改submit.cf文件</p>
<p> vi /etc/mail/submit.cf，找到行 #Dj$w.Foo.COM，修改为</p>
<pre><code>Djabc123.com </code></pre>
<p>至此，sendmail邮件命名配置完毕，重启sendmail使配置生效。</p>
<p>要使建在VPS上的wordpress能够发送邮件，还需要设定PHP.ini：</p>
<pre><code>vi /usr/local/php/etc/php.ini </code></pre>
<p>找到有关sendmail_path的那一行，去掉行首注释，并改成如下的样子：</p>
<pre><code>sendmail_path = /usr/sbin/sendmail</code></pre>
<p>这里虽然完成了，我还是不能解决这个问题，怎么办？</p>
<p>首先我需要说下的是，我的云服务器是centos的，版本6.5，然后呢，我是在WDCP的环境下出现的这个问题，最开始我请教了下服务器商家那边的人，那边说要把开启一个服务iptables，把这个服务启动，如果没有被启动的话。</p>
<p>然后，把25端口开启，开启办法如下：</p>
<p><img src="http://i.imgur.com/kOsyIgA.jpg"></p>
<p>然后查看下是否已经有了</p>
<p><img src="http://i.imgur.com/MYTFHq0.jpg"></p>
<p>如果没有这个，那么我们就添加一条规则，怎么添加呢？进入到安全管理模块</p>
<p><img src="http://i.imgur.com/Fn7a7LJ.jpg"></p>
<p>点击进入：</p>
<p><img src="http://i.imgur.com/gdrhPkS.jpg"></p>
<p>前面都不填，把目标端口填上25就行了，点击保存。</p>
<p>然后重启一下服务。</p>
<p>这是我在解决这个问题之前所做的，可是然并卵，还是收不到电邮。</p>
<p>然后，重点来了：</p>
<p>解决思路就是先不管WDCP默认系统中是否已经安装sendmail组件，我们先卸载，然后再重新安装就可以。</p>
<p>第一、卸载sendmail组件</p>
<pre><code>yum -y remove sendmail</code></pre>
<p>第二、重新安装sendmail组件</p>
<pre><code>yum -y install sendmail</code></pre>
<p>第三、启动sendmail组件</p>
<pre><code>service sendmail restart</code></pre>
<p>为了确保可以发送，我们可以查看下php.ini文件中的sendmail_path=文件路径，必须为/usr/sbin/sendmail才正确。</p>
<p>在服务器根目录下运行命令：</p>
<pre><code>sudo find / -name &#39;php.ini&#39;</code></pre>
<p>当然可能会搜索出很多，找到这个目录（这个是针对WDCP，如果是其他的环境，大家可以找到php.ini这个配置文件）：</p>
<pre><code>/www/wdlinux/etc/php.ini</code></pre>
<p>然后找到sendmail_path，一般情况是被注释的，找到有关sendmail_path的那一行，去掉行首注释，并改成如下的样子：</p>
<pre><code>sendmail_path = /usr/sbin/sendmail</code></pre>
<p>为了确保路径是对的，可以去这个路径下看看有木有这个sendmail，一般是有的。</p>
<p>最后一步，我们重启VPS。</p>
<p>这样我们就可以解决通过PHP的mail()函数进行电邮的发送了。</p>
<p>这里科普一下，通过PHP发送电邮的两种方式：</p>
<p><strong>一、使用PHP内置的mail()函数</strong></p>
<pre><code>&lt;?php 
$to = &quot;test@163.com&quot;; //收件人 
$subject = &quot;Test&quot;; //主题 
$message = &quot;This is a test mail!&quot;; //正文 
mail($to,$subject,$message);
?&gt;</code></pre>
<p>不过这种方式报错的几率会很大，我们可以改善一下：</p>
<pre><code>&lt;?php 
$to = &quot;test@163.com&quot;;//收件人 
$subject = &quot;Test&quot;;//邮件主题 
$message = &quot;This is a test mail!&quot;;//邮件正文 
ini_set(&#39;SMTP&#39;,&#39;smtp.163.com&#39;);//发件SMTP服务器 
ini_set(&#39;smtp_port&#39;,25);//发件SMTP服务器端口 
ini_set(&#39;sendmail_from&#39;,&quot;admin@163.com&quot;);//发件人邮箱 
mail($to,$subject,$message);
?&gt;</code></pre>
<p>看到没？简单的几行代码就能发送电邮了,根据自己的测试，很遗憾还是不能发送电邮，这是需要验证信息，怎么写验证信息呢？在哪里配置呢？带着这些疑问参考一些技术文章后得出结论，使用mail()函数发送邮件就必须要有一台无需SMTP验证就可以发信的邮件服务器。但现在的SMTP邮件服务器基本上都是需要验证的，所以要想使用它发邮件就只能自己在本地搭一个不需要验证的SMTP服务器。</p>
<p><strong>二、使用封装SMTP协议的邮件类</strong></p>
<p>这种方法就比较常见了，尤其对于广大自己没有服务器，从网上购买虚拟主机的同学，第一种方法不现实，所以还是自己使用SMTP协议来发送邮件吧。</p>
<p>不过要完成这项工作的话，就需要你对SMTP协议有一定的了解，喜欢事必躬亲的同学可以自己动手写一个，喜欢拿来主义的同学就可以从网上下载了，有很多。</p>
<p>不过我比较推荐使用PEAR扩展中的Mail类，功能强大：可以支持纯文本、HTML格式的邮件；各字段都可设置编码，正确配置不会出现中文乱码情况；可以支持附件等等。</p>
<p>在服务器可以使用pear install Mail 命令快速安装，没有足够服务器权限的同学也可以直接下载类的PHP源码包含进来就可以了。</p>
<p>注：Mail类依赖  Net/SMTP.php  和 Mail/mime.php ，要一块下载，使用时一块包含进来。</p>
<p>下面我举例说明一下在Mail类发送邮件的方法吧，网上其他SMTP邮件类使用方法一块也类似，可以参考：</p>
<pre><code>&lt;?php 

// Pear Mail 扩展 
require_once(&#39;Mail.php&#39;); 
require_once(&#39;Mail/mime.php&#39;); 
require_once(&#39;Net/SMTP.php&#39;); 

$smtpinfo = array(); 
$smtpinfo[&quot;host&quot;] = &quot;smtp.163.com&quot;;//SMTP服务器 
$smtpinfo[&quot;port&quot;] = &quot;25&quot;; //SMTP服务器端口 
$smtpinfo[&quot;username&quot;] = &quot;username@163.com&quot;; //发件人邮箱 
$smtpinfo[&quot;password&quot;] = &quot;password&quot;;//发件人邮箱密码 
$smtpinfo[&quot;timeout&quot;] = 10;//网络超时时间，秒 
$smtpinfo[&quot;auth&quot;] = true;//登录验证 
//$smtpinfo[&quot;debug&quot;] = true;//调试模式 

// 收件人列表 
$mailAddr = array(&#39;receiver@163.com&#39;); 

// 发件人显示信息 
$from = &quot;Name &lt;username@163.com&gt;&quot;; 

// 收件人显示信息 
$to = implode(&#39;,&#39;,$mailAddr); 

// 邮件标题 
$subject = &quot;这是一封测试邮件&quot;; 

// 邮件正文 
$content = &quot;&lt;h3&gt;随便写点什么&lt;/h3&gt;&quot;; 

// 邮件正文类型，格式和编码 
$contentType = &quot;text/html; charset=utf-8&quot;; 

//换行符号 Linux: \n Windows: \r\n 
$crlf = &quot;\n&quot;; 
$mime = new Mail_mime($crlf); 
$mime-&gt;setHTMLBody($content); 

$param[&#39;text_charset&#39;] = &#39;utf-8&#39;; 
$param[&#39;html_charset&#39;] = &#39;utf-8&#39;; 
$param[&#39;head_charset&#39;] = &#39;utf-8&#39;; 
$body = $mime-&gt;get($param); 

$headers = array(); 
$headers[&quot;From&quot;] = $from; 
$headers[&quot;To&quot;] = $to; 
$headers[&quot;Subject&quot;] = $subject; 
$headers[&quot;Content-Type&quot;] = $contentType; 
$headers = $mime-&gt;headers($headers); 

$smtp =&amp; Mail::factory(&quot;smtp&quot;, $smtpinfo); 


$mail = $smtp-&gt;send($mailAddr, $headers, $body); 
$smtp-&gt;disconnect(); 

if (PEAR::isError($mail)) &#123; 
  //发送失败 
  echo &#39;Email sending failed: &#39; . $mail-&gt;getMessage().&quot;\n&quot;; 
&#125; 
else&#123; 
  //发送成功 
  echo &quot;success!\n&quot;; 
&#125;
?&gt;</code></pre>
<p>结论：这种方式发送邮件无需装任何软件，只需要包含进来一个PHP类，然后多写几行配置代码，就可以了。并且网上有很多示例的代码，很多时候只要复制过来然后修改个别的几个参数就可以用了，所以会很方便，推荐使用此方法。</p>
<p>后面的这三段来自网友的努力，这里被我引用了，仅仅当做一种笔记，也算是一种参考。大家共同学习，如果有侵犯成果，请联系我。</p>
<p>结语：在云服务器上搭建wordpress的时候，不能发送电邮的问题，当你认真读完这篇文章后相信你已经解决了这个问题了，如果还有其他问题，可以与我一起交流，我的QQ：791447771</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/07/28/WordPress%E4%B8%8A%E4%BC%A0%E4%B8%AD%E6%96%87%E6%96%87%E4%BB%B6%E5%90%8D%E6%88%96%E5%9B%BE%E7%89%87%E5%90%8D%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/07/28/WordPress%E4%B8%8A%E4%BC%A0%E4%B8%AD%E6%96%87%E6%96%87%E4%BB%B6%E5%90%8D%E6%88%96%E5%9B%BE%E7%89%87%E5%90%8D%E4%B9%B1%E7%A0%81%E9%97%AE%E9%A2%98/" class="post-title-link" itemprop="url">WordPress上传中文文件名或图片名乱码问题</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-07-28 16:46:59" itemprop="dateCreated datePublished" datetime="2017-07-28T16:46:59+08:00">2017-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:11" itemprop="dateModified" datetime="2020-10-11T11:53:11+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>WordPress上传中文文件名或图片名乱码问题，很多时候我们可能忘记了在图片上去掉中文字符，很常见的情况就是QQ截图，总是有几个中文字符，由于wordpress对中文不太友好，所以会出现一些错误，这种错误在网站的搬迁的时候体现得淋漓尽致，一个深刻的教训就是：不要用中文命名一个图片。</p>
<p>首先修改一下上传，打开 wp-admin/include/file.php文件，找到</p>
<pre><code>$new_file = $uploads[&#39;path&#39;] . &quot;/$filename&quot;; </code></pre>
<p>改为</p>
<pre><code>$new_file = $uploads[&#39;path&#39;] . &#39;/&#39; . iconv(&#39;UTF-8&#39;, &#39;GBK&#39;, $filename);</code></pre>
<p>然后，找到</p>
<pre><code>return apply_filters( &#39;wp_handle_upload&#39;, array( &#39;file&#39; =&gt; $new_file, &#39;url&#39; =&gt; $url, &#39;type&#39; =&gt; $type ), &#39;upload&#39; );</code></pre>
<p>改为</p>
<pre><code>return apply_filters( &#39;wp_handle_upload&#39;, array( &#39;file&#39; =&gt; $uploads[&#39;path&#39;].&quot;/$filename&quot;, &#39;url&#39; =&gt; $url, &#39;type&#39; =&gt; $type ), &#39;upload&#39; );</code></pre>
<p>这句可能不一定全部一样，新版本的wordpress可能不一样，我修改的时候，这句是这样的：</p>
<pre><code>return apply_filters( &#39;wp_handle_upload&#39;, array(
    &#39;file&#39; =&gt; $uploads[&#39;path&#39;].&quot;/$filename&quot;,
    &#39;url&#39;  =&gt; $url,
    &#39;type&#39; =&gt; $type
), &#39;wp_handle_sideload&#39; === $action ? &#39;sideload&#39; : &#39;upload&#39; ); &#125;</code></pre>
<p>大家用不着跟着一模一样走，重点在这里：</p>
<p>把 <code>&#39;file&#39; =&gt; $new_file</code> 改成 <code>&#39;file&#39; =&gt; $uploads[&#39;path&#39;].&quot;/$filename&quot;</code>，这样就可允许上传以中文命名的图片了，这样中文图片的名字就会自动变成图片的alt属性值，图片名称会以时间格式进行命名。</p>
<p><strong>另一种办法：</strong></p>
<p>打开 wp-admin/include/file.PHP文件，把</p>
<pre><code>// Move the file to the uploads dir     
$new_file = $uploads[&#39;path&#39;] . &quot;/$filename&quot;;  
if ( false === @ move_uploaded_file( $file[&#39;tmp_name&#39;], $new_file ) )  
    return $upload_error_handler( $file, sprintf( __(&#39;The uploaded file could not be moved to %s.&#39; ), $uploads[&#39;path&#39;] ) );</code></pre>
<p>改成</p>
<pre><code>// Move the file to the uploads dir     
 $new_file = $uploads[&#39;path&#39;] . &quot;/&quot;.date_i18n(&quot;YmdHis&quot;).floor(microtime()*1000).&quot;.&quot;.$ext;  
 if ( false === @ move_uploaded_file( $file[&#39;tmp_name&#39;], $new_file ) )  
         return $upload_error_handler( $file, sprintf( __(&#39;The uploaded file could not be moved to %s.&#39; ), $uploads[&#39;path&#39;] ) );</code></pre>
<p>这个方法我没实践过，如果第一种方法还没搞定你的问题，可以试试第二种方法。</p>
<p>当然，另外一种情况就是使用插件，使用插件可以设置更灵活，插件名：Coolwp Pinyin Attachment Name</p>
<p>Coolwp Pinyin Attachment Name作者对插件的介绍：</p>
<p>Coolwp Pinyin Attachment Name是一个将上传附件中的中文改为拼音的插件，用于解决wordpress 附件不能使用中文名字的问题，典函数采用的是Xiaole Tao 的Pinyin Permalinks，字典范围为 GB2312 全码表约7000个汉字。</p>
<p>1.兼容英文版的Wordpress;</p>
<p>2.插件仅对标题中的中文字符进行友好转换，字典范围为 GB2312 全码表约7000个汉字;</p>
<p>3.使用分词符连接拼音便于人眼分辨;</p>
<p>4.非码表汉字会被忽略，如果标题里使用了特别的繁体汉字，可能需要手动为这些汉字添加拼音;</p>
<p>5.仅供Wordpress中文版用户使用，所以这里就没必要写英文版说明了。</p>
<p>6.字典函数来自于Xiaole Tao的插件Pinyin Permalinks。</p>
<p>另外一个插件，我只能用来研究，希望进一步完善，这个插件叫做：File Renaming on upload，这个设置一下就可以用了。使用前最好看下规则，该备份的备份，数据很重要。</p>
<p>这个需要更新下，最开始我说的设置貌似没起作用，起作用的是我安装的一个插件，叫做：uploading downloading non-latin filename</p>
<p>下载地址：<a target="_blank" rel="noopener" href="http://pan.baidu.com/s/1eSKQlai">点这里</a> 密码：v1vm</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  

      
  
  
  <article itemscope itemtype="http://schema.org/Article" class="post-block" lang="en">
    <link itemprop="mainEntityOfPage" href="http://example.com/2017/07/28/wordpress%E5%A4%9A%E7%AB%99%E7%82%B9%E6%B7%BB%E5%8A%A0%E5%AD%90%E7%AB%99%E7%82%B9%E5%A6%82%E4%BD%95%E8%AE%A9%E4%BB%96%E6%98%BE%E7%A4%BA%E5%9C%A8%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF%E4%B8%AD/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="image" content="/images/avatar.gif">
      <meta itemprop="name" content="John Doe">
      <meta itemprop="description" content="">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Hexo">
    </span>
      <header class="post-header">
        <h2 class="post-title" itemprop="name headline">
          
            <a href="/2017/07/28/wordpress%E5%A4%9A%E7%AB%99%E7%82%B9%E6%B7%BB%E5%8A%A0%E5%AD%90%E7%AB%99%E7%82%B9%E5%A6%82%E4%BD%95%E8%AE%A9%E4%BB%96%E6%98%BE%E7%A4%BA%E5%9C%A8%E6%8E%A7%E5%88%B6%E9%9D%A2%E6%9D%BF%E4%B8%AD/" class="post-title-link" itemprop="url">wordpress多站点添加子站点如何让他显示在控制面板中</a>
        </h2>

        <div class="post-meta">
            <span class="post-meta-item">
              <span class="post-meta-item-icon">
                <i class="far fa-calendar"></i>
              </span>
              <span class="post-meta-item-text">Posted on</span>

              <time title="Created: 2017-07-28 08:51:43" itemprop="dateCreated datePublished" datetime="2017-07-28T08:51:43+08:00">2017-07-28</time>
            </span>
              <span class="post-meta-item">
                <span class="post-meta-item-icon">
                  <i class="far fa-calendar-check"></i>
                </span>
                <span class="post-meta-item-text">Edited on</span>
                <time title="Modified: 2020-10-11 11:53:12" itemprop="dateModified" datetime="2020-10-11T11:53:12+08:00">2020-10-11</time>
              </span>

          

        </div>
      </header>

    
    
    
    <div class="post-body" itemprop="articleBody">

      
          <p>我们在建立wordpress多站点的时候，当我们新建子站点，发现新添加的子站点并没有在控制面板中显示，显得特别不方便，每次要切换到其他站点的时候，都要进去一次总目录下操作，该怎么解决这个问题呢？</p>
<p><img src="http://i.imgur.com/0aGrNGE.png"></p>
<p>最开始我们根据常规的建立子站点的方式：</p>
<p><img src="http://i.imgur.com/ViYrupd.png"></p>
<p>这里我们需要注意的是，如果蓝色框中的电子邮箱不是你所登录状态下的这个邮箱，将不会显示在这里控制面板中，比如我是以admin这个用户名新建子站点的，而admin这个用户对应的电邮是<a href="mailto:&#97;&#100;&#x6d;&#x69;&#110;&#x40;&#103;&#109;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;">&#97;&#100;&#x6d;&#x69;&#110;&#x40;&#103;&#109;&#x61;&#x69;&#108;&#46;&#x63;&#x6f;&#x6d;</a>的话，那么我这里添加电子邮箱为<a href="mailto:&#97;&#100;&#x6d;&#105;&#x6e;&#64;&#x67;&#109;&#97;&#105;&#108;&#x2e;&#99;&#x6f;&#x6d;">&#97;&#100;&#x6d;&#105;&#x6e;&#64;&#x67;&#109;&#97;&#105;&#108;&#x2e;&#99;&#x6f;&#x6d;</a>，那么新添加的域名就可以显示出来了。</p>
<p>有一种情况是，如果我们没有admin对应的邮箱怎么办呢？那么久没法显示，我们还可以这样做。</p>
<p>我们新建后，进入到新添加的那个子站点的控制面板中，找到用户，然后添加用户，截图如下：</p>
<p><img src="http://i.imgur.com/5ZgS38z.png"></p>
<p>这里记得是添加现有用户，然后把用户名admin填写进去，设置为管理员，不要发送邮箱，点击保存就行了。</p>
<p>最后的效果是：</p>
<p><img src="http://i.imgur.com/2534qv0.png"></p>
<p>这样就全部显示出来了。</p>

      
    </div>

    
    
    
      <footer class="post-footer">
        <div class="post-eof"></div>
      </footer>
  </article>
  
  
  


  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/29/"><i class="fa fa-angle-left" aria-label="Previous page"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/29/">29</a><span class="page-number current">30</span><a class="page-number" href="/page/31/">31</a><span class="space">&hellip;</span><a class="page-number" href="/page/43/">43</a><a class="extend next" rel="next" href="/page/31/"><i class="fa fa-angle-right" aria-label="Next page"></i></a>
  </nav>



          </div>
          

<script>
  window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }
</script>

        </div>
          
  
  <div class="toggle sidebar-toggle">
    <span class="toggle-line toggle-line-first"></span>
    <span class="toggle-line toggle-line-middle"></span>
    <span class="toggle-line toggle-line-last"></span>
  </div>

  <aside class="sidebar">
    <div class="sidebar-inner">

      <ul class="sidebar-nav motion-element">
        <li class="sidebar-nav-toc">
          Table of Contents
        </li>
        <li class="sidebar-nav-overview">
          Overview
        </li>
      </ul>

      <!--noindex-->
      <div class="post-toc-wrap sidebar-panel">
      </div>
      <!--/noindex-->

      <div class="site-overview-wrap sidebar-panel">
        <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
  <p class="site-author-name" itemprop="name">John Doe</p>
  <div class="site-description" itemprop="description"></div>
</div>
<div class="site-state-wrap motion-element">
  <nav class="site-state">
      <div class="site-state-item site-state-posts">
          <a href="/archives/">
        
          <span class="site-state-item-count">424</span>
          <span class="site-state-item-name">posts</span>
        </a>
      </div>
      <div class="site-state-item site-state-categories">
        <span class="site-state-item-count">25</span>
        <span class="site-state-item-name">categories</span>
      </div>
      <div class="site-state-item site-state-tags">
        <span class="site-state-item-count">400</span>
        <span class="site-state-item-name">tags</span>
      </div>
  </nav>
</div>



      </div>

    </div>
  </aside>
  <div id="sidebar-dimmer"></div>


      </div>
    </main>

    <footer class="footer">
      <div class="footer-inner">
        

        

<div class="copyright">
  
  &copy; 
  <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-heart"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">John Doe</span>
</div>
  <div class="powered-by">Powered by <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a>
  </div>

        








      </div>
    </footer>
  </div>

  
  <script src="/lib/anime.min.js"></script>
  <script src="/lib/velocity/velocity.min.js"></script>
  <script src="/lib/velocity/velocity.ui.min.js"></script>

<script src="/js/utils.js"></script>

<script src="/js/motion.js"></script>


<script src="/js/schemes/pisces.js"></script>


<script src="/js/next-boot.js"></script>




  















  

  

</body>
</html>
